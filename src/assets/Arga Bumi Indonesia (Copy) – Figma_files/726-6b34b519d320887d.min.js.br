"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="8e2b10b8-8315-5919-8f6a-d96af7a20e27")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([[726],{480804:(e,t,s)=>{s.d(t,{A:()=>ew,i:()=>e_});var n,a=s(104076),r=s(716976),i=s(651234),l=s(59127),o=s(266808),d=s(170627);let c=e=>"JSX"===e.type;class h{appendMessage(e){if(null==o.glU)throw Error("Fullscreen not loaded");return d.l7.ai("append-ai-chat-message",()=>{let t=this.node.aiChatThread;return null==t&&(t={messages:[]}),t.messages.push({createdAtMs:e.createdAtMs,role:p[e.role],content:e.content.map(g),clientId:e.clientId??"__undefined__"}),this.node.aiChatThread=t,{messages:t.messages.map(m)}})}get rawMessages(){return this.node.aiChatThread?.messages.map(m)??[]}constructor(e){if(!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(this,"node",void 0),this.node=e,!c(e))throw Error("Node is not a valid AI Chat node")}}function u(e){let t=e.value.textValue;if(t){let s=JSON.parse(t);switch(s.type){case"text":case"tool-call":case"tool-result":case"reasoning":case"redacted-reasoning":return s;default:throw Error(`Unknown IDLAIChatContentPart: ${JSON.stringify(e)}`)}}let s=e.value.selectedNodeIds;if(s)return{type:"selected-node-ids",selectedNodeIds:s};throw Error(`Unknown IDLAIChatContentPart: ${JSON.stringify(e)}`)}function g(e){switch(e.type){case"text":default:return{type:o.FbN.TEXT,value:{textValue:JSON.stringify(e)}};case"selected-node-ids":return{type:o.FbN.SELECTED_NODE_IDS,value:{selectedNodeIds:e.selectedNodeIds}}}}let p={user:o.oN4.USER,assistant:o.oN4.ASSISTANT,tool:o.oN4.TOOL,system:o.oN4.SYSTEM},f={[o.oN4.USER]:"user",[o.oN4.ASSISTANT]:"assistant",[o.oN4.TOOL]:"tool",[o.oN4.SYSTEM]:"system"};function m(e){let t=e.content;return{createdAtMs:e.createdAtMs,role:f[e.role],content:t.map(u),clientId:"__undefined__"===e.clientId?void 0:e.clientId}}var x=s(951002);function y(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class C{getMessages(){return structuredClone(this.messages)}getLatestMessage(){let e=structuredClone(this.messages[this.messages.length-1]);if(!e)throw Error("Empty messages array");return e}getLastCommittedMessageIndex(){return this.lastCommittedMessageIndex}getPendingToolCalls(){return Array.from(this.pendingToolCalls.values())}ensureActiveMessageWithRole(e){if(!this.activeMessage||this.activeMessage.role!==e){let t=this.buildAiChatMessage(e);this.messages.push(t),this.activeMessage=t}return this.activeMessage}buildAiChatMessage(e){return{createdAtMs:Date.now(),role:e,content:[]}}handleTextDelta(e){let t=this.ensureActiveMessageWithRole("assistant"),s=t.content[t.content.length-1];s&&"text"===s.type||(s={type:"text",text:""},t.content.push(s)),s.text+=e.textDelta}handleReasoning(e){let t=this.ensureActiveMessageWithRole("assistant");if("redacted-reasoning"===e.type){let s=t.content.find(e=>"redacted-reasoning"===e.type);s||(s={type:"redacted-reasoning",data:""},t.content.push(s)),s.data+=e.data}else{let s=t.content.find(e=>"reasoning"===e.type);switch(s||(s={type:"reasoning",text:"",signature:""},t.content.push(s)),e.type){case"reasoning":"textDelta"in e&&(s.text+=e.textDelta);break;case"reasoning-signature":s.signature=e.signature}}}handleToolCall(e){this.pendingToolCalls.set(e.toolCallId,e),this.ensureActiveMessageWithRole("assistant").content.push({type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,argsJSON:JSON.stringify(e.args||{})})}pushToolResult(e,t,s){this.ensureActiveMessageWithRole("tool").content.push({type:"tool-result",toolCallId:e,toolName:t,resultJSON:JSON.stringify(s)})}handleToolResult(e){this.pendingToolCalls.get(e.toolCallId)&&(this.pendingToolCalls.delete(e.toolCallId),this.pushToolResult(e.toolCallId,e.toolName,e.result))}processResponseStreamPart(e){switch(e.type){case"text-delta":this.handleTextDelta(e);break;case"tool-call":this.handleToolCall(e);break;case"tool-result":this.handleToolResult(e);break;case"reasoning":case"reasoning-signature":case"redacted-reasoning":this.handleReasoning(e);break;case"messagesCommitted":this.lastCommittedMessageIndex=e.lastCommittedMessageIndex;break;default:(0,x.xb)(e)}this.onUpdate?.(this.messages)}appendClientSideToolResult(e,t,s){if(!this.pendingToolCalls.get(e))throw Error(`Tool call ${e} not found in pendingToolCalls`);this.pendingToolCalls.delete(e),this.pushToolResult(e,t,s),this.onUpdate?.(this.messages)}appendUserMessage(e){let t={...e,content:e.content.map(e=>{switch(e.type){case"text":return{type:e.type,text:e.text};case"selected-node-ids":return{type:e.type,selectedNodeIds:[...e.selectedNodeIds]};case"image":return{type:e.type,image:e.image};case"jsx":return{type:e.type,jsx:e.jsx};case"code-chat-model-config-version":return{type:e.type,modelConfigVersion:e.modelConfigVersion}}})};this.messages.push(t),this.activeMessage=t,this.onUpdate?.(this.messages)}constructor({initialMessages:e,onUpdate:t}){y(this,"messages",[]),y(this,"activeMessage",void 0),y(this,"pendingToolCalls",new Map),y(this,"lastCommittedMessageIndex",void 0),y(this,"onUpdate",void 0);let s=structuredClone(e),n=s[s.length-1];n&&(this.messages=s,this.activeMessage=n),this.onUpdate=t,this.onUpdate(this.messages)}}!function(e){e.MESSAGE_SENT="message_sent",e.RESPONSE_RECEIVED="response_received",e.TOOL_EXECUTION_STARTED="tool_execution_started",e.TOOL_EXECUTION_RESULT="tool_execution_result"}(n||(n={}));class v{push({toolCallId:e,trackingName:t}){this.toolCalls.push({name:t,id:e})}markSuccess(e){let t=this.toolCalls.find(t=>t.id===e);t&&(t.succeeded=!0)}markFailure(e){let t=this.toolCalls.find(t=>t.id===e);t&&(t.succeeded=!1)}getEventFields(){if(0===this.toolCalls.length)return{toolCallIds:void 0,toolCallNames:void 0,totalToolCalls:0,toolCallsSucceeded:0};let e=[],t=[],s=0;for(let n of this.toolCalls)e.push(n.id),t.push(n.name),n.succeeded&&s++;return{toolCallIds:JSON.stringify(e),toolCallNames:JSON.stringify(t),totalToolCalls:this.toolCalls.length,toolCallsSucceeded:s}}constructor(){!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(this,"toolCalls",[])}}var _=s(980852);function b(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class w{handleError(e,t){let s=e instanceof Error?e.name:"UnknownError",n=e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e:Error(n);return this.clientCallbacks.sloge(t,{name:s,message:n}),this.clientCallbacks.handleError&&this.clientCallbacks.handleError(a),{name:s,message:n}}async streamResponse(e){return this.clientDependencies.streamResponse(e,this.trackingContext)}async processResponseStream(e){let t=e.getReader();for(;;){let{done:e,value:s}=await t.read();if(e)break;this.threadBuilder.processResponseStreamPart(s)}return this.threadBuilder.getPendingToolCalls()}async runAgentLoop({serverSideChatParams:e}){for(;;){let t=e?[this.threadBuilder.getLatestMessage()]:this.threadBuilder.getMessages(),s=this.buildRequest({messages:t,serverSideChatParams:e}),a=await this.streamResponse(s),r=await this.processResponseStream(a);if(0===r.length)break;for(let e of r){let t=this.tools[e.toolName],{toolCallId:s,toolName:a,args:r}=e,i={toolCallId:s,toolName:t.trackingName};this.toolCallTracker.push({toolCallId:s,trackingName:t.trackingName});let{executeClientSide:l}=t;if(!l)throw Error(`Tool ${t.trackingName} has no client-side execution function`);this.clientCallbacks.trackEvent({name:n.TOOL_EXECUTION_STARTED,fields:i});try{let e=await t.executeClientSide(r,{...this.trackingContext,...i});this.threadBuilder.appendClientSideToolResult(s,a,{...e,success:!0}),this.toolCallTracker.markSuccess(s),this.clientCallbacks.trackEvent({name:n.TOOL_EXECUTION_RESULT,fields:{...i,success:!0}})}catch(r){let{name:e,message:t}=this.handleError(r,"Error in tool");this.toolCallTracker.markFailure(s),this.clientCallbacks.trackEvent({name:n.TOOL_EXECUTION_RESULT,fields:{...i,success:!1,errorName:e,errorMessage:t}}),this.threadBuilder.appendClientSideToolResult(s,a,{success:!1,error:`${e}: ${t}`})}}}}async sendMessage({newUserMessage:e,serverSideChatParams:t}){let s=(0,_.UN)(),a=e.content.filter(e=>"selected-node-ids"===e.type).flatMap(e=>e.selectedNodeIds),r=a.map(e=>({nodeId:e,depthFromCanvas:s.get(e)?.depthFromCanvas??-1}));this.clientCallbacks.trackEvent({name:n.MESSAGE_SENT,fields:{numSelectedNodes:a.length,selectedNodeInfo:JSON.stringify(r)}}),this.threadBuilder.appendUserMessage(e);try{await this.runAgentLoop({serverSideChatParams:t});let{toolCallIds:e,toolCallNames:s,totalToolCalls:a,toolCallsSucceeded:r}=this.toolCallTracker.getEventFields();return this.clientCallbacks.trackEvent({name:n.RESPONSE_RECEIVED,fields:{toolCallIds:e,toolCallNames:s,totalToolCalls:a,toolCallsSucceeded:r,status:"completed"}}),this.clientCallbacks.onUpdateThread(this.threadBuilder.getMessages(),!0),this.threadBuilder.getMessages()}catch(o){let{name:t,message:s}=this.handleError(o,"Error in sendMessage"),{toolCallIds:a,toolCallNames:r,totalToolCalls:i,toolCallsSucceeded:l}=this.toolCallTracker.getEventFields();this.clientCallbacks.trackEvent({name:n.RESPONSE_RECEIVED,fields:{toolCallIds:a,toolCallNames:r,totalToolCalls:i,toolCallsSucceeded:l,status:"failed",errorName:t,errorMessage:s}}),this.clientCallbacks.onUpdateThread([e,{role:"assistant",content:[{type:"text",text:"Sorry, I encountered an error while processing your request. Please try again."}],createdAtMs:Date.now()}],!0)}}constructor({trackingContext:e,tools:t,clientDependencies:s,clientCallbacks:n,persistedMessages:a}){b(this,"tools",void 0),b(this,"trackingContext",void 0),b(this,"clientDependencies",void 0),b(this,"clientCallbacks",void 0),b(this,"toolCallTracker",void 0),b(this,"threadBuilder",void 0),this.trackingContext=e,this.tools=t,this.clientDependencies=s,this.clientCallbacks=n,this.toolCallTracker=new v,this.threadBuilder=new C({initialMessages:a,onUpdate:e=>this.clientCallbacks.onUpdateThread(e,!1)})}}class S extends w{buildRequest({messages:e,serverSideChatParams:t}){return{messages:e,serverSideChatParams:t}}}var T=s(747618),k=s(998432),E=s(638004),N=s(812714),j=s(795033),M=s(146283),I=s(166887),A=s(770366),O=s(276800),R=s(550209),U=s(246144),L=s(316862),P=s(315361),F=s(819851),D=s(178623),B=s(431222),z=s(354114),$=s(106170),V=s(692042),H=s(657878),W=s(592726),Y=s(904017),J=s(441513),q=s(113139),X=s(869450);let G=J.z.object({threadId:J.z.string()}),K=J.z.object({threads:J.z.array(J.z.object({id:J.z.string(),privacy_mode:J.z.string(),file_key:J.z.string(),user_id:J.z.string(),plan_parent_id:J.z.string(),plan_parent_type:J.z.string(),chat_compression_summary_ref:J.z.string().nullable(),chat_compression_upto_index:J.z.number().nullable(),created_at:J.z.string(),updated_at:J.z.string()}))}),Z=new class{constructor(){this.CreateThreadSchemaValidator=(0,q.YV)("CreateThreadSchemaValidator",(0,X.D)(G),null),this.ListThreadsSchemaValidator=(0,q.YV)("ListThreadsSchemaValidator",(0,X.D)(K),null)}createThread(e){let{fileKey:t}=e;return this.CreateThreadSchemaValidator.validate(async({xr:s})=>await s.post(`/api/ai_chat/${encodeURIComponent(t)}/threads`,q.td.toAPIParameters(e)))}listThreads(e){return this.ListThreadsSchemaValidator.validate(async({xr:t})=>await t.get(`/api/ai_chat/${encodeURIComponent(e)}/threads`))}};var Q=s(415567),ee=s(141330),et=s(592948),es=s(605862),en=s(577932),ea=s(107799),er=s(847112),ei=s(51656),el=s(748128),eo=s(956492),ed=s(635729),ec=s(314220),eh=s(331451),eu=s(816299),eg=s(602755);s(120440);var ep=s(997477),ef=s(192075),em=s(905885);let ex=r.lazy(()=>s.e(4345).then(s.bind(s,544345)));function ey(){var e,t;let s=(0,j.Xr)(el.Si),n=(0,j.Xr)(em.eb),i=(0,j.md)(el.yq),l=(0,ep.gP)("make_edits_global_configuration"),o=(0,ec.GU)(l.value).configs;if(o.length<=1)return null;let d=i.productString,c=(e=i.productString,t=i.productStringEnglishFallback,(0,ef.Yd)(e,t));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"x1n2onr6 x2lah0s",children:(0,a.jsxs)(eh.bL,{value:d,onChange:e=>{let t=o.find(t=>t.productString===e);t&&(n(null),t.default?s(void 0):s({key:t.productString}))},children:[(0,a.jsxs)(eh.l9,{id:"model-picker-trigger",className:"x1ypdohk x78zum5 x6s0dn4 xg2d0mh xilkfi8 x192jxwq xjbqb8w xv2f06h x1n0bwc9 xmauxvm x1pshirs","aria-label":(0,ef.t)("ai_assistant.model_picker.select_ai_model"),children:[(0,a.jsx)("span",{children:c}),(0,a.jsx)(eg.O,{})]}),(0,a.jsx)(eu.mc,{children:o.map(e=>{var t,s;return(0,a.jsx)(eu.c$,{value:e.productString,children:(t=e.productString,s=e.productStringEnglishFallback,(0,ef.Yd)(t,s))},e.productString)})})]})}),(0,N.kc)().make_edits_debug?(0,a.jsx)("div",{style:{flexShrink:0},children:(0,a.jsx)(r.Suspense,{fallback:null,children:(0,a.jsx)(ex,{})})}):null]})}function eC(e,...t){(0,N.kc)().ai_assistant_server_side_chat&&M.k.log(`[server-side-chat] ${e}`,...t)}let ev=(0,j.eU)(null);function e_(e){j.zl.set(ev,e)}let eb=new Map;function ew(){let e=(0,N.kc)().ai_assistant_server_side_chat??!1,t=(0,W.iZ)(),s=(0,H.Td)(),n=(0,F.lg)(),u=(0,I.hC)(),g=(0,Y.No)().unwrapOr(null),p=(0,P.uQ)(),f=(0,P.NM)(),m=(0,Q.Tv)(),x=(0,j.md)(el.pF),{pendingInteractiveTools:y,showInteractiveTool:C,resolveInteractiveTool:v}=(0,eo.R)(),b=r.useMemo(()=>{if(p)return[p];if(f&&f.length>0)return f;let e=(0,_.UN)().getCurrentPage();return x.options.includeExtraContext&&e?[e.guid]:[]},[p,f,x]),[w,M]=r.useState(new Map),[J,q]=(0,j.fp)(el.qA),[X,G]=(0,j.fp)(ev),[K,ec]=(0,j.fp)(el.hM),eh=(0,j.md)(el.G1),eu=(0,j.Xr)(el.G1),eg="scenegraph-fallback",ep=eh||(e?null:eg),{chatController:ef,appendPersistedMessagesForCurrentThread:em,setPersistedMessagesForCurrentThread:ex,getPersistedMessagesForCurrentThread:e_}=function(e,t){let[s,n]=r.useState(new Map),a=(0,W.iZ)(),i=(0,$.r)(()=>(function(e,t){if(null==o.glU)throw Error("Fullscreen not loaded");let s=e.getInternalCanvas();if(!s)return null;for(let e of s.childrenNodes)if(c(e)&&e.name===t)return new h(e);return new h(d.l7.ai("create-unique-ai-chat",()=>{let n=function(e,t){let s=e.createNode("JSX");return t&&(s.name=t),s.aiChatThread={messages:[]},s}(e,t);return s.appendChild(n),n}))})((0,_.UN)(),a?.id??"")),l=r.useMemo(()=>i?.rawMessages??[],[i?.rawMessages]),u=r.useCallback(()=>t?e?s.get(t)??[]:l:[],[t,e,s,l]),g=r.useCallback(s=>{t&&e&&n(e=>{let n=new Map(e),a=n.get(t)??[];return n.set(t,s([...a])),n})},[t,e]),p=r.useCallback(s=>{if(t){if(e)n(e=>{let n=new Map(e),a=n.get(t)??[];return n.set(t,[...a,...s]),n});else for(let e of s)i?.appendMessage(e)}},[t,e,i]);return{chatController:i,appendPersistedMessagesForCurrentThread:p,setPersistedMessagesForCurrentThread:g,getPersistedMessagesForCurrentThread:u}}(e,ep),ew=r.useCallback(()=>ep?w.get(ep)??[]:[],[ep,w]),eT=r.useCallback(e=>{ep&&M(t=>{let s=new Map(t);return s.set(ep,e),s})},[ep]),{threadId:ek,setThreadId:eE,isLoadingThreadId:eN}=(0,ed.D)(s,ew().length,ex,"idle"!==J),ej=ek||"0:1",eM=r.useCallback(e=>{j.zl.set((0,ea.mC)(ej),e)},[ej]),eI=ew().length>0,eA=(0,j.md)(el.J2).length>0,eO=eI||eN||eA,eR=r.useMemo(()=>(0,en.qE)(s,ef?.node.guid||""),[s,ef?.node.guid]),eU=r.useCallback(async(t=!1)=>{if(e&&!eN&&s&&g){if(null==ek||"pendingCreation"===J||t){eC("Creating thread...");let e=performance.now(),t=await Z.createThread({fileKey:s,privacyMode:"user",planParentId:g.key.parentId,planParentType:g.key.type});if(200===t.status){let s=t.data.meta.threadId;return eC("Thread created",s),eE(s),q("idle"),(0,A.aD)("ai_assistant.server_side_chat.thread_creation_time",performance.now()-e),s}return void console.error("Failed to create AiChatThread",t)}return ek}},[s,eN,J,g,q,eE,ek,e]),eL=r.useCallback(async({userInput:t,clientLifecycleId:a},r)=>{let o,d=b;if("canvas"===r&&t.selectedNodeIds&&t.selectedNodeIds.length&&(d=t.selectedNodeIds),!s){console.warn("No file key found");return}let c=e?await eU(!1):eg;if(e){if(!c)return;o={fileKey:s,threadId:c}}eM(""),eT([]);let h=new AbortController,g=t.selectedNodeIds??d;j.zl.set(el.J2,g);let p={role:"user",content:[{type:"text",text:t.plainText??""},{type:"selected-node-ids",selectedNodeIds:t.selectedNodeIds??[]}],createdAtMs:Date.now(),clientId:a},f="ai_assistant",m=c??eR,x={clientLifecycleId:a,persistentEntityId:m,featureEntrypoint:r},y=new S({trackingContext:x,tools:{[T.It.name]:(0,l.E7)({toolInterface:T.It,executeClientSide:C}),[T.Ns.name]:(0,l.E7)({toolInterface:T.Ns,executeClientSide:async(e,t)=>{let a=e.selectedLayerIds?e.selectedLayerIds:d;return{image:(await (0,et.nR)({params:{userInput:{userPrompt:e.instructions??""},inferredContext:{selectedNodeIds:a,viewport:(0,V.qc)(z.Y5.getViewportInfo())},contextPromise:void 0,setThinkingState:O.lQ,aiTrackingContext:{action:ee.JT.MAKE_EDITS,source:i.lV.AI_ASSISTANT,quick_actions_session_id:"invalid",file_key:s,product_type:n,...t},trackingContext:t},abortController:h})).image,imageCaption:"This is what the layer looks like now with the edits applied:"}}})},clientDependencies:{streamResponse:e=>D.Ay.shared.aiAssistantChat(e,{...(0,B.sF)({clientLifecycleId:a}),persistentEntityId:m},{abortSignal:h.signal})},clientCallbacks:{trackEvent:e=>u(`${f}.${e.name}`,{...x,...e.fields}),handleError:e=>{(e instanceof k.G1&&"parse_request"===e.type||e instanceof k.G1&&"Not found"===e.message)&&j.zl.set((0,ei.QK)(ej),{error:Error(ei.T_.OUTDATED_CLIENT_ERROR),cortexClientGeneratedRequestUuid:a}),(0,R.$D)(E.e.AI_ASSISTANT,e)},sloge:(e,t)=>(0,U.x1)(f,e,t),onUpdateThread:(e,t)=>{c&&(t?(c===ep&&em(e),M(e=>{let t=new Map(e);return t.set(c,[]),t}),j.zl.set(el.J2,[])):M(t=>{let s=new Map(t);return s.set(c,[...e]),s}))}},persistedMessages:e?[]:e_()});await y.sendMessage({newUserMessage:p,serverSideChatParams:o}),e||j.zl.set(el.J2,[])},[em,eU,n,ep,s,e_,eR,b,eT,eM,C,u,e,ej]);r.useEffect(()=>{!X||e&&(eN||"idle"!==J)||(eL(X,"canvas"),G(null))},[X,eN,J,eL,e,G]),r.useEffect(()=>{let e="pendingCreation"===J&&!eN&&null===ek;X&&e&&(eL(X,"canvas"),G(null))},[X,J,eN,ek,eL,G]);let eP=eS({user:t,messages:e_(),pendingInteractiveTools:y,resolveInteractiveTool:v,currentSelectedNodeIds:m,annotateClientLifecycleIdForTracking:!0}),eF=eS({user:t,messages:ew(),pendingInteractiveTools:y,resolveInteractiveTool:v,currentSelectedNodeIds:m,annotateClientLifecycleIdForTracking:!1}),eD=[...eP,...eF],eB=e=>{switch(e.type){case"user":case"system":return e.id;case"assistant":return e.messages[e.messages.length-1]?.id??""}},ez=r.useMemo(()=>new Set(eF.map(e=>eB(e))),[eF]),{FirstPartyExplanationPointer:e$}=(0,es.i7)(!0,"code_chat_message_container");return r.useEffect(()=>{e&&"shouldCreate"===J&&(q("pendingCreation"),eE(null),M(new Map),eM(""),ec(null))},[e,J,q,eE,eM,ec]),r.useEffect(()=>{eu(ek)},[ek,eu]),r.useEffect(()=>{K&&K!==ek&&e&&(eE(K),eM(""),q("idle"),ec(null))},[K,ek,e,eE,eM,q,ec]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(er.r,{chatBoxRightExtraContent:[(0,a.jsx)(ey,{},"model-picker")],chatMessagesNodeGuid:ej,clientLifecycleIdMap:eb,codeFileChanges:void 0,codeInstanceGuid:null,emptyState:(0,a.jsx)("div",{}),exchangeMessageIds:ez,featureType:i.lV.AI_ASSISTANT,messagesForRendering:eD,sendDisabled:eO,sendMessage:e=>eL({userInput:e,clientLifecycleId:(0,L.g)()},"left_panel"),setInput:eM,showCodeStreaming:!1}),(0,a.jsx)(e$,{})]})}function eS({user:e,messages:t,pendingInteractiveTools:s,resolveInteractiveTool:n,currentSelectedNodeIds:a,annotateClientLifecycleIdForTracking:r}){return(function(e){let t=[],s=[];for(let n of e)"user"===n.role&&n.clientId&&(t.push(s),s=[]),s.push(n);return t.push(s),t.filter(e=>e.length>0)})(t).flatMap((t,i)=>{let l=t[0];if(l?.role!=="user"||!l?.clientId)throw Error("First message in a cook must be a user message with a clientId");let o=l.clientId;return t.flatMap((l,d)=>{let c=l.role;switch(c){case"user":{let t=l.content.filter(e=>"text"===e.type).map(e=>e.text).join(""),s=l.content.filter(e=>"selected-node-ids"===e.type).flatMap(e=>e.selectedNodeIds);return[{type:"user",user:e,id:l.clientId??`converted-${d}-${i}`,plainText:t,imports:void 0,inspectedElement:void 0,selectedNodeIds:s,libraryKey:void 0}]}case"assistant":{let e=[],c=l.content.filter(e=>"reasoning"===e.type).map(e=>e.text).join("");c.length>0&&e.push({type:"reasoning",reasoning:c,id:`reasoning-${d}-${i}`});let h=l.content.filter(e=>"text"===e.type).map(e=>e.text).join(""),u=l.content.filter(e=>"tool-call"===e.type).find(e=>"select_layers"===e.toolName);return u?s.get(u.toolCallId)&&e.push({type:"selectionRequest",message:h,selectedNodeIds:a??void 0,onContinue:e=>{e.length>0?j.zl.set(el.J2,e):j.zl.set(el.J2,[]),n(u.toolCallId,{selectedLayerIds:e,message:e.length>0?`User has selected ${e.length} layer(s): ${e.join(", ")}. Please proceed with the original request.`:"User clicked continue but no layers are currently selected."})},id:u.toolCallId}):h&&e.push({type:"plan",plan:h,title:"Plan",id:`plan-${d}-${i}`}),l.content.filter(e=>"tool-call"===e.type).forEach((t,s)=>{e.push({type:"toolCall",name:t.toolName,id:`toolCall-${d}-${i}-${s}`})}),[{type:"assistant",messages:e,clientLifecycleId:d===t.length-1&&r?o:void 0}]}case"system":return[{type:"system",id:`converted-${d}-${i}`,systemMessageType:"generic",plainText:l.content.filter(e=>"text"===e.type).map(e=>e.text).join(""),title:void 0}];case"tool":return[];default:throw Error(`Unknown message role: ${c}`)}})})}},12480:(e,t,s)=>{s.d(t,{Z:()=>S});var n=s(104076),a=s(716976),r=s(903927),i=s(980852),l=s(812714),o=s(511570),d=s.n(o),c=s(983500),h=s(361170),u=s(968169),g=s(553065),p=s(754446),f=s(692042),m=s(331497),x=s(728977),y=s(294570),C=s(766812),v=s(404343);let _="offscreen_indicators--indicatorGraphicBlue---nYr-",b="offscreen_indicators--indicatorGraphicPurple--FAz-M",w=(0,c.jz)(v.y9S);function S(){let e=[],t=(0,p.kl)("selectionRegions"),s=(0,g.E7)(t);s&&(e=s);let a=(0,r.d4)(e=>e.mirror.appModel.hoveredNode);if(a&&(0,l.kc)().ce_offscreen_indicators_for_hovered_nodes){let t=(0,i.UN)().get(a);if(t){let s=t.absoluteBoundingBox;e=[...e,{bounds:{height:s.h,width:s.w,x:s.x,y:s.y},regionType:t.isPrimaryInstance||t.isInstanceSublayer||t.isComponentish||t.isSymbolSublayer?y.fV.SYMBOLS_ONLY:y.fV.MIXED_OR_NO_SYMBOLS}]}}let o=!!e&&e.length>=1,d=(0,f._X)({subscribeToUpdates_expensive:o});return d&&e?(0,n.jsx)(T,{viewportInfo:d,regions:e}):null}function T({viewportInfo:e,regions:t}){let s=(0,a.useContext)(x.kw),i=(0,a.useMemo)(()=>s.getCommentsWrapperOffset(e),[s,e]),l=i.x,o=i.y,d={transform:`translate(${l}px, ${o}px)`},c=(0,r.d4)(e=>e.mirror?.appModel.showUi),h=(0,m.J2)((0,u.UK)().renderRulers)&&c?w:0,g={x:-3.5+h,y:-3.5+h,width:e.width- -7-h,height:e.height- -7-h},p={x:-3.5+h,y:-3.5+h,width:e.width- -7-h,height:e.height- -7-h};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(C.p,{children:(0,n.jsx)("div",{"aria-hidden":!0,"data-forward-events-to-fullscreen":!0,className:"offscreen_indicators--overlay--pNOlw",style:d,children:!!t?.length&&(0,n.jsx)("div",{children:t.map((t,s)=>{let a=(0,f.Z0)(e,{x:t.bounds.x,y:t.bounds.y}),r=(0,f.Z0)(e,{x:t.bounds.x+t.bounds.width,y:t.bounds.y+t.bounds.height}),i={x:a.x,y:a.y,width:r.x-a.x,height:r.y-a.y};return i.x<g.x+g.width&&i.x+i.width>g.x&&i.y+i.height>g.y&&i.y<g.y+g.height?null:(0,n.jsx)(k,{viewportBounds:p,viewportInfo:e,indicatorViewportBounds:i,selectionBoundsScaledWidth:function(e,t){let s=Math.max(e.x,t.x);return Math.max(Math.min(e.x+e.width,t.x+t.width)-s,10)}(i,p),selectionBoundsScaledHeight:function(e,t){let s=Math.max(e.y,t.y);return Math.max(Math.min(e.y+e.height,t.y+t.height)-s,10)}(i,p),selectionRegionType:t.regionType},s)})})})})})}function k({viewportBounds:e,viewportInfo:t,indicatorViewportBounds:s,selectionBoundsScaledWidth:a,selectionBoundsScaledHeight:i,selectionRegionType:l}){let o=function(e,t){let s=0-t.x,n=0+e.width-t.x,a=0-t.y,r=0+e.height-t.y,i=Math.abs(s)<n?s:n,l=Math.abs(a)<r?a:r,o=s<0!=n<0,d=a<0!=r<0;return o&&d?Math.abs(i)<Math.abs(l)?{x:t.x+i,y:t.y}:{x:t.x,y:t.y+l}:!o&&d?{x:t.x+i,y:t.y}:o&&!d?{x:t.x,y:t.y+l}:{x:t.x+i,y:t.y+l}}(t,{x:s.x+s.width/2,y:s.y+s.height/2});o.x-=a/2,o.y-=i/2;let c=(0,r.d4)(e=>e.mirror?.appModel.showUi),g=(0,m.J2)((0,u.UK)().renderRulers)&&c?w:0,p=1+g,f=Math.max(p,t.width-1-a),x=1+g,C=Math.max(x,t.height-1-i-1),v=h.Mi.bound(o,{min:{x:p,y:x},max:{x:f,y:C}}),S=s.y+s.height<e.y,T=s.y>e.y+e.height,k=s.x+s.width<e.x,E=s.x>e.x+e.width;v.x+=t.x,v.y+=t.y;let N=Math.min(t.width-2,a),j=Math.min(t.height-2,i);return(0,n.jsxs)("div",{className:"offscreen_indicators--indicator---T9xk",style:{transform:`translate3D(${v.x}px, ${v.y}px, 0)`},children:[(S||T)&&(0,n.jsx)("div",{style:{position:"absolute",height:1.5,width:N,marginTop:T?j-1.5:0},className:d()({[_]:l===y.fV.MIXED_OR_NO_SYMBOLS,[b]:l===y.fV.SYMBOLS_ONLY})}),(k||E)&&(0,n.jsx)("div",{style:{position:"absolute",left:0,height:j,width:1.5,marginLeft:E?N-1.5:0},className:d()({[_]:l===y.fV.MIXED_OR_NO_SYMBOLS,[b]:l===y.fV.SYMBOLS_ONLY})})]})}},605251:(e,t,s)=>{s.d(t,{m:()=>ek});var n=s(104076),a=s(716976),r=s(812714),i=s(795033),l=s(491645),o=s(967782),d=s(192075),c=s(968486),h=s(480804),u=s(742549),g=s(508011),p=s(74620),f=s(211862),m=s(842013),x=s(661379),y=s(993604),C=s(99160),v=s(128396),_=s(413535),b=s(12811),w=s(675476),S=s(383310),T=s(576044),k=s(804363),E=s(903927),N=s(132760),j=s(266808);s(120440);var M=s(490698),I=s(409019),A=s(691952),O=s(249586),R=s(643077),U=s(962212),L=s(490499),P=s(299117),F=s(156816),D=s(629560),B=s(830534),z=s(301868),$=s(510232),V=s(568590),H=s(692042),W=s(894210),Y=s(87535),J=s(68191),q=s(555806),X=s(702051);function G(){let e=(0,E.wA)(),t=(0,E.d4)(e=>!!e.modalShown),s=(0,E.d4)(e=>e.versionHistory.compareId),r=j.AWq.getChunkChangeCount(),i=(0,V.Z)("chunk_change_navigator_navigate"),l=(0,$.E)(),o=a.useCallback(e=>{j.Egt.setSelectedNodeAndCanvas(e,!0),i((0,H.QZ)({nodeId:e,...J.ob}),J.kh),l(e)},[i,l]),c=a.useCallback(e=>{t||0===r||("ArrowUp"===e.key||"ArrowLeft"===e.key||e.shiftKey&&"Tab"===e.key?o(j.glU.navigateToNextChange(-1)):("ArrowDown"===e.key||"ArrowRight"===e.key||"Tab"===e.key)&&o(j.glU.navigateToNextChange(1)))},[t,r,o]);return(a.useEffect(()=>{e(z.Q.dequeue({type:B._.SEE_WHATS_CHANGED}))},[e]),a.useEffect(()=>{s&&0!==r&&o(j.glU.navigateToFirstVisibleOrClosestChange())},[r,s,o]),a.useLayoutEffect(()=>{if(0!==r)return document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c)}},[r,c]),0===r)?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"chunk_change_navigator--chunkChangeCount--ZFnfP",children:(0,d.tx)("collaboration.feedback.change_count",{changeCount:r})}),(0,n.jsxs)("div",{className:"chunk_change_navigator--chunkChangeNavigator--82303",children:[(0,n.jsx)(Y.K0,{svg:X.A,onClick:e=>{e.stopPropagation(),o(j.glU.navigateToNextChange(-1))},"data-tooltip-type":W.Ib.TEXT,"data-tooltip":(0,d.t)("collaboration.feedback.previous_change"),recordingKey:"change_stepper.previous",disabled:0===r}),(0,n.jsx)(Y.K0,{svg:q.A,onClick:e=>{e.stopPropagation(),o(j.glU.navigateToNextChange(1))},"data-tooltip-type":W.Ib.TEXT,"data-tooltip":(0,d.t)("collaboration.feedback.next_change"),recordingKey:"change_stepper.next",disabled:0===r})]})]})}var K=s(716477),Z=s(343933),Q=s(672605),ee=s(637599),et=s(582689),es=s(835307),en=s(415567);let ea=(0,ee.vv)(()=>j.Ez5?.boxSelectionState().isBoxSelecting,!1);function er(){let e=(0,a.useContext)(et.y0).focusSelectedNodes;return!!((0,r.kc)().ce_il_layer_focus&&e)}let ei=new Set;function el(e){let t=(0,a.useRef)(e),s=t.current;return t.current=e,s}function eo(e,t){let s;if(t?.length===1&&(s=t[0])){let t=e.get(s);t&&(t.isExpanded=!0)}}var ed=s(90453),ec=s(444049),eh=s(748672),eu=s(602443),eg=s(314416),ep=s(342053),ef=s(582730),em=s(234312),ex=s(236099),ey=s(502047),eC=s(481836);let ev=new Map;var e_=s(85598);function eb(){let e=(0,S.cT)(),{pagesList:t,pageToNumChangesMap:s,isComparingChanges:i}=function(){let e=(0,S.n0)(),t=(0,E.d4)(e=>!!(0,r.kc)().version_diffing&&e.mirror.appModel.activeCanvasEditModeType===j.m1T.COMPARE_CHANGES),s=(0,E.d4)(e=>e.versionHistory.compareId);return a.useMemo(()=>{if(!t||!s)return{pagesList:e,pageToNumChangesMap:ev,isComparingChanges:t};let n=(0,J.ee)(e);return{pagesList:e,pageToNumChangesMap:n,isComparingChanges:t}},[t,s,e])}(),l=(0,ey.g)({pagesList:t}),o=(0,S.GQ)();return t.length?(0,n.jsx)(ew,{recordingKey:"pagesPanel",isReadOnly:e,width:o,pagesList:t,isComparingChanges:i,pageToNumChanges:s,onPageContextMenu:l}):null}function ew({width:e,isReadOnly:t,pagesList:s,onPageContextMenu:r,isComparingChanges:l,pageToNumChanges:o,recordingKey:d}){let c=(0,f.q5)(),u=(0,E.d4)(e=>t||!c?j.xae.LAYERS:e.leftPanel.activeTab),g=(0,E.d4)(e=>e.versionHistory),m=(0,R.dh)();(0,R.nn)();let x=(0,i.md)(eu.l7),y=(0,eg.U)(),C=(0,U.T)(),{isLayersOpen:v,toggleLayersAction:_}=(0,S.vr)(),{renamingNodeGuid:b,startRenamingNode:w,stopRenamingNode:k}=(0,S.TU)(),N=(0,S._4)(),{height:B,setHeight:z,isOpen:$,setIsOpen:V}=(0,eC.d)({defaultIsOpen:!0}),H=u===j.xae.LAYERS,W=j.AWq.getChunkChangeCount(),Y=(0,E.Pj)(),J=(0,a.useCallback)(e=>{y.showLayersPanel(),(0,O.ds)("pages_panel_open_toggle",c?.key,Y.getState(),{isPagesOpen:e},{forwardToDatadog:!0}),V(e)},[c,y,V,Y]),q=(0,a.useCallback)(()=>{J(!0)},[J]),X=(0,I.F)($),ee=(0,a.useCallback)(()=>{J(!X.current)},[X,J]),et=(0,M.$)(x);(0,a.useEffect)(()=>{x&&et&&!t&&q()},[et,x,t,q]);let{focusedNodes:ey,onSelectNodesFromLayersPanel:ev,clearFocusedNodes:eb}=function(){let e=(0,en.Tv)(),t=(0,p.eY)(),s=er(),n=function(){let e=(0,p.KH)(),t=er(),s=(0,es.Fk)((e,s)=>{if(!t)return[];let n=new Set;return Object.keys(s).forEach(t=>{let s=function(e){for(;e;){if(e.parentNode?.type==="CANVAS")return e;e=e.parentNode}return null}(e.get(t));s&&n.add(s.guid)}),Array.from(n)},e);return(0,a.useMemo)(()=>new Set(s),[s])}(),r=el(s),l=el(n),o=el(e),d=(0,a.useRef)(!1),c=(0,a.useRef)(new Set),h=l!==n,u=r!==s;(o!==e||h||u)&&function({focusedNodesRef:e,supportsFocus:t,isObjectsPanelClickRef:s,topLevelParents:n,didTopLevelParentsChange:a,scene:r,nodeIds:l}){if(!t||i.zl.get(ea)){e.current=ei;return}if(s.current){if(a&&e.current.size){let t=new Set(e.current);n.forEach(e=>t.add(e)),eo(r,l),e.current=t}s.current=!1;return}e.current=n,eo(r,l)}({focusedNodesRef:c,supportsFocus:s,isObjectsPanelClickRef:d,nodeIds:e,scene:t,topLevelParents:n,didTopLevelParentsChange:h});let g=(0,Q.C)(),f=(0,a.useCallback)(()=>{c.current=ei,g()},[g]),m=(0,a.useCallback)(()=>{d.current=!0},[]);return{onSelectNodesFromLayersPanel:s?m:void 0,focusedNodes:s?c.current:void 0,clearFocusedNodes:s?f:void 0}}(),ew=(0,e_.HY)(),eT=(0,i.md)(Z.wt),ek=(0,i.md)(Z.R4),eE=(0,L.o3)(L.nt.newResizablePanel),[eN,ej,eM]=(0,em.BN)(u,d),eI=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eh.R,{height:B,isComparingChanges:l,isOpen:$,isReadOnly:t,onCanvasSearch:N,onHeightChange:z,onPageContextMenu:r,onToggle:ee,pageToNumChanges:o,pages:s,showHeader:!C}),(0,n.jsxs)(ec.m,{children:[v&&(0,n.jsx)(P.p,{children:(0,n.jsx)(F.Ay,{})}),(0,n.jsx)(ef.o,{currentPage:m,focusedNodes:ey,isLayersOpen:v,isReadOnly:t,onSelectNodesFromLayersPanel:ev,onToggleLayers:_,recordingKey:d,renamingGuid:b,reserveBottomHeight:ey?.size!==0,showAllLayers:eb,startRenaming:w,stopRenaming:k,topNodeProperties:null,versionHistory:g,width:eE&&eT?ek:e})]})]});return(0,n.jsxs)(ed.A,{isFullHeight:!0,children:[(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.$,{}),!t&&(0,n.jsx)(ex.I,{activeTab:u,onCanvasSearch:N,recordingKey:d,tabManager:eM,tabPropsMap:eN})]}),l&&H&&(0,n.jsxs)(n.Fragment,{children:[g.compareId&&(0,n.jsx)(K.ZI,{compareId:g.compareId,versions:g.versions}),W>0&&(0,n.jsx)(ep.y,{withBorder:!0,children:(0,n.jsx)(G,{})})]}),c&&(0,n.jsx)(D.QU,{fileKey:c.key}),(0,n.jsx)(eS,{isInTab:H,tabProps:ej[em.FV],children:eI}),!ew&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eS,{isInTab:u===j.xae.ASSETS,tabProps:ej[em.ay],children:(0,n.jsx)(T.g,{width:e})}),(0,n.jsx)(eS,{isInTab:u===j.xae.CHAT,tabProps:ej[em.n8],children:(0,n.jsx)(h.A,{})})]})]})}function eS({children:e,isInTab:t,tabProps:s}){return(0,r.kc)().ui3_left_panel_tabs_fpl&&s?(0,n.jsx)(N.t.TabPanel,{height:"fill",...s,children:(0,n.jsx)("div",{className:"x5yr21d x78zum5 xdt5ytf",children:e})}):t?(0,n.jsx)(n.Fragment,{children:e}):null}var eT=s(369923);let ek=a.memo(function(){let e=(0,i.md)((0,m.Xh)(void 0)),t=(0,f.q5)(),s=(0,p.aV)();(0,S.bi)();let l=!!t&&e,d=(0,p.p8)("showUi"),c=(0,S.cT)(),h=[(0,n.jsx)(eT.LP,{},"file"),!c&&(0,n.jsx)(eT.ek,{},"assets"),(0,n.jsx)(eT._L,{},"find"),!c&&(0,n.jsx)(eT.lk,{},"chat")].filter(Boolean);a.useEffect(()=>{l&&(0,o.YQ)({id:"Found Updates To Publish"})},[l]);let[,u]=(0,x.bL)();a.useEffect(()=>()=>{u(null)},[u]);let g=(0,S.Ye)(),y=(0,e_.HY)(),_=(0,e_.nb)(),b=(0,e_.sG)();return(0,r.kc)().dont_render_ui&&!d?null:(0,n.jsxs)(n.Fragment,{children:[y&&(0,n.jsx)(e_.ur,{canvasInteractions:h}),(0,n.jsx)(w.Q,{ignoreRulers:s,..._,children:g?(0,n.jsx)(v.s,{}):(0,n.jsx)(C.$,{shouldDeferCanvasUpdateOnPanelResize:!0,...b,children:y?(0,n.jsx)(eN,{}):(0,n.jsx)(eE,{})})})]})});function eE(){let e=(0,u.X0)(),t=(0,g.L3)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.s,{}),(0,n.jsx)(b.n,{}),(0,n.jsx)(_.d,{shouldUseBottomBorder:!e}),t?(0,n.jsx)(x.EA.Provider,{value:!0,children:(0,n.jsx)(y.f,{showFilter:!0})}):(0,n.jsx)(eb,{})]})}function eN(){let e=(0,i.md)(k.G_),t=(0,u.X0)(),s=(0,S.GQ)(),r=(0,g.L3)();switch(a.useEffect(()=>{r&&e!==k.NA.SEARCH&&(0,k.Lm)(k.NA.SEARCH)},[r,e]),e){case k.NA.ASSETS:return(0,n.jsx)(l.Zf,{canvasActionName:(0,d.t)("design.navbar.assets"),onClose:()=>{(0,k.Lm)(k.NA.FILE)},children:(0,n.jsx)(T.g,{width:s})});case k.NA.CHAT:return(0,n.jsx)(l.Zf,{canvasActionName:(0,d.t)("design.navbar.chat"),onClose:()=>{(0,k.Lm)(k.NA.FILE)},additionalButtons:(0,n.jsx)(c.f,{}),children:(0,n.jsx)(h.A,{})});case k.NA.SEARCH:return(0,n.jsx)(l.Zf,{canvasActionName:(0,d.t)("design.navbar.find"),onClose:()=>{(0,k.Lm)(k.NA.FILE)},children:(0,n.jsx)(x.EA.Provider,{value:!0,children:(0,n.jsx)(y.f,{showFilter:!0})})});default:return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(_.d,{shouldUseBottomBorder:!t}),(0,n.jsx)(eb,{})]})}}},512810:(e,t,s)=>{s.d(t,{q:()=>p});var n=s(104076),a=s(111297),r=s(754446),i=s(74620),l=s(211862),o=s(390669),d=s(563554),c=s(270351),h=s(546547),u=s(235566),g=s(325751);function p({scrollContainer:e}){let t=(0,l.q5)(),s=(0,i.KH)(),p=(0,r.Gt)("prototypeStartingPointsInfo"),f=!p||p.length>0,m=0===Object.keys(s).length,x=t?.canEdit,y=(0,n.jsx)(o.VF,{isVisible:m&&!x&&f,children:()=>(0,n.jsx)(g.A,{viewOnly:!0})}),C=(0,n.jsx)(o.VF,{isVisible:m,children:()=>(0,n.jsx)(c.Q,{recordingKey:"code-local-styles",scrollContainer:e},"code-local-styles")});return(0,n.jsxs)(a.fu,{name:d.e0.CODE_PANEL,children:[(0,n.jsx)(h.Mw,{panelName:h.ON.INSPECT}),(0,n.jsx)(u.t,{recordingKey:"inspectionPanel",flowPanel:y,localStylesPanel:C},"inspection-properties-panel")]})}},605862:(e,t,s)=>{s.d(t,{i7:()=>g});var n=s(104076),a=s(716976),r=s(997477),i=s(422872),l=s(905885),o=s(174730),d=s(143277),c=s(132078),h=s(441030);function u({dismissModal:e,targetKey:t}){let s=(0,r.Fj)("make_edits_1p_description").getDynamicConfig();return s.value.description&&"string"==typeof s.value.description&&s.value.title&&"string"==typeof s.value.title?(0,n.jsxs)(c.NJ,{targetKey:t,dismissModal:e,width:300,topPadding:8,children:[(0,n.jsx)("div",{style:{marginBottom:"8px",fontWeight:600},children:s.value.title}),(0,n.jsx)("div",{style:{whiteSpace:"pre-line"},children:s.value.description})]}):null}function g(e,t){let s=(0,o.f)("seen_first_party_model_explanation"),[c]=(0,l.BZ)(),{show:g,isShowing:p,complete:f}=(0,i.e)({overlay:h.u36,priority:d.N.SECONDARY_MODAL});return a.useEffect(()=>{if(c){"first-party"===c.configurationKey&&!s&&e&&g();return}"first-party"===(0,r.gP)("make_edits_configuration").value.configurationKey&&!s&&e&&g()},[s,g,e,c]),{isShowingFirstPartyExplanation:p,completeFirstPartyExplanation:f,FirstPartyExplanationPointer:()=>p?(0,n.jsx)(u,{dismissModal:f,targetKey:t}):null}}},866810:(e,t,s)=>{s.d(t,{t:()=>l});var n=s(716976),a=s(903927),r=s(266808),i=s(521255);function l(){let e=(0,i.m0)(),t=(0,a.d4)(e=>e.mirror.appModel.activeCanvasEditModeType);return n.useEffect(()=>{e&&(e._keyboard_will_show_with_height=e=>{r.glU.keyboardWillShowWithHeight(e)},e._keyboard_will_hide=()=>{t===r.m1T.TEXT&&r.glU.setDefaultEditMode()},window.FigmaAppObj?(window.FigmaAppObj.keyboardWillShow=()=>{r.glU.keyboardWillShow()},window.FigmaAppObj.keyboardWillShowWithHeight=e=>{r.glU.keyboardWillShowWithHeight(e)}):window.FigmaAppObj={keyboardWillShow:()=>{r.glU.keyboardWillShow()},keyboardWillShowWithHeight:e=>{r.glU.keyboardWillShowWithHeight(e)}})},[e,t]),null}}}]);

//# debugId=8e2b10b8-8315-5919-8f6a-d96af7a20e27

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/93d988b0df530aa0b3546a52243f2d8379559516/726-6b34b519d320887d.min.js.map