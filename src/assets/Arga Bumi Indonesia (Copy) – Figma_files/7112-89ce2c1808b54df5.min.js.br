"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="e2a11c0e-7fe2-52f1-82b0-9cb3a2b9aa39")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([[7112],{956492:(e,t,s)=>{s.d(t,{R:()=>i,j:()=>r});var a=s(716976);let n=["select_layers"];function r(e){return n.includes(e)}function i(){let[e,t]=a.useState(new Map);return{pendingInteractiveTools:e,showInteractiveTool:(e,s)=>new Promise(a=>{t(t=>new Map(t).set(s.toolCallId,{args:e,resolve:a}))}),resolveInteractiveTool:(e,s)=>{t(t=>{let a=t.get(e);if(a){a.resolve(s);let n=new Map(t);return n.delete(e),n}return t})},cancelInteractiveTool:e=>{t(t=>{let s=t.get(e);if(s){s.resolve({message:"Cancelled"});let a=new Map(t);return a.delete(e),a}return t})}}}},955440:(e,t,s)=>{s.d(t,{U:()=>o});var a=s(716976),n=s(833805),r=s(944350),i=s(904017),l=s(208434),c=s(3234);function o({resourceType:e,pageSize:t,caller:s,enabled:o}){let x=(0,i.S2)(),d="loaded"===x.status,u=x.data?.type===r.OL.ORG?x.data?.key.parentId:void 0,m=x.data?.type===r.OL.TEAM?x.data?.key.parentId:void 0,h=(0,l.Pe)(x.data?.tier??null,e),[{data:p,status:g},{fetchNextPage:f}]=(0,n.IT)(c.a.getResourcesByTeamPaginatedQuery({orgId:u??"",resourceType:[e],numTemplatesPerTeam:t+1,includeContent:!0}),{enabled:o&&!!u&&h&&d}),_=(0,a.useMemo)(()=>p?.flatMap(e=>e.resources)??[],[p]),y=_.length>t,[{data:j,status:k},{fetchNextPage:v}]=(0,n.IT)(c.a.ResourcesPaginatedQuery({resourceType:[e],caller:s,teamId:m,pageSize:t,includeContent:!0}),{enabled:o&&!!m&&h&&d}),b=j?.length&&j?.length>t,N=(0,a.useMemo)(()=>_.slice(0,t),[_,t]);return x.data?.type===r.OL.ORG?{resources:N,status:g,teamOrOrgName:x.data?.name??"",requestLoadMoreForTeam:y?f:void 0}:{resources:j??[],status:k,teamOrOrgName:x.data?.name??"",requestLoadMoreForTeam:b?v:void 0}}},183366:(e,t,s)=>{s.d(t,{j:()=>l});var a=s(638004),n=s(550209),r=s(113139),i=s(292168);let l=new class{constructor(){this.ResourceUseSchemaValidator=(0,r.YV)("ResourceUseSchema",i.tF,null)}async addResourceUse(e){try{return await this.ResourceUseSchemaValidator.validate(({xr:t})=>"resourceId"in e?t.post(`/api/resource_uses/${e.resourceId}`):t.post(`/api/resource_uses/template/${e.templateId}`))}catch(e){(0,n.$D)(a.e.COMMUNITY,e)}}}},810149:(e,t,s)=>{s.d(t,{ES:()=>r,KO:()=>i,ci:()=>l,wy:()=>n});var a=s(795033);let n=(0,s(985416).Wh)(()=>(0,a.eU)(new Set)),r=(0,a.eU)(null),i=(0,a.eU)(!1);function l(e){let t=e.split("/"),s="",r=new Set;for(let e of t)s=`${s}/${e}`,r.add(s);a.zl.set(n,e=>new Set([...e,...r]))}},384658:(e,t,s)=>{s.d(t,{N:()=>l});var a=s(104076),n=s(716976),r=s(858959);let i="shimmer_text--container--hdMNz",l=(0,n.memo)(({children:e,duration:t=2,baseColor:s="#a1a1aa",shimmerColor:l="#000",spread:c=2,as:o="p",noWrap:x=!0})=>{let d=(0,n.useMemo)(()=>Math.min(e.length*c,100),[e,c]),u=`linear-gradient(
        90deg,
        transparent calc(50% - ${d}px),
        ${l} 50%,
        transparent calc(50% + ${d}px)
      ),
      linear-gradient(${s}, ${s})`,m=x?`${i} shimmer_text--noWrap--RtJ98`:i,h=(0,r.P)(o);return(0,a.jsx)(h,{className:m,style:{backgroundImage:u,width:"fit-content"},initial:{backgroundPosition:"100% center"},animate:{backgroundPosition:"0% center"},transition:{duration:t,repeat:1/0,ease:"linear"},children:e})})},549936:(e,t,s)=>{s.d(t,{F:()=>L});var a=s(104076),n=s(716976),r=s(651234),i=s(420680),l=s(827695),c=s(782747),o=s(227244),x=s(476816),d=s(312325),u=s(236707),m=s(812714),h=s(795033),p=s(120440),g=s(561839),f=s(858959),_=s(384658),y=s(192075),j=s(389006),k=s(624320),v=s(963433),b=s(127082),N=s(107799),C=s(297174),E=s(24441);function w(){return(0,a.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none","aria-label":(0,y.t)("figmake.code_chat.live_dot_aria_label"),children:[(0,a.jsx)("path",{d:"M18 12C18 15.3137 15.3137 18 12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12Z",fill:"#14AE5C"}),(0,a.jsx)("path",{d:"M17 12C17 14.7614 14.7614 17 12 17C9.23858 17 7 14.7614 7 12C7 9.23858 9.23858 7 12 7C14.7614 7 17 9.23858 17 12Z",stroke:"white",strokeOpacity:"0.6",strokeWidth:"2"})]})}let z={artifactContainer:{k1xSpc:"x78zum5",kVAM5u:"x7z60cl",kaIpWk:"x9h44rk",kMzoRj:"xmkeg23",ksu8eU:"x1y0btm7",k8WAf4:"x1vvogim",kg3NbH:"xaope02",kLWn49:"x1o2sk6j",$$css:!0},inProgress:{kMwMTN:"x1akne3o",$$css:!0}};function T({toolCall:e}){return(0,a.jsx)(S,{icon:"view_tool"===e.toolName?(0,a.jsx)(c._,{}):"delete_tool"===e.toolName?(0,a.jsx)(o.z,{}):"file_search"===e.toolName?(0,a.jsx)(x.h,{}):null,text:function(e){let t=(0,C.N)(e);switch(e.toolName){case"view_tool":if(t)return(0,y.t)("figmake.tool_call.viewing",{file:t});break;case"write_tool":case"fast_apply_tool":case"edit_tool":if(t)return(0,y.t)("figmake.tool_call.writing",{file:t});break;case"think":break;case"delete_tool":if(t)return(0,y.t)("figmake.tool_call.deleting",{file:t});break;case"file_search":return(0,y.t)("figmake.tool_call.searching")}return(0,y.t)("figmake.chat.working")}(e)})}function S({text:e,icon:t}){return(0,a.jsxs)("div",{className:"x78zum5 x1n0bwc9 x193iq5w x1q0g3np x6s0dn4",children:[(0,a.jsx)("div",{className:"x78zum5 x2lah0s",children:t}),(0,a.jsx)("span",{className:"x78zum5 x1iog12x x12lumcd xb3r6kr xlyipyv xuxw1ft",children:(0,a.jsx)(_.N,{children:e??""})})]})}function A({children:e,isInProgress:t,isCurrentVersion:s}){let{artifactTypographyStyle:n,artifactActiveTypographyStyle:r}=(0,E.L)();return(0,a.jsx)("div",{"aria-current":s?"true":void 0,...p.Ay.props(z.artifactContainer,s?r:n,t?z.inProgress:void 0),children:e})}function L(e){let{chatMessagesNodeGuid:t,layerDisplayName:s,type:c}=e,x=(0,h.md)((0,C.l)(t)),{exchange:p}=(0,N.$W)(t),E=(0,b.Oc)(),z="progress"===e.type&&e.showCodeStreaming&&p?function(e){if(!(e&&e.messages.length>0))return;let t=e?.messages[e.messages.length-1];for(let e of t?.toolCalls??[]){let t=(0,r.m4)(e);if(t)return t}let s=(0,r.H5)(t?.textContent||""),a=e.fileUpdates[e.fileUpdates.length-1];return s.code?s.code:a?a.contents:void 0}(p):void 0,L="progress"===e.type?e.scrollToBottom:null;(0,n.useEffect)(()=>{z&&L&&L()},[z,L]);let q="version"===c&&e.isCurrentVersion,I="version"===c?e.versionNumber:0,O="version"===c?e.versionTitle:void 0,M="version"===c?e.restoreVersion:void 0,F=(0,m.kc)().bake_version_titles&&E,D=n.useMemo(()=>"progress"===c?null:"version"===c?F&&O?(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf",children:[(0,a.jsx)("h3",{className:"x6xwguf",children:O}),(0,a.jsx)("div",{className:"x1yuz8eb",children:(0,y.t)("figmake.chat.artifact.version",{version:I})})]}):q?(0,y.t)("figmake.chat.artifact.latest_version"):(0,y.t)("figmake.chat.artifact.version",{version:I}):null,[c,q,O,I,F]),R=null;R=x?.type==="toolCall"?(0,a.jsx)(T,{toolCall:x}):x?.type==="code"?(0,a.jsx)(S,{icon:(0,a.jsx)(d.A,{}),text:(0,y.t)("figmake.tool_call.writing",{file:s??x.fullFilePath})}):x?.type==="editedFiles"?(0,a.jsx)(S,{icon:(0,a.jsx)(d.A,{}),text:(0,y.t)("figmake.tool_call.editing",{file:x.files.join(", ")})}):x?.type==="deletedFiles"?(0,a.jsx)(S,{icon:(0,a.jsx)(o.z,{}),text:(0,y.t)("figmake.tool_call.deleting",{file:x.files.join(", ")})}):(0,a.jsx)("div",{className:"x78zum5 x1q0g3np x1n0bwc9 x193iq5w x6s0dn4",children:(0,a.jsx)(_.N,{children:(0,y.t)("figmake.chat.working")})});let P=(0,C.N)(x),U="progress"===c?null:M?(0,a.jsx)(i.K,{"aria-label":(0,y.t)("figmake.chat.artifact.restore"),"aria-description":(0,y.t)("figmake.chat.artifact.aria_restore_description",{version:I,title:O||""}),onClick:M,children:(0,a.jsx)(u.H,{})}):null,G=(0,v.g7)()?(0,a.jsx)(k.iE,{openInSameTab:!0}):(0,a.jsx)(w,{}),$="progress"===c?(0,a.jsx)(l.k,{}):q?G:U;return(0,a.jsx)(A,{isInProgress:"progress"===c,isCurrentVersion:q,children:(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf xh8yej3",children:[(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1qughib xh8yej3",children:[(0,a.jsx)("div",{className:"x78zum5 x845mor xb3r6kr xlyipyv xuxw1ft xeuugli",title:P??"",children:"progress"===c?R:D}),(0,a.jsx)("div",{className:"x78zum5 x6s0dn4 xet2fuk x2lah0s",children:$})]}),(0,a.jsx)(g.N,{children:!!z&&(0,a.jsxs)(f.P.div,{initial:{height:0,opacity:0},animate:{height:128,opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"x78zum5 x1n2onr6 x47corl xdt5ytf x1cy8zhl xh8yej3 xb3r6kr",children:[(0,a.jsx)(f.P.div,{className:"x10l6tqk x13vifvy xu96u03 x3m8u43 x1vqgdyp x1vjfegm x1b0inr7"}),(0,a.jsx)(j.Or,{code:z,fileName:s??"",fullHeight:!0,maxHeight:"128px",onlyShowCode:!0})]})})]})})}},847112:(e,t,s)=>{s.d(t,{r:()=>nD});var a=s(104076),n=s(716976),r=s(903927),i=s(651234),l=s(542653),c=s(638004),o=s(420680),x=s(236707),d=s(291566),u=s(336129),m=s(780205),h=s(266808),p=s(170627),g=s(812714),f=s(795033),_=s(120440),y=s(561839),j=s(858959),k=s(883765),v=s(409019),b=s(550209),N=s(225125),C=s(390036),E=s(876621),w=s(192075),z=s(315361),T=s(366535),S=s(74620),A=s(211862),L=s(915013),q=s(298056),I=s(620720),O=s(577932),M=s(581006),F=s(107799),D=s(723339),R=s(533144),P=s(983685),U=s(351394),G=s(686586),$=s(789596),H=s(732277),B=s(631571),V=s(963433),W=s(127082),K=s(760697),Y=s(475477),X=s(263188),J=s(821655),Q=s(369729),Z=s(827695),ee=s(293422),et=s(684742),es=s(919118),ea=s(122765),en=s(894862);let er=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"m16.7 5.699.315-1.26c.126-.505.844-.505.97 0L18.3 5.7l1.26.315c.505.126.505.844 0 .97L18.3 7.3l-.315 1.26c-.126.505-.844.505-.97 0L16.7 7.3l-1.26-.315c-.505-.126-.505-.844 0-.97zM13 6a.5.5 0 0 1 0 1H7.5a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V11a.5.5 0 0 1 1 0v5.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 6 16.5v-9A1.5 1.5 0 0 1 7.5 6zm-2.146 4.146a.5.5 0 0 1 0 .708L9.707 12l1.147 1.146a.5.5 0 0 1-.708.708l-1.5-1.5a.5.5 0 0 1 0-.708l1.5-1.5a.5.5 0 0 1 .708 0m2.292.708a.5.5 0 0 1 .708-.708l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708-.708L14.293 12z",clipRule:"evenodd"})})});var ei=s(211764),el=s(457996),ec=s(890373),eo=s(95046),ex=s(219199),ed=s(328341),eu=s(352630),em=s(259161),eh=s(260745),ep=s(111297),eg=s(551037),ef=s(260027),e_=s(20267),ey=s(248043),ej=s(944350),ek=s(904017),ev=s(382137),eb=s(141330),eN=s(293172),eC=s(574433),eE=s(580276),ew=s(17933),ez=s(864980),eT=s(653899),eS=s(142914),eA=s(299986);let eL={chatBoxMessageRow:{kaIpWk:"x9h44rk",k1K539:"x38tqe7",kLKAdn:"x1y1aw1k",kg3NbH:"xdqyycr",kGO01o:"x1s51fez",kVAEAm:"x1n2onr6",kY2c9j:"x8knxv4",$$css:!0},chatBoxMessageRowPrimary:{kWkggS:"xu5wzci",kMwMTN:"x1tk3asg",k63SB2:"x1s688f",$$css:!0},chatBoxMessageRowError:{kWkggS:"x3yuajn",kMwMTN:"x172n1ly",$$css:!0},chatBoxMessageRowWarning:{kWkggS:"x1mt81i5",kMwMTN:"x12fzf0q",$$css:!0},chatBoxMessageRowCommunity:{kWkggS:"x1v8gsql",kMwMTN:"x1akne3o",$$css:!0},chatBoxMessageRowInfo:{kWkggS:"x1yjdb4r",kMzoRj:"xmkeg23",ksu8eU:"x1y0btm7",kVAM5u:"x7z60cl",kMwMTN:"x1akne3o",$$css:!0},chatBoxMessageRowWithClose:{kpe85a:"x1m2p0i2",$$css:!0}};function eq({children:e,secondaryContent:t,variant:s,onClose:n}){return(0,a.jsxs)("div",{..._.Ay.props(eL.chatBoxMessageRow,"primary"===s&&eL.chatBoxMessageRowPrimary,"error"===s&&eL.chatBoxMessageRowError,"warning"===s&&eL.chatBoxMessageRowWarning,"community"===s&&eL.chatBoxMessageRowCommunity,"info"===s&&eL.chatBoxMessageRowInfo,n&&eL.chatBoxMessageRowWithClose),children:[(0,a.jsxs)("div",{className:"x6s0dn4 x78zum5 x1q0g3np x1qughib",children:[e,n&&(0,a.jsx)("div",{className:"x10l6tqk xclnmbr",children:(0,a.jsx)(o.K,{onClick:n,"aria-label":(0,w.t)("living_designs.chat.errors.close"),children:(0,a.jsx)(eA.L,{})})})]}),t]})}var eI=s(622018),eO=s(32404),eM=s(836543);function eF(){let e=(0,eO.RK)(),t=e?.name??"",{isConnectedNonOwner:s}=(0,eO.zA)(),[r,i]=n.useState(!1),{getTriggerProps:l,getContainerProps:c,getArrowProps:o}=ew.fP({isOpen:r,onOpenChange:i,type:"dialog",openOnHover:!0,placement:"top"}),x=(0,f.Xr)(eN.Xl),d=(0,f.md)(eN.Xl),u=(0,f.md)(eN.GV),m=(0,eM.A)();return((0,eT.h)(()=>{u&&m({showVisualBells:!1})}),u||!d)?null:(0,a.jsx)(eq,{variant:"warning",onClose:()=>x(!1),children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xh8yej3","data-testid":"supabase-deploy-nudge",children:[(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x167g77z xkh2ocl x6s0dn4",children:[(0,a.jsx)("div",{className:"x1gxdvn5",children:(0,a.jsx)(ez.e,{})}),(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf",children:[(0,a.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:(0,w.t)("figmake.deploy_nudge.init.title")}),(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:(0,w.t)("figmake.deploy_nudge.init.subtitle")})]})]}),(0,a.jsxs)(ew.mc,{...c({style:{boxShadow:"var(--elevation-500-modal-window)",borderRadius:"var(--radius-large, 0.8125rem)",padding:"4px",background:"var(--color-bg)",width:"240px"}}),children:[(0,a.jsx)(ew.i3,{...o()}),(0,a.jsx)("div",{className:"x78zum5 xkh2ocl xz9dl7a xsag5q8 xnm25rq",children:(0,a.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:(0,w.t)("figmake.deploy_nudge.popover.title")})}),(0,a.jsx)("div",{className:"x178xt8z x13fuv20 x16ufvko xh8yej3"}),(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf xkh2ocl x1n565qt x15gqxvk x1l90r2v xpymby5 x1v2ro7d x1cy8zhl",children:[(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:(0,w.t)("figmake.deploy_nudge.popover.subtitle")}),(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x167g77z",children:[(0,a.jsx)(eI.ls,{size:eS.Pf.LARGE}),(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1nhvcw1",children:[(0,a.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:t}),(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,w.t)("figmake.deploy_nudge.popover.user_avatar.subtitle")})]}),(0,a.jsx)("div",{})]})]})]}),(0,a.jsx)(ee.$n,{variant:"secondary",disabled:s,onClick:()=>m({showVisualBells:!0}),...s?l({onClick:()=>m({showVisualBells:!0})}):{},children:(0,w.t)("figmake.settings.connected_project.deploy_button")})]})})}var eD=s(588961),eR=s(954700),eP=s(635533),eU=s(695777),eG=s(739815),e$=s(816424),eH=s(870611),eB=s(560566),eV=s(135260),eW=s(116285),eK=s(754695),eY=s(46261),eX=s(538743),eJ=s(884955),eQ=s(559013),eZ=s(277270),e0=s(29240),e1=s(205746),e5=s(151298);let e2=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M5 5h9v4h-4a1 1 0 0 0-1 1v4H5zm4 10H5a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v4h4a1 1 0 0 1 1 1v9a1 1 0 0 1-1 1h-9a1 1 0 0 1-1-1zm6-5h4v9h-9v-4h4a1 1 0 0 0 1-1zm-1 0v4h-4v-4z",clipRule:"evenodd"})})});function e7(e){switch(e){case"FRAME":default:return(0,a.jsx)(eK.q,{});case"GROUP":return(0,a.jsx)(eY.M,{});case"RECTANGLE":case"ROUNDED_RECTANGLE":return(0,a.jsx)(eX.y,{});case"TEXT":return(0,a.jsx)(eG.e,{});case"SYMBOL":case"INSTANCE":return(0,a.jsx)(eJ.y,{});case"VECTOR":return(0,a.jsx)(eQ.q,{});case"LINE":return(0,a.jsx)(eZ.h,{});case"ELLIPSE":return(0,a.jsx)(e0.B,{});case"REGULAR_POLYGON":return(0,a.jsx)(e1.o,{});case"STAR":return(0,a.jsx)(e5.e,{});case"BOOLEAN_OPERATION":return(0,a.jsx)(e2,{});case"SECTION":return(0,a.jsx)(eW.c,{})}}function e3({icon:e,label:t,variant:s="prompt",onRemove:n}){return(0,a.jsxs)("div",{...{0:{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 x1jnr06f x12oqio5 xeq5yr9 x16q51m2 x1ghz6dp xy13l1i xcr9a89 x1quhyk7"},1:{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xq1n1xh x14vqqas x1jnr06f x12oqio5 xeq5yr9 x16q51m2 x1v8gsql xmkeg23 x1y0btm7 x7z60cl x1akne3o"}}[!("prompt"!==s)<<0],children:[(0,a.jsx)("div",{children:e}),(0,a.jsx)("div",{className:"xb3r6kr xlyipyv xuxw1ft xazcve0",children:t}),"prompt"===s&&n?(0,a.jsx)(o.K,{"aria-label":(0,w.t)("figmake.chat.click_to_inspect.remove"),onClick:n,children:(0,a.jsx)(eU.f,{className:"xmauxvm"})}):null]})}function e6({tagName:e,variant:t="prompt"}){let s=(0,f.md)(M.f3),r=n.useCallback(()=>{s?.setDirectManipulationEnabled({enabled:!1})},[s]);return(0,a.jsx)(e3,{icon:e8(e,t),label:e,variant:t,onRemove:"prompt"===t?r:void 0})}let e8=(e,t)=>{let s={0:{className:"x1aue78i"},1:{className:"xmauxvm"}}[!("prompt"!==t)<<0];switch(e.toLocaleLowerCase()){case"p":case"span":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"label":case"strong":case"em":case"b":case"i":return(0,a.jsx)(eG.e,{...s});case"a":return(0,a.jsx)(e$.r,{...s});case"img":case"video":return(0,a.jsx)(eH.s,{...s});case"li":case"ul":return(0,a.jsx)(eB.Z,{...s});case"ol":return(0,a.jsx)(eV.p,{...s});default:return(0,a.jsx)(eW.c,{...s})}};function e4({nodes:e,variant:t="prompt"}){if(0===e.length||!e[0])return null;let s=e[0],n=e9(s.type,t),r=e.length>1?(0,w.t)("ai_assistant.selected_layers_count",{count:e.length}):s.name;return(0,a.jsx)(e3,{icon:n,label:r,variant:t,onRemove:"prompt"===t?()=>h.Egt?.clearSelection():void 0})}let e9=(e,t)=>{let s=e7(e);return n.cloneElement(s,{0:{className:"x1aue78i"},1:{className:"xmauxvm"}}[!("prompt"!==t)<<0])};var te=s(933135);let tt=(0,n.memo)(function(e){return(0,te.O)()?(0,a.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M4 11a1 1 0 1 1 0 2 1 1 0 0 1 0-2m8.6.51a.5.5 0 0 1 0 .98l-.1.01h-5a.5.5 0 0 1 0-1h5zM4 7a1 1 0 1 1 0 2 1 1 0 0 1 0-2m8.6.51a.5.5 0 0 1 0 .98l-.1.01h-5a.5.5 0 0 1 0-1h5zM4 3a1 1 0 1 1 0 2 1 1 0 0 1 0-2m8.6.51a.5.5 0 0 1 0 .98l-.1.01h-5a.5.5 0 0 1 0-1h5z"})}):(0,a.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M4 10.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2m8.5.5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1zM4 6.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2m8.5.5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1zM4 2.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2m8.5.5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1z"})})});var ts=s(959858),ta=s(478855),tn=s(602755),tr=s(261990),ti=s(130724),tl=s(468855),tc=s(252285),to=s(389006);let tx="IN PROGRESS: ",td=e=>{let t=e.split("\n"),s=[],a=1;for(let e of t){let t=e.trim().match(/^[-*+]\s*\[(.)\]\s*(.+)$/);if(t&&t[1]&&t[2]){let e;let n=t[1].toLowerCase(),r=t[2].trim();"x"===n?(r.startsWith(tx)&&(r=r.substring(tx.length)),e="DONE"):"-"===n?e="IN_PROGRESS":r.startsWith(tx)?(e="IN_PROGRESS",r=r.substring(tx.length)):e="TODO",s.push({id:a++,status:e,text:r})}}return s},tu=(0,tc.H)(!1),tm=(0,f.eU)(new Set),th=(0,f.eU)(null,(e,t,s)=>{t(tu(s),!0),t(tm,e=>new Set([...e,s]))}),tp=(0,f.eU)("closed");function tg(){let e=function(){let{codeLibraryInstance:e}=(0,V.oA)(),{exchange:t}=(0,F.$W)(e?.guid),{code:s}=(0,to.pY)(t,tl.L5),a=(0,l.$d)()[tl.L5],r=s??a?.sourceCode;return(0,n.useMemo)(()=>r?td(r):[],[r])}(),t=function(){let{codeLibraryInstance:e}=(0,V.oA)(),{exchange:t}=(0,F.$W)(e?.guid);return void 0!==t&&t.messages.length}(),[s,r]=(0,f.fp)(tp),[i,c]=(0,n.useState)(null),o=(0,n.useRef)(null),x=(0,n.useRef)([]),d=(0,f.md)(tm).size>0;(0,n.useEffect)(()=>{let t=x.current.find(t=>{let s=e.find(e=>e.id===t.id);return"IN_PROGRESS"===t.status&&s?.status==="DONE"});t&&(o.current&&clearTimeout(o.current),c(t.id),o.current=setTimeout(()=>{c(null),o.current=null},1500)),x.current=e},[e]),(0,n.useEffect)(()=>()=>{o.current&&clearTimeout(o.current)},[]),(0,n.useEffect)(()=>{if("open"===s){let t=setTimeout(()=>{let t=e.find(e=>"IN_PROGRESS"===e.status||"TODO"===e.status);if(t){let e=Array.from(document.querySelectorAll("[data-task-text]")).find(e=>e.textContent?.trim()===t.text.trim());e&&e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}},100);return()=>clearTimeout(t)}},[s,e]);let u=e.length,m=e.filter(e=>"TODO"===e.status||"IN_PROGRESS"===e.status).length,h=e.filter(e=>"DONE"===e.status).length,p=e.find(e=>"IN_PROGRESS"===e.status)??e.find(e=>"TODO"===e.status),g=i?e.find(e=>e.id===i):null,_=g||p,k=t&&"closed"===s&&_;return(0,n.useEffect)(()=>{t||c(null)},[t]),(0,a.jsx)("div",{className:"x78zum5 xr9ek0c x1o6q14k x1e56ztr xq1n1xh x1n2onr6",children:(0,a.jsx)(y.N,{children:d&&u>0&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(j.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3,ease:"easeInOut"},style:{width:"100%",zIndex:1},children:(0,a.jsxs)("div",{className:"xmkeg23 x1y0btm7 x51372i x9h44rk xb3r6kr xdt5ytf x1b58sdr x1xpa7k x18d9i69 x1uhho1l",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>r("open"===s?"closed":"open"),className:"xrbhpiw xh8yej3 xrvj5dj x13z6uf9 xlnvzos x6s0dn4 x1qughib xexx8yu x1arb9wb xmnamis x15u6esi xjbqb8w x9rcprn",children:[(0,a.jsxs)("div",{className:"x13z6uf9 x78zum5 x6s0dn4",children:[(0,a.jsx)(tt,{}),(0,a.jsx)("span",{className:"xuxw1ft",children:(0,w.tx)("figmake.chat.todos_popup.header")}),(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np xvh977a",children:[(0,a.jsx)(ts.x,{className:"x130pnmk"}),(0,a.jsx)("span",{children:h}),m>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ta.H,{className:"x1ss0p3d"}),(0,a.jsx)("span",{children:m})]})]})]}),(0,a.jsx)("div",{className:"x78zum5 x6s0dn4 x13a6bvl x13z6uf9 xb3r6kr",children:(0,a.jsx)(y.N,{mode:"wait",children:k&&(0,a.jsxs)(j.P.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.2,ease:"easeInOut"},className:"x78zum5 x6s0dn4 xg2d0mh xeuugli x4oah1p xewu7z0 x2ua9qx x1dnis8n xawads1",children:["IN_PROGRESS"===_.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"x1ppiq6k",children:(0,a.jsx)(Z.k,{size:"sm"})}),(0,a.jsx)("span",{className:"xb3r6kr xlyipyv xuxw1ft x1quhyk7",children:_.text})]}),"DONE"===_.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.P.div,{initial:g?{scale:0}:{},animate:g?{scale:1}:{},transition:g?{type:"spring",stiffness:400,damping:20}:{},children:(0,a.jsx)(ts.x,{className:"xoqga94"})}),(0,a.jsx)("span",{className:"xb3r6kr xlyipyv xuxw1ft xq6u9c4 xmqliwb",children:_.text})]})]},_.id)})}),"open"===s?(0,a.jsx)(tn.O,{}):(0,a.jsx)(tr.t,{})]}),(0,a.jsx)(y.N,{children:"open"===s&&(0,a.jsx)(j.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3,ease:"easeInOut"},className:"x178xt8z x13fuv20 xrvxksm xb3r6kr",children:(0,a.jsx)("div",{className:"x1w2wdq1 x1odjw0f x1ia1hqs x1a2w583 xketyf0 x75xtda x7gbtqy",children:e.length>0?(0,a.jsx)("div",{children:e.map((e,t)=>(0,a.jsx)(tf,{task:e,index:t},t+e.text))}):(0,a.jsx)("p",{children:(0,w.tx)("figmake.chat.todos_popup.no_tasks_yet")})})})})]})})})})})}function tf({task:e,index:t}){return(0,a.jsxs)(j.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,x:20},transition:{duration:.15,delay:.02*t,type:"ease-out"},className:"x78zum5 x1cy8zhl x1nfngrj x1gskr33 x1ihwiht x1n2onr6",children:[(0,a.jsxs)("div",{className:"x2lah0s x78zum5 x6s0dn4 xl56j7k",children:["TODO"===e.status&&(0,a.jsx)(ta.H,{className:"x18km98s"}),"IN_PROGRESS"===e.status&&(0,a.jsx)(j.P.div,{animate:{rotate:360},transition:{duration:2.5,repeat:1/0,ease:"linear"},children:(0,a.jsx)(ti._,{})}),"DONE"===e.status&&(0,a.jsx)(j.P.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:400,damping:20},children:(0,a.jsx)(ts.x,{className:"x130pnmk"})})]}),(0,a.jsx)("div",{className:"x98rzlu xeuugli",children:(0,a.jsx)("p",{...{0:{className:"xboafo0 xl2ypbo x1n0bwc9 xt3l3uh x13dflua"},1:{className:"xboafo0 xl2ypbo xt3l3uh x13dflua x3vvef7 xmqliwb"}}[!("DONE"!==e.status)<<0],"data-task-text":e.text,children:e.text})})]})}var t_=s(622107),ty=s(872966),tj=s(266230),tk=s(51656),tv=s(190028),tb=s(529186),tN=s(443192),tC=s(174730),tE=s(590662);let tw="dismissed_chat_soft_limit_banner";var tz=s(157067),tT=s(447556),tS=s(699374),tA=s(754038),tL=s(208882),tq=s(350819),tI=s(944520),tO=s(11395),tM=s(201482),tF=s(343398),tD=s(619794);function tR(){let e=(0,tF.Y9)((0,w.t)("auth.welcome-to-figma")),t=(0,r.wA)();return(0,a.jsx)(ep.fu,{name:"Logged Out File Chatbox Banner",children:(0,a.jsxs)("div",{className:"x9f619 x78zum5 x1y1aw1k xnuq7ks x18d9i69 xnm25rq x9a3u73 x1cy8zhl x1mxnbhz x131gfan x1mgsydn x167g77z",children:[(0,a.jsx)("div",{className:"x1tk3asg x1g2dr8m xiqqdae x1j61x8r xkezfkh x14kxzw3 xqp8s7e x78zum5 x6s0dn4 xxk0z11 x1iyjqo2 xeuugli",children:(0,a.jsx)("span",{className:"xb3r6kr xuxw1ft xlyipyv",children:(0,w.t)("auth.sign_up_to_use_figma_rev")})}),(0,a.jsxs)("div",{className:"xeq5yr9 x78zum5 x13a6bvl x167g77z x3psx0u",children:[(0,a.jsx)(et.E,{onClick:()=>{(0,tO.UK)("SIGN_UP_BUTTON_BANNER"),e({origin:tA.ty.FIGMA_REV_LOGGED_OUT_FOOTER,formState:tq.qB.SIGN_UP})},className:"xxk0z11 x16v0e3u xf67zum x19y5rnk x1akne3o x2b8uid xeq5yr9 xclx6tv xiqqdae x1j61x8r xkezfkh x14kxzw3 xqp8s7e x2lah0s",children:(0,w.t)("auth.sign_up")}),(0,a.jsx)(tM.M,{onClick:()=>{(0,tO.UK)("GOOGLE_SSO_BUTTON"),(0,tA.Rm)({dispatch:t,origin:tA.ty.FIGMA_REV_LOGGED_OUT_FOOTER_WITH_GOOGLE,redirectUrl:ex.Ay.location.pathname}).then(e=>{"login"===e.type&&t(tL.My({userId:e.user.id}))},e=>{(0,tI.g)("google_signup_error",tA.ty.FIGMA_REV_LOGGED_OUT_FOOTER_WITH_GOOGLE,{error:e.message}),(0,g.kc)().ff_show_auth_modal_on_google_sso_error&&(0,tA.Y2)({dispatch:t,origin:tA.ty.FIGMA_REV_LOGGED_OUT_FOOTER_WITH_GOOGLE,message:e.message,redirectUrl:ex.Ay.location.pathname})})}})]}),(0,a.jsx)(tD.P,{origin:tA.DT.LOGGED_OUT_FILE,overrideUseFedCMPrompt:!1})]})})}var tP=s(210028),tU=s(104035);function tG({children:e}){return(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x2lah0s xr9ek0c x1o6q14k x1yztbdb xq1n1xh x7wzq59 x1ey2m1c","data-onboarding-key":$.HB,children:e})}function t$(){return(0,a.jsx)(Y.N,{href:"https://creativecommons.org/licenses/by/4.0/",newTab:!0,children:(0,w.tx)("design_systems.preset_libraries.tooltip.figma_license_link")})}function tH({communityAttributions:e,onClose:t}){if(e.length<=0||e.length>3)return null;let s=e.map(e=>(0,a.jsx)(em.Ph,{newTab:!0,href:(0,ey.X$)(e.hubFileId),trusted:!0,children:(0,C.EJ)(e.hubFileName,30)},e.hubFileId));return(0,a.jsx)(eq,{variant:"community",onClose:t,children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x17d4w8g",children:[(0,a.jsx)("div",{className:"x2lah0s",children:(0,a.jsx)(es.f,{})}),(0,a.jsx)("div",{children:1===e.length?(0,w.tx)("figmake.chat.community_attribution.attributions_one",{hubFileLink:s[0],creatorName:e[0].creatorName,licenseLink:(0,a.jsx)(t$,{})}):2===e.length?(0,w.tx)("figmake.chat.community_attribution.attributions_two",{hubFileLink1:s[0],hubFileLink2:s[1],licenseLink:(0,a.jsx)(t$,{})}):(0,w.tx)("figmake.chat.community_attribution.attributions_three",{hubFileLink1:s[0],hubFileLink2:s[1],hubFileLink3:s[2],licenseLink:(0,a.jsx)(t$,{})})})]})})}let tB=(0,ep.tf)(X.$);function tV({licenseType:e,onClose:t}){let s=(0,ek.No)(),n=s.unwrapOr(null)?.tier,{getProvisionalAccessBanner:r,getPendingRequest:i}=(0,ev.wH)(),{text:l,shouldShowCurf:c}=r(e),{curfCtaHandler:o,curfCtaLabel:x}=(0,ev.mT)(e),d=l;return c||i(e)?.entryPoint!==eh.tc.CODE_CHAT_LIMIT||(d=(0,w.t)("fullscreen.toolbar_banner.provisional_access.code_chat")),(0,a.jsx)(ep.fu,{name:"ChatBoxProvisionalAccessBanner",properties:{tier:n},children:(0,a.jsx)("div",{className:"xyorhqc","data-testid":"provisional-access-banner",children:(0,a.jsxs)(J.Yy,{variant:"brand",icon:null,onDismiss:t,children:[(0,a.jsx)(Q.Q,{children:d}),c&&(0,a.jsx)(tB,{onClick:o,children:x})]})})})}function tW({onClose:e}){let t=(0,ek.No)(),s=t.unwrapOr(null)?.tier,n=(0,w.tx)("figmake.meter_limit.reached_future_credit_limit",{learnMoreLink:(0,a.jsx)(em.Ph,{newTab:!0,trusted:!0,href:eb._t,children:(0,w.tx)("general.learn_more")})});return(0,a.jsx)(ep.fu,{name:"ChatBoxSoftLimitBanner",properties:{tier:s},children:(0,a.jsx)("div",{className:"xyorhqc","data-testid":"chat-soft-limit-banner",children:(0,a.jsx)(J.Yy,{variant:"brand",icon:null,onDismiss:e,children:(0,a.jsx)(Q.Q,{children:n})})})})}function tK({testId:e,config:t,trackingProperties:s}){return(0,a.jsx)(ep.fu,{name:"ChatBoxToast",properties:s,children:(0,a.jsx)("div",{className:"xyorhqc","data-testid":e,children:(0,a.jsx)(J.Yy,{variant:"brand",icon:t.icon,children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib xou54vl x6s0dn4 xh8yej3",children:[(0,a.jsx)("div",{className:"x78zum5 x1q0g3np xkh2ocl x6s0dn4",children:(0,a.jsx)(Q.Q,{title:t.title,children:t.content?.()})}),t.button]})})})})}function tY(){return(0,a.jsx)(ep.fu,{name:"ChatBoxToast-InProgress",children:(0,a.jsx)("div",{className:"xyorhqc x1iwbaqv","data-testid":"mobile-in-progress-banner",children:(0,a.jsx)(J.Yy,{variant:"brand",icon:(0,a.jsx)(Z.k,{}),children:(0,a.jsx)("div",{className:"x78zum5 x1q0g3np x1qughib xou54vl x6s0dn4 xh8yej3",children:(0,a.jsx)("div",{className:"x78zum5 x1q0g3np xkh2ocl x6s0dn4",children:(0,a.jsx)(Q.Q,{children:(0,w.t)("make_mobile_chat.working_on_it_stay_on")})})})})})})}function tX(){let{openFigmakeFullscreenInSameTab:e}=(0,V.Ve)();return(0,a.jsx)(ep.fu,{name:"ChatBoxToast-Complete",children:(0,a.jsx)("div",{className:"xyorhqc","data-testid":"mobile-complete-banner",children:(0,a.jsx)(J.Yy,{variant:"success",icon:(0,a.jsx)(ea.U,{}),children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib xou54vl x6s0dn4 xh8yej3",children:[(0,a.jsx)("div",{className:"x78zum5 x1q0g3np xkh2ocl x6s0dn4",children:(0,a.jsx)(Q.Q,{children:(0,w.t)("make_mobile_chat.all_set")})}),(0,a.jsx)("div",{className:"xu159t0 xpavgux",children:(0,a.jsx)(eu.$z,{variant:"primary",onClick:e,children:(0,w.t)("make_mobile_chat.preview")})})]})})})})}function tJ({attachments:e,clearAttachment:t}){return e&&e.filter(e=>"error"!==e.status).length>0?(0,a.jsx)("div",{className:"x78zum5 x1q0g3np x167g77z x14vqqas x1wsuqlk xat24cr xq1n1xh",children:e.map(e=>"error"===e.status?null:(0,a.jsx)(tP.V,{attachment:e,clearAttachment:t},e.uniqueId))}):null}function tQ(){let e=(0,eR.P)(),t=(0,f.Xr)(eN.rK);return(0,a.jsx)(eq,{variant:"error",onClose:()=>t(!1),children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xh8yej3","data-testid":"supabase-error-banner",children:[(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x167g77z xkh2ocl x6s0dn4",children:[(0,a.jsx)(en.Z,{"aria-hidden":!0,style:{"--color-icon":"currentColor"}}),(0,w.t)("figmake.supabase_error.title")]}),(0,a.jsx)(ee.$n,{variant:"secondary",onClick:e,children:(0,w.t)("figmake.supabase_error.button")})]})})}function tZ({text:e}){let[t,s]=(0,n.useState)(!1),r=(0,n.useRef)(null);return(0,a.jsx)(et.E,{onClick:()=>{navigator.clipboard.writeText(e),s(!0),r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{s(!1)},1e3)},"aria-label":(0,w.t)("figmake.chat_box.error.copy_request_id"),children:t?(0,w.t)("figmake.chat_box.error.request_id_copied"):e})}function t0({chatError:e,onClose:t,onRetry:s}){let{error:n,cortexClientGeneratedRequestUuid:r}=e,{node:i,dismissable:l}=(0,ty.u1)({error:n}),c=!1,o=!1,x=!1;if(n.message===tk.T_.ATTACHMENTS_TOO_LARGE||n.message===tk.T_.MAX_CONTENT_LENGTH_EXCEEDED||n.message===tk.T_.MAX_CONTEXT_LENGTH_EXCEEDED_IMAGE_FALLBACK)o=!0;else if(n.message===tk.T_.PROMPT_ENHANCEMENT_FAILED)o=!0;else if(n.message===tk.T_.OUTDATED_CLIENT_ERROR)x=!0;else{let e=(0,e_.sZ)(n);c=[ef.B.GENERIC,ef.B.OFFLINE,ef.B.NETWORK_ERROR,ef.B.RATE_LIMIT_EXCEEDED].includes(e),o=[ef.B.CONTENT_LENGTH_LIMIT,ef.B.UNSAFE_OR_HARMFUL_CONTENT].includes(e)}let d=!r;return(0,a.jsx)(eq,{variant:o?"warning":"error",onClose:l?t:void 0,secondaryContent:r&&(0,a.jsxs)("div",{className:"xrybvsa x15r87gk xh8yej3 x78zum5 xozqiw3 xg2d0mh",children:[(0,a.jsx)("p",{children:(0,w.t)("figmake.chat_box.error.request_id")}),(0,a.jsx)(tZ,{text:r})]}),children:(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x1cy8zhl x1nfngrj xh8yej3",children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 xg2d0mh xh8yej3",children:[d&&(0,a.jsx)("span",{className:"xvy4d1p",children:d&&(0,a.jsx)(en.Z,{"aria-hidden":!0,style:{"--color-icon":"currentColor"}})}),(0,a.jsx)("div",{role:"alert",...{0:{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x1iyjqo2"},1:{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x1iyjqo2 xrybvsa"}}[!d<<0],children:i}),c&&s&&(0,a.jsx)("div",{className:"x1yjdb4r x78zum5 x1q0g3np x6s0dn4 x167g77z x19y5rnk",children:(0,a.jsx)(ee.$n,{variant:"secondary",onClick:s,children:(0,w.t)("ai.try_again")})}),x&&(0,a.jsx)("div",{className:"x1yjdb4r x78zum5 x1q0g3np x6s0dn4 x167g77z x19y5rnk",children:(0,a.jsx)(ee.$n,{variant:"secondary",onClick:()=>ex.Ay.reload("AI Assistant: Outdated Client Error"),children:(0,w.t)("ai.refresh_page")})})]})})})}function t1({onClose:e,requestFixErrors:t,errorFixingDisabled:s,isLastUserMessageAutoErrorFix:n,errorCount:r,variant:i}){let l=(0,f.Xr)(M.YD),c=(0,f.Xr)(M.Vo),o=(0,w.t)("living_designs.chat.errors.error_count",{count:r});return o="error"===i?n?r>10?(0,w.t)("figmake.errors.autofix_failed_max_errors",{maxCount:10}):(0,w.t)("figmake.errors.autofix_failed",{count:r}):r>10?(0,w.t)("figmake.errors.max_errors",{maxCount:10}):(0,w.t)("living_designs.chat.errors.error_count",{count:r}):r>10?(0,w.t)("figmake.chat.warning_message_max_errors",{maxCount:10}):(0,w.t)("figmake.chat.warning_message",{count:r}),(0,a.jsxs)(eq,{variant:i,onClose:e,children:[(0,a.jsx)(et.E,{onClick:()=>{l(!0),c("console")},...{0:{className:"xjbqb8w x1ypdohk"},2:{className:"xjbqb8w x1ypdohk x172n1ly"},1:{className:"xjbqb8w x1ypdohk x1akne3o"},3:{className:"xjbqb8w x1ypdohk x1akne3o"}}[!("error"!==i)<<1|!("info"!==i)<<0],children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1jnr06f",children:[(0,a.jsx)(en.Z,{"aria-hidden":!0,style:{"--color-icon":"currentColor"}}),(0,a.jsx)("div",{style:{color:"currentColor"},children:o})]})}),(0,a.jsx)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z x19y5rnk x1yjdb4r",children:(0,a.jsx)(ee.$n,{variant:"secondary",onClick:t,disabled:s,children:(0,w.t)("living_designs.chat.errors.ask_figma_fix")})})]})}function t5({onClose:e}){return(0,a.jsx)(eq,{variant:"info",onClose:e,children:(0,a.jsxs)("span",{className:"x78zum5 x1q0g3np x6s0dn4 x1jnr06f",children:[(0,a.jsx)(er,{}),(0,w.t)("figmake.chat.autofix_message")]})})}function t2({state:e}){return"chatDisabled"===e.type?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t_.$X,{testId:"chat-box-toast",renderer:tK}),e.showLoggedOutBanner&&(0,a.jsx)(tR,{})]}):"supabaseNudge"===e.type?(0,a.jsx)(eF,{}):"supabaseError"===e.type?(0,a.jsx)(tQ,{}):"chatError"===e.type?(0,a.jsx)(t0,{chatError:e.chatError,onClose:e.onClose,onRetry:e.onRetry}):"consoleErrors"===e.type?(0,a.jsx)(t1,{onClose:e.onClose,requestFixErrors:e.requestFixErrors,errorFixingDisabled:e.errorFixingDisabled,isLastUserMessageAutoErrorFix:e.isLastUserMessageAutoErrorFix,errorCount:e.errorCount,variant:e.variant}):"selfHealing"===e.type?(0,a.jsx)(t5,{onClose:e.onClose}):"communityAttribution"===e.type?(0,a.jsx)(tH,{communityAttributions:e.communityAttributions,onClose:e.onClose}):"chatSoftLimit"===e.type?(0,a.jsx)(tW,{onClose:e.onClose}):"provisionalAccess"===e.type?(0,a.jsx)(tV,{licenseType:e.licenseType,onClose:e.onClose}):"mobileInProgress"===e.type?(0,a.jsx)(tY,{}):"mobileComplete"===e.type?(0,a.jsx)(tX,{}):null}let t7=n.forwardRef((e,t)=>{let{placeholderText:s,canSend:i,sendMessage:l,chatBoxLeftExtraContent:c,chatBoxRightExtraContent:o,inspectedElement:x,errorFixingDisabled:d,showPasteDesignsCallout:u,generationInProgress:m,chatMessagesNodeGuid:h,canCancelGeneration:p,chatContainerRef:_,isDraggingAttachment:y,chatMessageCount:j,isLastUserMessageAutoErrorFix:k,featureType:v,onFocus:b}=e,[N,E]=(0,f.fp)((0,F.mC)(h)),{chatError:z,clearChatError:T}=(0,tk.tk)(h),[S,A]=(0,eC.jT)(),[L]=(0,eD.PM)(),q=S.filter(e=>"error"===e.type||"warn"===e.type),I=(0,ed.ZC)(q),O=n.useMemo(()=>q.every(e=>"warn"===e.type)&&0===L.length,[q,L]),M=(0,ed.ZC)(j),[R,P]=(0,n.useState)(!1),U=i&&!(0,C.jN)(N),G=function(e){let[t,s]=n.useState(!1),a=n.useRef(null);return n.useEffect(()=>(a.current&&clearTimeout(a.current),s(e.length>0),a.current=setTimeout(()=>{s(!1)},1e4),()=>{a.current&&clearTimeout(a.current)}),[e]),t}(N);n.useEffect(()=>{let e=(0,F.A5)(h);e?e.isTyping!==G&&(0,F.YZ)({...e,isTyping:G}):h&&(0,F.YZ)({node:h,isTyping:G,messages:[],fileUpdates:[]})},[G,h]),n.useEffect(()=>{(I?.length!==q.length||M!==j)&&P(!1)},[I,q,M,j]);let[$,H]=(0,f.fp)((0,eP.o0)(h)),[B,K]=(0,f.fp)((0,eP.AK)(h)),[Y,X]=(0,n.useState)(300),[J,Q]=(0,n.useState)(0),{communityAttributionDisplay:Z,clearCommunityAttributionDisplay:ee}=(0,tz.Pe)();(0,n.useEffect)(()=>{if(!_?.current)return;let e=()=>{X(Math.max(64,.4*(_.current?.clientHeight||300)))},t=()=>{Q(_.current?.clientWidth??0)},s=()=>{e(),t()};s(),new ResizeObserver(s).observe(_.current)},[_]);let et=(0,tS.S)({textareaRef:t,maxHeight:Y});(0,n.useEffect)(()=>{et()},[Y,N,et,J]);let es=(0,D.ry)(),ea=(0,f.md)(tT.Ng),en=(0,eg.k)();function er(){H(!0),K(!0);let e=Array.from(new Set([...q.map(e=>e.message)??[],...L.map(e=>e.event_message)]));l({message:O?(0,w.t)("figmake.chat.warning_fix_message"):(0,w.t)("living_designs.chat.errors.fix_these_errors"),errors:e}),A([])}let ei=(0,W.Oc)(),el=ei?ej.G_.FIGMAKE:ej.G_.SITES,ec=(0,eE.Xu)(),eo=(0,f.md)(eN.Xl),{connectedProject:ex,isConnectedNonOwner:eu}=(0,eO.GC)(),em=(0,eO.Iz)(),{showProvisionalAccessBanner:eh,onCloseProvisionalAccessBanner:ep}=function(e){let{getProvisionalAccessBanner:t}=(0,ev.wH)(),s=t(e),[a,r]=(0,n.useState)(!0);return{showProvisionalAccessBanner:s?.showBanner&&a,onCloseProvisionalAccessBanner:()=>{r(!1)}}}(el),{showChatSoftLimitBanner:ef,onCloseChatSoftLimitBanner:e_}=function(e){let t=(0,r.wA)(),s=(0,tC.f)(tw),a=(0,ek.No)(),n=a.unwrapOr(null)?.tier,{meterUsed:i}=(0,tE.xD)(e),l=(0,tb.Tf)();if(s&&function(e){let t=(0,tv.A)(new Date).tz("America/Los_Angeles");return(0,tv.A)(e).tz("America/Los_Angeles").isBefore(t,"month")}(s.updatedAt))t(tN.b({[tw]:!1}));else if(s)return{showChatSoftLimitBanner:!1};return n&&n!==ej.Ag.STARTER&&n!==ej.Ag.STUDENT?{showChatSoftLimitBanner:i>l[n],onCloseChatSoftLimitBanner:()=>{t(tN.b({[tw]:!0}))}}:{showChatSoftLimitBanner:!1}}(ei?eb.JT.FIGMAKE:eb.JT.LIVING_DESIGNS),ey=!m&&j>0,ew=(0,V.g7)(),ez=(q.length>0||ec&&L.length>0)&&!R,eT={type:"normal"};return es||ea?eT={type:"chatDisabled",showLoggedOutBanner:ei&&en}:ec&&eo&&(ex||eu)?eT={type:"supabaseNudge"}:ec&&em?eT={type:"supabaseError"}:z?eT={type:"chatError",chatError:z,onClose:T,onRetry:B?er:()=>l({})}:ez&&$?eT={type:"selfHealing",onClose:()=>P(!0)}:ez&&!m?eT={type:"consoleErrors",onClose:()=>P(!0),requestFixErrors:er,errorFixingDisabled:d,isLastUserMessageAutoErrorFix:!!k,errorCount:q.length+L.length,variant:O?"info":"error"}:Z&&Z.length>0?eT={type:"communityAttribution",communityAttributions:Z,onClose:ee}:(0,g.kc)().ai_ga&&!(0,g.kc)().disable_code_chat_soft_limit_banner&&(0,g.kc)().enable_code_chat_soft_limit_banner_for_plan&&ef?eT={type:"chatSoftLimit",onClose:e_}:(0,g.kc)().bake_monetization_plan&&ei&&eh?eT={type:"provisionalAccess",licenseType:el,onClose:ep}:ew&&m?eT={type:"mobileInProgress"}:ew&&ey&&(eT={type:"mobileComplete"}),(0,a.jsxs)(a.Fragment,{children:[(0,g.kc)().bake_agent_scratchpad&&(0,a.jsx)(tg,{}),(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),U&&(K(!1),l({}))},children:(0,a.jsxs)(tG,{children:[(0,a.jsx)(t2,{state:eT}),(0,a.jsx)(t3,{canCancelGeneration:p,canSend:U,chatBoxLeftExtraContent:c,chatBoxRightExtraContent:o??[],chatMessagesNodeGuid:h,featureType:v,generationInProgress:m,input:N,inspectedElement:x,isDraggingAttachment:y,onFocus:b,placeholderText:s,sendMessage:l,setInput:E,showPasteDesignsCallout:u,textareaRef:t,updateTextareaHeight:et})]})})]})});function t3({chatMessagesNodeGuid:e,generationInProgress:t,canSend:s,canCancelGeneration:r,sendMessage:l,input:c,setInput:o,updateTextareaHeight:x,inspectedElement:d,isDraggingAttachment:u,showPasteDesignsCallout:m,textareaRef:p,placeholderText:g,chatBoxLeftExtraContent:_,chatBoxRightExtraContent:k,onFocus:v,featureType:b}){let N=(0,W.Oc)(),E=(0,z.O1)(),T=b===i.lV.AI_ASSISTANT&&E&&!d,S=(0,f.md)(M.f3),A=(0,n.useCallback)(e=>{let t=e.target;x(),o(t.value)},[o,x]),[L,q]=(0,n.useState)(!1),I=(0,n.useRef)(null),[O,P]=(0,n.useState)(!1),U=(0,f.Xr)((0,eP.AK)(e)),G=(0,n.useRef)(null),$=(0,n.useCallback)(()=>{q(!0),P(!1),I.current&&(clearTimeout(I.current),I.current=null)},[]),H=(0,n.useCallback)(()=>{q(!1),P(!0),I.current&&clearTimeout(I.current),I.current=setTimeout(()=>{P(!1),I.current=null},30)},[]),B=(0,n.useCallback)(e=>{if(e.stopPropagation(),"Enter"===e.key&&!e.shiftKey){if(L||e.nativeEvent.isComposing||O)return;e.preventDefault(),s&&(U(!1),l({}),(d||S?.directManipulationEditor.directManipulationEnabled())&&S?.setDirectManipulationEnabled({enabled:!1}))}"Escape"===e.key&&G?.current?.value.trim()===""&&(0,R.UM)()},[G,s,l,d,S,L,O,U]),V=f.zl.get((0,F.Z3)(e)),K=(0,D.ry)(),{attachments:Y,clearAttachment:X}=(0,tj._9)(e),J=K?"var(--color-bg-secondary)":"var(--color-bg)";return(0,a.jsxs)("div",{...{0:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x1y0btm7 xmkeg23 x9h44rk x1ey2m1c x1753ylo x7z60cl x1j937ru xhfuivf xsag5q8 x1v2ro7d"},2:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x9h44rk x1ey2m1c x1753ylo xhfuivf xsag5q8 x1v2ro7d xdh2fpr x1y0btm7 x1va2ikv"},1:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x1y0btm7 xmkeg23 x9h44rk x1ey2m1c x1753ylo x7z60cl x1j937ru xsag5q8 x1v2ro7d x15ysqaf"},3:{className:"x1n2onr6 x78zum5 xdt5ytf x2lah0s x1iorvi4 xb3r6kr x9h44rk x1ey2m1c x1753ylo xsag5q8 x1v2ro7d xdh2fpr x1y0btm7 x1va2ikv x15ysqaf"}}[!!u<<1|!(b!==i.lV.CODE_IN_SITES)<<0],style:{backgroundColor:J},children:[(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1iyjqo2 xs83m0k x1r8uery",style:{backgroundColor:J},children:[m&&(0,a.jsx)(t6,{}),(0,a.jsx)(tJ,{attachments:Y,clearAttachment:X}),d?(0,a.jsx)(e6,{tagName:d.tagName,variant:"prompt"}):null,T?(0,a.jsx)(e4,{nodes:E,variant:"prompt"}):null,(0,a.jsx)("textarea",{ref:function(e){G.current=e,"function"==typeof p?p(e):p&&(p.current=e)},className:"x78zum5 x1iyjqo2 xtt52l0 x8nclml xnm25rq xyfqnmn xz9dl7a xsag5q8 x1ed109x x8yk33q","data-testid":"code-chat-chat-box",disabled:K,maxLength:5e5,onChange:A,onCompositionEnd:H,onCompositionStart:$,onFocus:e=>{let t=e.target.value.length;e.target.setSelectionRange(t,t),v?.(e)},onKeyDown:B,onPaste:function(e){if(N)try{let t=(e.clipboardData||window.clipboardData).getData("Text");(function(e){let t=e.match(/(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:\/~+#-]*[\w@?^=%&\/~+#-])/g);return!!(t&&[...t].findIndex(e=>(function(e){if((0,C.gU)(e)){let t=new URL(e);if((0,tU.F4)(t.hostname))return!0}return!1})(e))>-1)})(t)&&(0,tj.hH)(h.FDn.USER_PASTED_FIGMA_LINK_IN_CHAT)}catch{}},placeholder:g,style:{backgroundColor:J,height:"auto",overflowY:"hidden"},value:c})]}),(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xt970qd xaope02",children:[_,(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0},children:[k,(0,a.jsx)("div",{style:{flexShrink:0},children:(()=>{let e=(0,eo.A)(.19,1,.22,1);return(0,a.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k x11umrmk",children:(0,a.jsxs)(j.P.button,{type:"button",onClick:()=>{t?V&&V.abort():(U(!1),l({}),(d||S?.directManipulationEditor.directManipulationEnabled())&&S?.setDirectManipulationEnabled({enabled:!1}))},disabled:t?!r:!s,...{0:{className:"x1xwekrv xlrawln x10db7i2 xlqzeqv x6s0dn4 x78zum5 x2lah0s"},4:{className:"x78zum5 xlrawln xexx8yu xy13l1i x18d9i69 x6wrskw x6s0dn4 xsqpjig x1xwekrv x195vfkc"},2:{className:"x1xwekrv xlrawln x10db7i2 xlqzeqv x6s0dn4 x78zum5 x2lah0s xu5wzci"},6:{className:"x78zum5 xlrawln xexx8yu xy13l1i x18d9i69 x6wrskw x6s0dn4 xsqpjig x1xwekrv x195vfkc xu5wzci"},1:{className:"x1xwekrv xlrawln x10db7i2 xlqzeqv x6s0dn4 x78zum5 x2lah0s xgbcquw"},5:{className:"x78zum5 xlrawln xexx8yu xy13l1i x18d9i69 x6wrskw x6s0dn4 xsqpjig x1xwekrv x195vfkc xgbcquw"},3:{className:"x1xwekrv xlrawln x10db7i2 xlqzeqv x6s0dn4 x78zum5 x2lah0s xgbcquw"},7:{className:"x78zum5 xlrawln xexx8yu xy13l1i x18d9i69 x6wrskw x6s0dn4 xsqpjig x1xwekrv x195vfkc xgbcquw"}}[!!t<<2|!!(!t&&s)<<1|!!(!t&&!s)<<0],variants:{play:{width:"25px",transition:{duration:.3,ease:e}},stop:{width:"63px",transition:{duration:.3,ease:e}}},initial:"play",animate:t?"stop":"play","aria-label":t?(0,w.t)("living_designs.chat.stop_button.alt_text"):(0,w.t)("living_designs.chat.send_button.alt_text"),"data-testid":t?"code-chat-stop-button":"code-chat-send-button",children:[(0,a.jsx)(j.P.div,{className:"x1n2onr6 x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11",variants:{play:{x:0,transition:{duration:.3,ease:e}},stop:{x:0,transition:{duration:.3,ease:e}}},animate:t?"stop":"play",children:(0,a.jsx)(y.N,{mode:"wait",children:t?(0,a.jsx)(j.P.div,{className:"absolute",animate:{opacity:1,scale:1,rotate:0},exit:{opacity:0,scale:0,rotate:-45},initial:{opacity:0,scale:0,rotate:100},transition:{duration:.3,ease:e},children:(0,a.jsx)(el.d,{className:"xwa2v1s xvy4d1p xxk0z11 x2lah0s"})},"square"):(0,a.jsx)(j.P.div,{className:"absolute",animate:{opacity:1,scale:1,rotate:0},exit:{opacity:0,scale:0,rotate:45},initial:{opacity:0,scale:0,rotate:-45},transition:{duration:.25,ease:e},children:(0,a.jsx)(ei.W,{className:"xwa2v1s xvy4d1p xxk0z11 x2lah0s"})},"arrow")})}),(0,a.jsx)(y.N,{children:t&&(0,a.jsx)(j.P.span,{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xb3r6kr xuxw1ft x1tk3asg x1j61x8r",initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{opacity:{duration:.25,ease:e},width:{duration:.25,ease:e}},children:(0,w.t)("living_designs.chat.stop_button")})})]})})})()})]})]})]})}function t6(){return(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1nejdyq x1ruevkc xmkeg23 xbsl7fq xaqgqki xw7yly9 x1o6q14k xat24cr xq1n1xh x1sxf85j",children:[(0,a.jsx)(t8,{}),(0,a.jsx)("div",{className:"x1nmd3yn xm735u9 xkbmbem xqp8s7e xv1l7n4 xvwc6ox x1j61x8r",children:(0,w.t)("figmake.chat.paste_existing_design_callout")})]})}function t8(){return(0,a.jsxs)("svg",{width:"22",height:"27",viewBox:"0 0 22 27",children:[(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.3438 5.59766H18.8389V20.5352H16.2041V22.7998H5.85938V20.3682H3.1377V5.79492H5.7168V3.06641H16.3438V5.59766ZM7.83398 9.25586C7.691 9.24173 7.55088 9.29393 7.44922 9.39551L7.39355 9.45117C7.29203 9.55285 7.23973 9.69297 7.25391 9.83594C7.34716 10.7618 7.7613 14.2858 8.74023 15.2656C9.40363 15.9289 10.4407 16.2157 11.4219 16.1045L12.167 16.8545C12.5491 17.2397 13.171 17.241 13.5547 16.8574L14.834 15.5781C15.2154 15.1967 15.2167 14.5783 14.8369 14.1953L14.0986 13.4512C14.2185 12.4619 13.9322 11.4128 13.2627 10.7432C12.283 9.76425 8.76013 9.34913 7.83398 9.25586Z",fill:ec.Tj.bgSelected}),(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.2261 0.0282208C5.71996 0.0785065 6.10527 0.495932 6.10527 1.00306V2.22185H15.9015V1.00306C15.9015 0.495932 16.2868 0.0785065 16.7807 0.0282208L16.8811 0.0234375H20.7996L20.9001 0.0282208C21.3939 0.0785065 21.7792 0.495932 21.7792 1.00306V4.92155L21.7745 5.022C21.7275 5.48284 21.3609 5.84947 20.9001 5.89639L20.7996 5.90117H19.8238V20.1057H20.7996L20.9001 20.1105C21.3939 20.1608 21.7792 20.5782 21.7792 21.0853V25.0038L21.7745 25.1043C21.7275 25.5651 21.3609 25.9317 20.9001 25.9787L20.7996 25.9834H16.8811L16.7807 25.9787C16.3198 25.9317 15.9532 25.5651 15.9063 25.1043L15.9015 25.0038V23.7869H6.10527V25.0038L6.10049 25.1043C6.05357 25.5651 5.68694 25.9317 5.2261 25.9787L5.12565 25.9834H1.20716L1.10671 25.9787C0.645871 25.9317 0.279246 25.5651 0.232322 25.1043L0.227539 25.0038V21.0853C0.227539 20.5782 0.612855 20.1608 1.10671 20.1105L1.20716 20.1057H2.19444V5.90117H1.20716L1.10671 5.89639C0.645871 5.84947 0.279246 5.48284 0.232322 5.022L0.227539 4.92155V1.00306C0.227539 0.495932 0.612855 0.0785065 1.10671 0.0282208L1.20716 0.0234375H5.12565L5.2261 0.0282208ZM1.20716 25.0038H5.12565V21.0853H1.20716V25.0038ZM16.8811 25.0038H20.7996V21.0853H16.8811V25.0038ZM6.10527 3.20147V4.92155L6.10049 5.022C6.05357 5.48284 5.68694 5.84947 5.2261 5.89639L5.12565 5.90117H3.17406V20.1057H5.12565L5.2261 20.1105C5.71996 20.1608 6.10527 20.5782 6.10527 21.0853V22.8073H15.9015V21.0853C15.9015 20.5782 16.2868 20.1608 16.7807 20.1105L16.8811 20.1057H18.8442V5.90117H16.8811L16.7807 5.89639C16.3198 5.84947 15.9532 5.48284 15.9063 5.022L15.9015 4.92155V3.20147H6.10527ZM1.20716 4.92155H5.12565V1.00306H1.20716V4.92155ZM16.8811 4.92155H20.7996V1.00306H16.8811V4.92155Z",fill:ec.Tj.iconBrand}),(0,a.jsx)("path",{d:"M7.39116 8.45953C7.62267 8.28138 7.92476 8.21392 8.21343 8.28179L12.0259 9.17828V9.17926L12.2076 9.22613C13.9005 9.71089 15.0432 11.2703 15.0259 13.0045L15.4644 13.4429C15.8466 13.8255 15.8467 14.4452 15.4644 14.8277L12.8267 17.4654C12.4442 17.8478 11.8245 17.8476 11.4419 17.4654L11.0035 17.0269C9.26918 17.0443 7.70984 15.9015 7.22514 14.2086L7.17827 14.0269H7.17729L6.28081 10.2144C6.20316 9.88421 6.30267 9.53728 6.54253 9.29742L7.29643 8.54351L7.39116 8.45953ZM7.95952 9.26519L10.1744 11.481C10.4208 11.3465 10.703 11.2691 11.0035 11.2691L11.1802 11.2779C12.0543 11.3666 12.7369 12.105 12.7369 13.0025C12.7367 13.9595 11.9605 14.7357 11.0035 14.7359C10.106 14.7358 9.36756 14.0533 9.27885 13.1793L9.27007 13.0025L9.27885 12.8248C9.30267 12.5907 9.37346 12.3705 9.481 12.1734L7.26616 9.95855L7.23491 9.9898L8.13139 13.8023C8.4771 15.2707 9.88699 16.2325 11.3804 16.0191L12.1343 16.773L14.772 14.1353L14.0181 13.3814C14.2314 11.888 13.2696 10.4781 11.8013 10.1324L7.98882 9.2359L7.95952 9.26519ZM11.0035 12.2486C10.5873 12.2487 10.2496 12.5863 10.2496 13.0025C10.2497 13.3926 10.5464 13.7139 10.9263 13.7525L11.0035 13.7564C11.3934 13.7562 11.7147 13.4594 11.7535 13.0796L11.7574 13.0025C11.7574 12.5863 11.4196 12.2488 11.0035 12.2486Z",fill:ec.Tj.iconBrand})]})}var t4=s(572427),t9=s(578420);function se({showAiBetaBadge:e}){return(0,a.jsx)("div",{className:"xh8yej3 x78zum5 x87ps6o",children:(0,a.jsx)(t4.Wv,{titleTx:(0,w.tx)("living_designs.chat.default_title"),children:e?(0,a.jsx)(t9.y,{helpUrlVariant:eb.JT.CODE_CHAT}):null})})}var st=s(78439),ss=s(824136),sa=s(851824),sn=s(72138),sr=s(592726),si=s(24441),sl=s(378979);let sc={messageContent:{k1xSpc:"x78zum5",kaIpWk:"xgqmno8",k8WAf4:"x1m7iz9m",kg3NbH:"xaope02",kWkggS:"x1v8gsql",kfSwDN:"x1hx0egp",khDVqt:"x126k92a",kTgw9:"x13faqbe",kkrTdU:"x1ed109x",$$css:!0}};function so({user:e,featureType:t,plainText:s,imports:r=[],inspectedElement:l,selectedNodeIds:c}){let{userMessageTypographyStyle:o}=(0,si.L)(),x=s.trim(),d=t===i.lV.AI_ASSISTANT&&c&&c.length>0&&!l,u=(0,S.eY)(),m=(0,n.useMemo)(()=>c&&Array.isArray(c)?c.map(e=>(0,z.Zl)(u,e)).filter(e=>null!==e):[],[c,u]),h=(0,sl.N)(),p=e=>{h(e)};return(0,a.jsx)("div",{role:"region","aria-label":(0,w.t)("figmake.chat.artifact.a11y_prompt_section_title",{user:e.name??e.handle}),className:"x1eaahee",children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x167g77z x13a6bvl",children:[(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x167g77z xuk3077",children:[l&&l.tagName?(0,a.jsx)(e6,{variant:"chat",tagName:l.tagName}):null,d?(0,a.jsx)(e4,{nodes:m,variant:"chat"}):null,r.length>0?(0,a.jsx)("div",{className:"x78zum5 x1q0g3np x167g77z x1a02dak x13a6bvl",children:r.map(e=>(0,a.jsx)(tP.s,{pastedDesignNodeId:e.guid,onClick:()=>p(e.guid),attachmentType:(0,tj.yM)(e)},e.guid))}):null,(0,a.jsx)("div",{..._.Ay.props(sc.messageContent,o),children:x})]}),(0,a.jsx)("div",{className:"xpvyfi4 x1ty9z65",children:(0,a.jsx)(eS.H8,{"aria-label":e.name??e.handle,user:e})})]})})}var sx=s(286138),sd=s(689161),su=s(384658),sm=s(956492),sh=s(98861),sp=s(320802),sg=s(549936),sf=s(11165);function s_(e){let t=(0,z.uQ)(),s=(0,z.NM)(),n=(0,S.eY)(),r=!!t||!!(s&&s.length>0),i=t?(0,z.Zl)(n,t):null;return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1nfngrj",children:[(0,a.jsx)("div",{className:"x1ed109x x1hx0egp xrlp15q x1nmd3yn xm735u9 x37zpob x3wk4up x1akne3o",children:e.message}),(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x1nfngrj xvxsjr2 xjbqb8w xmkeg23 x1y0btm7 x7z60cl x1mxnbhz x7hzu26",children:[(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x1nfngrj x98rzlu",children:[r?i&&i.type?e7(i.type):e7("FRAME"):(0,a.jsx)(sf.y,{}),(0,a.jsx)("div",{className:"xrlp15q x1nmd3yn x1s688f xkbmbem x3wk4up x98rzlu x1quhyk7",children:r?s&&s.length>1?(0,w.t)("ai_assistant.selected_layers_count",{count:s.length}):i?.name||(0,w.t)("ai_assistant.selected_layer"):(0,w.t)("ai_assistant.no_layers_selected")})]}),(0,a.jsx)("div",{className:"x2lah0s",children:r&&(0,a.jsx)(ee.$n,{variant:"primary",onClick:()=>{let a=t?[t]:s||[];e.onContinue(a)},children:(0,w.t)("ai_assistant.continue")})})]})]})}var sy=s(521182),sj=s(178623),sk=(e=>(e.PENDING="pending",e.SUCCESS="success",e.FAILURE="failure",e))(sk||{}),sv=(e=>(e.TOOL_CALL_SUCCESS="tool_call_success",e.TOOL_CALL_CANCELLED="tool_call_cancelled",e.TOOL_CALL_DISABLED="tool_call_disabled",e.TOOL_CALL_PENDING="tool_call_pending",e))(sv||{}),sb=s(873657);function sN({header:e,body:t}){return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf xkh2ocl",children:[(0,a.jsx)("div",{className:"x78zum5 xkh2ocl x1y1aw1k xyfqnmn xwib8y2 x163pfp",children:e}),t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eI.cG,{}),(0,a.jsx)("div",{className:"x78zum5 xkh2ocl x1y1aw1k xyfqnmn xwib8y2 x163pfp",children:t})]})]})}function sC({serverToolName:e,disabledStatus:t}){return(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x1i71x30 xh8yej3",children:(0,a.jsx)("div",{...{0:{className:"x4oah1p xewu7z0 x2ua9qx x1dnis8n xawads1 x1n0bwc9 xh8yej3"},2:{className:"x4oah1p xewu7z0 x2ua9qx x1dnis8n xawads1 xh8yej3 x172n1ly"},1:{className:"x4oah1p xewu7z0 x2ua9qx x1dnis8n xawads1 xh8yej3 xq6u9c4"},3:{className:"x4oah1p xewu7z0 x2ua9qx x1dnis8n xawads1 xh8yej3 xq6u9c4"}}[!(t!==sv.TOOL_CALL_CANCELLED)<<1|!(t!==sv.TOOL_CALL_SUCCESS)<<0],children:(()=>{let s=e||"Tool";switch(t){case sv.TOOL_CALL_SUCCESS:return(0,w.t)("figmake.mcp_tool.cta.success",{tool_name:s});case sv.TOOL_CALL_DISABLED:return(0,w.t)("figmake.mcp_tool.cta.disabled",{tool_name:s});case sv.TOOL_CALL_PENDING:return(0,w.t)("figmake.mcp_tool.cta.pending",{tool_name:s});case sv.TOOL_CALL_CANCELLED:default:return(0,w.t)("figmake.mcp_tool.cta.cancelled",{tool_name:s})}})()})})}function sE({onConfirm:e,onDismiss:t,toolArgs:s,isLoading:n=!1}){return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1i71x30 xh8yej3",children:[s&&Object.keys(s).length>0&&(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1nfngrj",children:[(0,a.jsx)("div",{className:"x4oah1p xewu7z0 x117nqv4 x1dnis8n xawads1 x1n0bwc9",children:(0,w.t)("figmake.mcp_tool.cta.tool_arguments")}),(0,a.jsx)("div",{className:"x1ey7xld xewu7z0 x2ua9qx x1dnis8n xawads1 x1v8gsql xi4r6k5 x19y5rnk xmkeg23 x1y0btm7 x7z60cl x126k92a xysyzu8 x1hkcv85",children:JSON.stringify(s,null,2)})]}),(0,a.jsxs)("div",{className:"x78zum5 x1nfngrj x13a6bvl xh8yej3",children:[(0,a.jsx)(ee.$n,{variant:"secondary",onClick:t,disabled:n,children:(0,w.t)("figmake.mcp_tool.cta.cancel")}),(0,a.jsx)(ee.$n,{variant:"primary",onClick:e,disabled:n,children:n?(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x1nfngrj",children:[(0,a.jsx)(Z.k,{size:"sm"}),(0,a.jsx)("span",{children:(0,w.t)("figmake.mcp_tool.cta.working")})]}):(0,w.t)("figmake.mcp_tool.cta.run_tool")})]})]})}var sw=s(826160),sz=s(25080);function sT({serverName:e,toolName:t}){return(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x1nfngrj",children:[(0,a.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11",children:(0,a.jsx)(sw.h3,{shape:"ROUNDED_SQUARE",size:24,imgUrl:"",className:null,children:(0,a.jsx)(sw.pw,{size:24,fontSize:12,color:(0,sz.$L)(e,sz.us),enabled:!0,shape:"ROUNDED_SQUARE",children:e.charAt(0).toUpperCase()})})}),(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x195vfkc",children:[(0,a.jsx)("div",{className:"x4oah1p xewu7z0 x117nqv4 x1dnis8n xawads1",children:e}),(0,a.jsx)("div",{className:"x4oah1p xewu7z0 x2ua9qx x1dnis8n xawads1",children:t})]})]})}function sS({toolCallId:e,toolName:t,toolArgs:s,onConfirm:r,onDismiss:i,disabledStatus:l,autoRun:c,isLoading:o=!1}){let{serverName:x,serverToolName:d}=(0,sy.Tr)(t),u=n.useRef(!1),m=n.useCallback(async()=>{try{await r()}catch(e){console.error("Error executing MCP tool",e)}},[r]);return n.useEffect(()=>{!c||l||u.current||(u.current=!0,m())},[c,l,m]),(0,a.jsx)(sN,{header:(0,a.jsx)(sT,{serverName:x,toolName:d}),body:l?(0,a.jsx)(sC,{serverToolName:d,disabledStatus:l}):(0,a.jsx)(sE,{onConfirm:m,onDismiss:i,toolArgs:s,isLoading:o})},e)}var sA=s(681283),sL=s(354114),sq=s(210226),sI=s(423128);function sO({todo:e,index:t,onReorder:s,onEdit:r,onToggleEdit:i,onDelete:l,isReadOnly:c=!1}){let[x,d]=n.useState(e.text),[u,m]=n.useState(!1),[h,p]=n.useState(!1),g=n.useRef(null),f=()=>{let t=x.trim();t&&t!==e.text&&r(e.id,t),i(e.id)};return n.useEffect(()=>{if(e.isEditing&&g.current){d(e.text),g.current.textContent=e.text,g.current.focus();let t=document.createRange(),s=window.getSelection();t.selectNodeContents(g.current),t.collapse(!1),s?.removeAllRanges(),s?.addRange(t)}},[e.isEditing,e.text]),(0,a.jsxs)("div",{...{0:{className:"x78zum5 x1n2onr6 x1q0g3np xl56j7k xkh2ocl x1cy8zhl x1nfngrj x1mh6rdz x1r3d5kz xjbqb8w xv2f06h x1ypdohk x19y5rnk"},2:{className:"x78zum5 x1n2onr6 x1q0g3np xl56j7k xkh2ocl x1cy8zhl x1nfngrj x1mh6rdz xjbqb8w xv2f06h x1ypdohk x19y5rnk x1ghz6dp"},1:{className:"x78zum5 x1n2onr6 x1q0g3np xl56j7k xkh2ocl x1cy8zhl x1nfngrj x1mh6rdz x1r3d5kz xjbqb8w xv2f06h x1ypdohk x19y5rnk xbyyjgo x1nhozj7"},3:{className:"x78zum5 x1n2onr6 x1q0g3np xl56j7k xkh2ocl x1cy8zhl x1nfngrj x1mh6rdz xjbqb8w xv2f06h x1ypdohk x19y5rnk x1ghz6dp xbyyjgo x1nhozj7"}}[!!c<<1|!!h<<0],onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),draggable:!e.isEditing&&!c,onDragStart:e=>{p(!0),e.dataTransfer.setData("text/plain",t.toString()),e.dataTransfer.effectAllowed="move"},onDragEnd:()=>{p(!1)},onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},onDrop:e=>{e.preventDefault();let a=parseInt(e.dataTransfer.getData("text/plain"),10);a!==t&&s(a,t)},children:[!c&&(0,a.jsx)("div",{className:"x78zum5 x6s0dn4 xqcrz7y xl56j7k x52n8ys x1blxet0 x1jm3nie xch2mbi",children:(0,a.jsx)(sq.m,{})}),(0,a.jsx)("div",{className:"x98rzlu x78zum5 x1cy8zhl xeuugli",children:e.isEditing?(0,n.createElement)("div",{ref:g,contentEditable:!0,suppressContentEditableWarning:!0,className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l x98rzlu x18s2yiw xeuugli x1nn3v0j x1akne3o x1a2a7pz x126k92a x13faqbe x1mzt3pk xh8yej3 xl0cjzi",onInput:e=>d(e.currentTarget.textContent||""),onKeyDown:t=>{"Enter"===t.key?(t.preventDefault(),f()):"Escape"===t.key&&(d(e.text),i(e.id))},onBlur:f,role:"textbox",tabIndex:0,key:`${e.id}-editing`}):(0,n.createElement)("div",{className:"x98rzlu x1ed109x xeuugli xb3r6kr x1nn3v0j",onClick:c?void 0:()=>i(e.id),style:{cursor:c?"default":"text"},key:`${e.id}-non-editing`},(0,a.jsx)("span",{className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l x1akne3o x13faqbe x126k92a x1mzt3pk x1lliihq xh8yej3 xamitd3",children:e.text}))}),!e.isEditing&&!c&&(0,a.jsx)("div",{...{0:{className:"xg01cxk xzdg38j xqcrz7y x10l6tqk x1473dw x1bfpjnn x1useyqa x78zum5 x13a6bvl x10pwc4n"},1:{className:"xzdg38j xqcrz7y x10l6tqk x1473dw x1bfpjnn x1useyqa x78zum5 x13a6bvl x10pwc4n x1hc1fzr"}}[!!u<<0],children:(0,a.jsx)(o.K,{variant:"ghost",size:"md",onClick:()=>l(e.id),"aria-label":(0,w.t)("figmake.chat.delete_todo_button"),children:(0,a.jsx)(sI.A,{})})})]})}function sM({onAccept:e,todos:t,toolCallId:s,toolResult:r,getScratchpadFileNode:i}){let l=(0,f.Xr)(th),c=(0,f.md)(tu(s));n.useEffect(()=>{r?.result?.data&&l(s)},[r?.result?.data,l,s]);let o=n.useMemo(()=>{let e;try{r?.result?.data&&"Was not successful."!==r.result.message&&(e=JSON.parse(r.result.data).todos)}catch(e){console.warn("Error parsing toolResult.result.message:",e)}return e},[r?.result?.data,r?.result?.message]),[x,d]=n.useState(!c),u=(0,f.Xr)(tp),[m,h]=n.useState(t);n.useEffect(()=>{d(e=>(!e||!c)&&e)},[c]);let g=o&&o.length>0?o:t,[_,k]=n.useState(()=>g.map((e,t)=>({id:`todo-${t}-${Date.now()}`,text:e,isEditing:!1})));n.useEffect(()=>{(t.length!==m.length||t.some((e,t)=>e!==m[t]))&&(k(t.map((e,t)=>({id:`todo-${t}-${Date.now()}`,text:e,isEditing:!1}))),h(t))},[t,m]);let v=n.useCallback(e=>{!function(e,t){let s=t();if(!s){console.error("Scratchpad file not found");return}p.Hq.system("scratchpad-inline-edit",()=>{let t=e.map(e=>`- [ ] ${e.text}`).join("\n"),a=s.sourceCode,n=function(e){let t=e.indexOf("# TODOs");if(-1===t)return null;let s=e.length,a=e.substring(t+1),n=/\n#+\s/.exec(a);return n&&void 0!==n.index&&(s=t+1+n.index),{section:e.substring(t,s),startIndex:t,endIndex:s}}(a);if(n){let e=a.substring(0,n.startIndex),r=a.substring(n.endIndex);s.sourceCode=e+`# TODOs

${t}

`+r}else s.sourceCode=a+`

# TODOs

${t}`;sL.Y5.commit()})}(e,i)},[i]),b=(e,t)=>{let s=[..._],a=s[e];a&&(s.splice(e,1),s.splice(t,0,a),k(s),v(s))},N=(e,t)=>{let s=_.map(s=>s.id===e?{...s,text:t}:s);k(s),v(s)},C=e=>{k(t=>t.map(t=>t.id===e?{...t,isEditing:!t.isEditing}:t))},E=e=>{let t=_.filter(t=>t.id!==e);k(t),v(t)},z=n.useCallback(()=>{v(_);let t=_.map(e=>e.text);d(!1),l(s),e(t),u("open")},[_,e,v,u,l,s]);if(0===_.length)return null;let T=(0,a.jsx)(a.Fragment,{children:_.map((e,t)=>(0,a.jsx)(sO,{todo:e,index:t,onReorder:b,onEdit:c?()=>{}:N,onToggleEdit:c?()=>{}:C,onDelete:c?()=>{}:E,isReadOnly:c},e.id))});return(0,a.jsx)(sN,{header:(0,a.jsx)(sF,{}),body:(0,a.jsx)("div",{className:"x78zum5 xdt5ytf xg2d0mh xkh2ocl xh8yej3",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(et.E,{className:"x78zum5 x6s0dn4 x1qughib xolm8sj x1yjdb4r x1ypdohk",onClick:()=>d(e=>!e),children:[(0,a.jsx)("span",{className:"xrlp15q x1nmd3yn xk50ysn xkbmbem x3wk4up x1n0bwc9",children:(0,w.tx)("figmake.chat.todos.header",{count:_.length})}),(0,a.jsx)("span",{className:"x4oah1p xewu7z0 x2ua9qx x1dnis8n xawads1 x1a6v3hu",children:x?(0,a.jsx)(tr.t,{}):(0,a.jsx)(tn.O,{})})]}),(0,a.jsx)(y.N,{children:x&&(0,a.jsx)(j.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3,ease:"easeInOut"},className:"x78zum5 xdt5ytf xg2d0mh xkh2ocl",children:T})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3,ease:"easeInOut"},className:"x78zum5 xdt5ytf xg2d0mh xkh2ocl",children:T}),(0,a.jsx)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1nfngrj xkh2ocl x7hzu26 x145f3qc",children:(0,a.jsx)(ee.WW,{variant:"primary",onClick:z,children:(0,w.t)("figmake.scratchpad.start_tasks_button")})})]})})})}function sF(){return(0,a.jsx)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1qughib xh8yej3 x1excjyp",children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1nfngrj",children:[(0,a.jsx)("div",{className:"x78zum5 xl56j7k x6s0dn4",children:(0,a.jsx)(sA.$,{})}),(0,a.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:(0,w.t)("figmake.scratchpad.header_title")})]})})}var sD=s(652539),sR=s(10074),sP=s(996715),sU=s(24034),sG=s(443723);function s$({text:e}){return(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z xkh2ocl",children:[(0,a.jsx)("div",{className:"xvvfnsg",children:(0,a.jsx)(sU.r,{})}),(0,a.jsx)("div",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:e})]})}function sH({title:e,subtitle:t,interaction:s}){return(0,a.jsx)(sW,{icon:(0,a.jsx)(Z.k,{size:"md"}),title:e,subtitle:t,interaction:s})}function sB({title:e,subtitle:t,interaction:s}){return(0,a.jsx)(sW,{icon:(0,a.jsx)(sG.w,{}),title:e,subtitle:t,interaction:s})}function sV({title:e,subtitle:t,interaction:s}){return(0,a.jsx)(sW,{icon:(0,a.jsx)("div",{className:"x15edyk6",children:(0,a.jsx)(en.Z,{})}),title:e,subtitle:t,interaction:s})}function sW({icon:e,title:t,subtitle:s,interaction:n}){return(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x167g77z xwib8y2 xkh2ocl",children:[(0,a.jsx)("div",{className:"x78zum5 x1cy8zhl xkh2ocl",children:e}),(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1cy8zhl x167g77z xkh2ocl",children:[(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1cy8zhl xdpxx8g",children:[(0,a.jsx)("div",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:t}),(0,a.jsx)("div",{className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l x1n0bwc9",children:s})]}),n]})]})}function sK({dismissSupabase:e,trackingContext:t}){let s=(0,eO.wT)(),r=(0,A.tS)()||"",i=n.useCallback(()=>{(0,O.oU)({persistentEntityId:t.persistentEntityId,clientLifecycleId:t.clientLifecycleId},"toolCta",r),s()},[s,t.persistentEntityId,t.clientLifecycleId,r]),l=(0,V.g7)();return(0,a.jsx)(sB,{title:(0,w.t)("figmake.supabase.cta.list.account_connected"),subtitle:(0,w.t)("figmake.supabase.cta.auth.body_text"),interaction:(0,a.jsxs)("div",{className:"x78zum5 x167g77z",children:[(0,a.jsx)(ee.WW,{variant:l?"secondary":"primary",onClick:i,children:(0,w.t)("figmake.supabase.connect")}),(0,a.jsx)(ee.WW,{variant:"secondary",onClick:()=>e(),children:(0,w.t)("figmake.supabase.cancel")})]})})}var sY=s(847714);function sX({toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:n}){let{organization:i}=(0,eO.mS)(),l=(0,r.wA)();return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x167g77z xkh2ocl",children:[(0,a.jsx)(s$,{text:(0,w.t)("figmake.supabase.cta.list.account_connected")}),(0,a.jsx)(s$,{text:(0,w.t)("figmake.supabase.cta.list.org_connected",{org:i?.name??""})}),(0,a.jsx)(sB,{title:(0,w.t)("figmake.supabase.cta.connect_to_existing_projects.title"),subtitle:(0,w.t)("figmake.supabase.cta.connect_to_existing_projects.subtitle"),interaction:(0,a.jsxs)("div",{className:"x78zum5 x167g77z",children:[(0,a.jsx)(ee.WW,{variant:"primary",onClick:()=>{l((0,T.to)({type:sY.Z,data:{toolCallId:e,toolName:t,trackingContext:n,source:"toolCta"},showModalsBeneath:!0}))},children:(0,w.t)("figmake.supabase.cta.connect_to_existing_projects.button")}),(0,a.jsx)(ee.WW,{variant:"secondary",onClick:()=>s(),children:(0,w.t)("figmake.supabase.cancel")})]})})]})}function sJ(){let{organization:e}=(0,eO.mS)(),{connectedProject:t}=(0,eO.GC)(),s=t?.name??"";return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x167g77z xkh2ocl",children:[(0,a.jsx)(s$,{text:(0,w.t)("figmake.supabase.cta.list.account_connected")}),(0,a.jsx)(s$,{text:(0,w.t)("figmake.supabase.cta.list.org_connected",{org:e?.name??""})}),(0,a.jsx)(s$,{text:(0,w.t)("figmake.supabase.cta.list.project_connected",{project:s})})]})}function sQ(){let{organization:e}=(0,eO.mS)(),t=(0,f.md)(sP.Kj);if(!t||"connecting"!==t.state)return null;let s=t.project.name??"";return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x167g77z xkh2ocl",children:[(0,a.jsx)(s$,{text:(0,w.t)("figmake.supabase.cta.list.account_connected")}),(0,a.jsx)(s$,{text:(0,w.t)("figmake.supabase.cta.list.org_connected",{org:e?.name??""})}),(0,a.jsx)(sH,{title:(0,w.t)("figmake.supabase.cta.list.project_connecting",{project:s}),subtitle:(0,w.t)("figmake.supabase.cta.list.project_connecting.subtitle")})]})}var sZ=s(972700);function s0({toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:n}){let{organization:i}=(0,eO.mS)(),l=(0,r.wA)();return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x167g77z xkh2ocl",children:[(0,a.jsx)(s$,{text:(0,w.t)("figmake.supabase.cta.list.account_connected")}),(0,a.jsx)(s$,{text:(0,w.t)("figmake.supabase.cta.list.org_connected",{org:i?.name??""})}),(0,a.jsx)(sB,{title:(0,w.t)("figmake.supabase.cta.create_project.title"),subtitle:(0,w.t)("figmake.supabase.cta.create_project.subtitle"),interaction:(0,a.jsxs)("div",{className:"x78zum5 x167g77z",children:[(0,a.jsx)(ee.WW,{variant:"primary",onClick:()=>{l((0,T.to)({type:sZ.AP,data:{toolCallId:e,toolName:t,trackingContext:n,source:"toolCta"},showModalsBeneath:!0}))},children:(0,w.t)("figmake.supabase.cta.create_project.button")}),(0,a.jsx)(ee.WW,{variant:"secondary",onClick:()=>s(),children:(0,w.t)("figmake.supabase.cancel")})]})})]})}function s1(){return(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x167g77z xkh2ocl xl56j7k x6s0dn4 x1tamke2 xh8yej3",children:(0,a.jsx)(Z.k,{})})}function s5({toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:r}){let{authenticated:i,connectedProject:l,existingProjects:c,isLoading:o}=(0,eO.zA)(),x=(0,f.Xr)(eN.hR),d=(0,f.md)(sP.Kj);return(0,n.useEffect)(()=>{if(o){x(eN.s8.LOADING);return}if(d&&"connecting"===d.state){x(eN.s8.CONNECTING_TO_PROJECT);return}l?x(eN.s8.CONNECTED_PROJECT):i&&c.length?x(eN.s8.CONNECT_TO_EXISTING_PROJECTS):i?x(eN.s8.CREATE_PROJECT):x(eN.s8.AUTH)},[o,l,c,i,x,d]),(0,a.jsx)(s2,{toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:r})}function s2({toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:r}){let i=(0,f.md)(eN.hR),l=(0,A.tS)()||"",c=n.useRef(!1);switch(n.useEffect(()=>{if(c.current)return;let e=(0,O.oR)({persistentEntityId:r.persistentEntityId,clientLifecycleId:r.clientLifecycleId},"toolCta",i,l);c.current=e},[i,r.persistentEntityId,r.clientLifecycleId,l]),i){case eN.s8.AUTH:return(0,a.jsx)(sK,{dismissSupabase:s,trackingContext:r});case eN.s8.CONNECTING_TO_PROJECT:return(0,a.jsx)(sQ,{});case eN.s8.CONNECT_TO_EXISTING_PROJECTS:return(0,a.jsx)(sX,{toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:r});case eN.s8.CREATE_PROJECT:return(0,a.jsx)(s0,{toolCallId:e,toolName:t,dismissSupabase:s,trackingContext:r});case eN.s8.CONNECTED_PROJECT:return(0,a.jsx)(sJ,{});case eN.s8.LOADING:return(0,a.jsx)(s1,{})}}var s7=s(114344);function s3({toolCallId:e,toolName:t,disabledStatus:s,dismissSupabase:n,trackingContext:r}){return s?(0,a.jsx)(sN,{header:(0,a.jsx)(s6,{disabledStatus:s})}):(0,a.jsx)(sN,{header:(0,a.jsx)(s8,{}),body:(0,a.jsx)(s5,{toolCallId:e,toolName:t,dismissSupabase:n,trackingContext:r})})}function s6({disabledStatus:e}){let t=n.useMemo(()=>{switch(e){case sv.TOOL_CALL_SUCCESS:return(0,w.t)("figmake.supabase.cta.collapsed.success");case sv.TOOL_CALL_DISABLED:return(0,w.t)("figmake.supabase.cta.collapsed.disabled");case sv.TOOL_CALL_CANCELLED:default:return(0,w.t)("figmake.supabase.cta.collapsed.failure")}},[e]);return(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,a.jsx)("div",{className:"xvy4d1p xxk0z11 x78zum5 xl56j7k x6s0dn4",children:(0,a.jsx)(sD.B,{svg:s7.A,useOriginalSrcFills_DEPRECATED:!0,svgWidth:"14px",svgHeight:"14px"})}),(0,a.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:t})]})}function s8(){return(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1qughib xh8yej3 xou54vl",children:[(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,a.jsx)("div",{className:"xvy4d1p xxk0z11 x78zum5 xl56j7k x6s0dn4",children:(0,a.jsx)(sD.B,{svg:s7.A,useOriginalSrcFills_DEPRECATED:!0,svgWidth:"14px",svgHeight:"14px"})}),(0,a.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:(0,w.t)("figmake.supabase.cta.title")})]}),(0,a.jsx)(eI.jc,{url:sR.kS,linkText:(0,w.t)("figmake.supabase.cta.link")})]})}var s4=s(216940),s9=s(194629),ae=s(772963),at=s(304425),as=s(647178);function aa({toolCallId:e,toolName:t,disabledStatus:s,initialSecretName:n,dismissSupabase:r,trackingContext:i}){return s?(0,a.jsx)(sN,{header:(0,a.jsx)(an,{disabledStatus:s,initialSecretName:n})}):(0,a.jsx)(sN,{header:(0,a.jsx)(ar,{}),body:(0,a.jsx)(ai,{toolCallId:e,toolName:t,initialSecretName:n,dismissSupabase:r,trackingContext:i})})}function an({initialSecretName:e,disabledStatus:t}){let s=n.useMemo(()=>{switch(t){case sv.TOOL_CALL_SUCCESS:return(0,w.t)("figmake.supabase.create_secret_cta.collapsed.success",{secretName:e});case sv.TOOL_CALL_DISABLED:return(0,w.t)("figmake.supabase.create_secret_cta.collapsed.disabled");case sv.TOOL_CALL_CANCELLED:default:return(0,w.t)("figmake.supabase.create_secret_cta.collapsed.failure")}},[t,e]);return(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,a.jsx)(s9.m,{}),(0,a.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:s})]})}function ar(){let{connectedProject:e}=(0,eO.GC)();return(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1qughib xh8yej3 xou54vl",children:[(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,a.jsx)(s9.m,{}),(0,a.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:(0,w.t)("figmake.supabase.create_secret_cta.header")})]}),(0,a.jsx)(eI.jc,{url:(0,sR.C4)(e?.id),linkText:(0,w.t)("figmake.supabase.create_secret_cta.link")})]})}function ai({toolCallId:e,toolName:t,initialSecretName:s,dismissSupabase:r,trackingContext:i}){let[l,c]=n.useState("init"),o=(0,a.jsx)(ae.G,{text:s,className:"x1i89z7r x1ey7xld x256u9z"});switch(l){case"init":return(0,a.jsx)(sB,{title:(0,w.tx)("figmake.supabase.create_secret_cta.body.title_secret_name",{secretName:o}),subtitle:(0,w.t)("figmake.supabase.create_secret_cta.body.subtitle"),interaction:(0,a.jsx)(ac,{interactionState:l,setInterationState:c,toolCallId:e,toolName:t,initialSecretName:s,dismissSupabase:r,trackingContext:i})});case"loading":return(0,a.jsx)(sH,{title:(0,w.t)("figmake.supabase.create_secret_cta.body.loading.title"),subtitle:(0,w.t)("figmake.supabase.create_secret_cta.body.loading.subtitle")});case"success":return(0,a.jsx)(s$,{text:(0,w.t)("figmake.supabase.create_secret_cta.body.title")});case"failed":return(0,a.jsx)(sV,{title:(0,w.tx)("figmake.supabase.create_secret_cta.body.error.title_secret_name",{secretName:o}),subtitle:(0,w.t)("figmake.supabase.create_secret_cta.body.error.subtitle"),interaction:(0,a.jsx)(ac,{interactionState:l,setInterationState:c,toolCallId:e,toolName:t,initialSecretName:s,dismissSupabase:r,trackingContext:i})})}}var al=(e=>(e.INIT="init",e.LOADING="loading",e.SUCCESS="success",e.FAILED="failed",e))(al||{});function ac({interactionState:e,setInterationState:t,toolCallId:s,toolName:r,initialSecretName:i,dismissSupabase:l,trackingContext:c}){let[o,x]=n.useState(""),d=(0,A.tS)(),u="loading"===e,m=(0,sb.S)(),h=async()=>{if(!d){console.error("No open file key found");return}t("loading");try{await at.R.createSecret({fileKey:d,secretName:i,secretValue:o}),(0,O.XJ)(c,d)}catch(e){t("failed"),(0,as.fQ)(e);return}t("success"),m({toolCallId:s,toolName:r,toolResult:{success:!0,message:`Successfully created secret ${i}.`}})};return(0,a.jsxs)("form",{className:"x78zum5 xdt5ytf x1cy8zhl xl56j7k x167g77z xkh2ocl xy13l1i",children:[(0,a.jsx)(s4.p,{type:"password",id:"password",value:o,onChange:x,placeholder:(0,w.t)("figmake.supabase.create_secret_cta.body.secret_value"),size:"lg",disabled:u}),u?(0,a.jsx)(eI.lV,{variant:"primary",children:(0,w.t)("figmake.supabase.create_secret_cta.body.button")}):(0,a.jsxs)("div",{className:"x78zum5 x167g77z",children:[(0,a.jsx)(ee.WW,{type:"submit",variant:"primary",onClick:h,children:(0,w.t)("figmake.supabase.create_secret_cta.body.button")}),(0,a.jsx)(ee.WW,{variant:"secondary",onClick:()=>l(),children:(0,w.t)("figmake.supabase.cancel")})]})]})}function ao(){let e=(0,l._J)(tl.L5);if(!e){console.error("Scratchpad file not found");return}return e}function ax({toolCall:e,toolResult:t,isMostRecentMessage:s,trackingContext:n}){let r=t&&t.result?t.result.success?sk.SUCCESS:sk.FAILURE:sk.PENDING;return(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x1cy8zhl x1jnr06f x9h44rk xmkeg23 x1y0btm7 x7z60cl",children:(0,a.jsx)(ad,{toolName:e.toolName,toolCallId:e.toolCallId,partialArgs:e.partialArgs,isMostRecentMessage:s,status:r,trackingContext:n,toolResult:t})})}function ad({toolName:e,toolCallId:t,partialArgs:s,isMostRecentMessage:r,status:i,trackingContext:l,toolResult:c}){let o=(0,eE.gJ)(),[x,d]=n.useState(!1),[u,m]=n.useState(!1),h=(0,D.ry)(),p=n.useMemo(()=>r?h||o&&(0,eE.d4)(e)?sv.TOOL_CALL_DISABLED:x?sv.TOOL_CALL_CANCELLED:void 0:i===sk.SUCCESS?sv.TOOL_CALL_SUCCESS:sv.TOOL_CALL_CANCELLED,[r,i,o,x,h,e,u]),f=n.useMemo(()=>{if(e.startsWith(sy.lh)&&!r)switch(i){case sk.SUCCESS:return sv.TOOL_CALL_SUCCESS;case sk.FAILURE:return sv.TOOL_CALL_CANCELLED;case sk.PENDING:return sv.TOOL_CALL_PENDING}if(x)return sv.TOOL_CALL_CANCELLED},[r,i,x,e]),_=(0,sb.S)();(0,g.kc)().bake_mcp_client&&function(){try{localStorage.setItem("mcp_tool_permissions_Deepwiki",JSON.stringify({read_wiki_structure:"unsupervised",read_wiki_contents:"ask_permission"}))}catch(e){console.warn("Failed to initialize test MCP permissions:",e)}}();let y=(0,A.tS)()||"",j=n.useCallback(s=>{(0,O.IB)({persistentEntityId:l.persistentEntityId,clientLifecycleId:l.clientLifecycleId},e,y),d(!0),m(!1),_({toolCallId:t,toolName:e,toolResult:s})},[t,e,_,y,l.persistentEntityId,l.clientLifecycleId]),k=n.useCallback(async(s,a,n)=>{try{m(!0);let r=await sj.Ay.mcp.callTool({serverId:s,toolName:a,toolArgs:n},(0,e_.Ay)()),i={success:!0,message:`Successfully executed MCP tool "${a}" from server "${s}"`,result:r.result?.content};_({toolCallId:t,toolName:e,toolResult:i})}catch(e){j({success:!1,message:`Failed to execute MCP tool: ${e instanceof Error?e.message:"Unknown error"}`})}finally{m(!1)}},[j,_,t,e]);switch(e){case"supabase_connect":{let s={success:!1,message:"User dismissed Supabase connect tool call"};return(0,a.jsx)(s3,{toolCallId:t,toolName:e,disabledStatus:p,dismissSupabase:()=>j(s),trackingContext:l})}case"create_supabase_secret":{let n={success:!1,message:"User dismissed secret creation tool call"};return(0,a.jsx)(aa,{toolCallId:t,toolName:e,disabledStatus:p,initialSecretName:s.secretName??"",dismissSupabase:()=>j(n),trackingContext:l})}case"scratchpad_add_todo_tool":return(0,a.jsx)(sM,{onAccept:e=>{let t=ao();if(!t){console.error("Scratchpad file not found");return}let s=JSON.stringify({todos:e});j({success:!0,message:`The user accepted the suggested TODOs. This is what's in the scratchpad file:

${t.sourceCode}

You may start implementing it.`,data:s})},toolCallId:t,toolResult:c,todos:s.todos??[],getScratchpadFileNode:ao});default:if((0,g.kc)().bake_mcp_client&&e.startsWith(sy.lh)){let{serverName:n,serverToolName:r}=(0,sy.Tr)(e),i=function(e,t){try{let s=`mcp_tool_permissions_${e}`,a=localStorage.getItem(s);if(a)return JSON.parse(a)[t]??"ask_permission"}catch(e){console.warn("Failed to parse MCP tool permissions:",e)}return"ask_permission"}(n,r),l={success:!1,message:`User dismissed mcp tool call - ${e}`};return(0,a.jsx)(sS,{toolCallId:t,toolName:e,toolArgs:s,onConfirm:()=>k(n,r,s),onDismiss:()=>j(l),disabledStatus:f,autoRun:"unsupervised"===i,isLoading:u})}return null}}var au=s(725694),am=s(883187),ah=s(371868),ap=s(465428),ag=s(723309),af=s(697872),a_=s(356138),ay=s(129215),aj=s(321259),ak=s(832937);let av=[a_.iK,ay.Db,aj.v5,aj.YW,ak.jL,ak.dJ,ay.k_,ay.Db],ab="editor_theme--heading--vjD0c",aN="editor_theme--revTextCode--mNWW0",aC="editor_theme--revHeading--ImFNg",aE={code:"editor_theme--code--FBk-C",heading:{h1:ab,h2:ab,h3:ab,h4:ab,h5:ab,h6:ab},link:"editor_theme--link--g9j-A",list:{listitem:"editor_theme--listItem--HtIgs",nested:{listitem:"editor_theme--nestedListItem--rxhSm"},ol:"editor_theme--listOl--bcK9i",ul:"editor_theme--listUl--9En-S"},ltr:"editor_theme--ltr--z-aAi",rtl:"editor_theme--rtl--2jeQD",paragraph:"editor_theme--paragraph--5klW3",placeholder:"editor_theme--placeholder--1ATfY",quote:"editor_theme--quote--x7A5C",text:{bold:"editor_theme--textBold--eUufn",code:"editor_theme--textCode--dShpu",italic:"editor_theme--textItalic--6aIoY",strikethrough:"editor_theme--textStrikethrough--Nx-DH",underline:"editor_theme--textUnderline--sWctL",underlineStrikethrough:"editor_theme--textUnderlineStrikethrough--BF3Oy"}},aw={code:aN,heading:{h1:aC,h2:aC,h3:aC,h4:aC,h5:aC,h6:aC},link:"editor_theme--revLink--cC1OE",list:{listitem:"editor_theme--revListItem--t-JSJ",nested:{listitem:"editor_theme--revNestedListItem--xI4pL"},ol:"editor_theme--revListOl--VIR3k",ul:"editor_theme--revListUl--l1Hwr"},ltr:"editor_theme--revLtr--P2rY9",rtl:"editor_theme--revRtl--p2uEF",paragraph:"editor_theme--revParagraph--nf-XL",placeholder:"editor_theme--revPlaceholder--MjHDL",quote:"editor_theme--revQuote--vLFjg",text:{bold:"editor_theme--revTextBold--B6at8",code:aN,italic:"editor_theme--revTextItalic--Bc6Q3",strikethrough:"editor_theme--revTextStrikethrough--OgIi0",underline:"editor_theme--revTextUnderline--Vbg5K",underlineStrikethrough:"editor_theme--revTextUnderlineStrikethrough--H-f-D"}},az=[au.TB,au.jA,au.mK,au.NB,au.eA,au.gb,au.d7,au.Pi,au.Eg,au.gW,au.WY,au.ps];function aT(e){let[t]=(0,ah.DF)();return(0,n.useEffect)(()=>{try{t.update(()=>{(0,au.Wn)(e.textContent,az,void 0,!0)},{discrete:!0})}catch(s){console.error("Error parsing editor state. Default to empty lexical state",s);let e=t.parseEditorState('{"root":{"children":[{"children":[],"direction":null,"format":"","indent":0,"type":"paragraph","version":1,"textStyle":""}],"direction":null,"format":"","indent":0,"type":"root","version":1}}');t.setEditorState(e)}},[e.textContent,t]),(0,a.jsx)("div",{children:(0,a.jsx)(af.$,{contentEditable:(0,a.jsx)(ap.a,{className:"x1iyjqo2",spellCheck:!1,"data-testid":"code-chat-content-editable",contentEditable:!1}),placeholder:null,ErrorBoundary:ag.R})})}function aS({textContent:e,editorTheme:t}){return(0,a.jsx)(am.n,{initialConfig:{namespace:"code-chat-rich-text-editor",onError(e){throw e},theme:t??aE,nodes:av,editable:!1},children:(0,a.jsx)(aT,{textContent:e})})}function aA(){let e=(0,W.Oc)()?aw:aE;return function(t){return(0,a.jsx)(aS,{textContent:t,editorTheme:e})}}var aL=s(174026),aq=s(537665),aI=s(238198);function aO({reasoning:e,isReasoningComplete:t}){let s=aA(),r=n.useRef(null),[i,l]=n.useState(!1),[c,o]=n.useState(!1);n.useEffect(()=>{r.current&&l((r.current?.scrollHeight||0)>184)},[e]);let x=s(e??"");n.useEffect(()=>{if(r.current&&!t){let e=r.current;requestAnimationFrame(()=>{e.scrollTop=e.scrollHeight})}},[e,t]);let d=c||!t;return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf",children:[t?(0,a.jsxs)(et.E,{...{0:{className:"x78zum5 x6s0dn4 x87ps6o x1ypdohk x11g6tue xfn42iu xng3xce x1r7ld26 x1717udv xh8yej3 xdpxx8g xv1l7n4 x1op4zxa"},1:{className:"x78zum5 x6s0dn4 x87ps6o x1ypdohk x11g6tue xfn42iu xng3xce x1r7ld26 x1717udv xh8yej3 xdpxx8g x1op4zxa xiuzu7u"}}[!!c<<0],onClick:()=>o(!c),"aria-expanded":c,"aria-label":c?(0,w.t)("figmake.chat.hide_reasoning"):(0,w.t)("figmake.chat.show_reasoning"),children:[(0,w.t)("figmake.chat.reasoning"),(0,a.jsx)(aI.a,{...{0:{className:"xtc4nxu x1bmturs"},1:{className:"x1bmturs xtlvio2 x1iffjtl"}}[!!c<<0]})]}):(0,a.jsx)(su.N,{children:(0,w.t)("figmake.chat.reasoning")}),(0,a.jsx)("div",{className:"xb3r6kr",children:(0,a.jsxs)(y.N,{mode:"wait",children:[!t&&(0,a.jsxs)(j.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},style:{position:"relative"},children:[i&&(0,a.jsx)("div",{className:"x10l6tqk xu96u03 x3m8u43 xxk0z11 x47corl x13vifvy x1b0inr7"}),(0,a.jsx)("div",{ref:r,className:"xv1l7n4 x19sr0n1 x19ypqd9 x1u2bih1 xf18ygs xnuq7ks x1anpbxc x1iog12x x1hx0egp xkcv6ua x1ed109x x1i69ec5 xb3r6kr x78zum5 xdt5ytf xmidabu",children:x}),i&&(0,a.jsx)("div",{className:"x10l6tqk xu96u03 x3m8u43 xxk0z11 x47corl x1ey2m1c xdu2321"})]},"in-progress"),t&&d&&(0,a.jsx)(j.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},children:(0,a.jsx)("div",{className:"xv1l7n4 x19sr0n1 x19ypqd9 x1u2bih1 xf18ygs xnuq7ks x1anpbxc x1iog12x x1hx0egp x1odjw0f xkcv6ua x1ed109x",children:x})},"completed")]})})]})}let aM={container:{k1xSpc:"x78zum5",kXwgrk:"xdt5ytf",kOIVth:"xou54vl",$$css:!0}};function aF({messages:e,isMostRecent:t,isInProgress:s,hasExchangeMessages:r,showCodeStreaming:i,scrollToBottom:l,trackingContext:c,chatMessagesNodeGuid:o,versionNumber:x,isAutoErrorFix:d,featureType:u,title:m,layerDisplayName:h}){let{defaultTypographyStyle:p}=(0,si.L)(),f=!!(0,g.kc)().bake_chat_message_revamp,y=e[e.length-1],j=y?.type==="summary"||y?.type==="visible_message"?y.codeSnapshot:void 0,k=(()=>{switch(y?.type){case"message":case"visible_message":return y.message;case"plan":return y.plan;case"summary":return y.summary;case"work":return y.work;default:return}})(),v=y?.type==="reasoning"?y.reasoning:void 0,b=j?.codeSnapshotKey,{restoreVersion:N}=(0,aq.OL)({codeSnapshotKey:b,chatMessagesNodeGuid:o,featureType:u,restoreToVersionTitle:m,...c}),C=n.useRef((k||v)??""),E=n.useRef(y?.id);n.useEffect(()=>{if(!s)return;let e=(k||v)??"";(y?.id!==E.current||e.length>C.current.length)&&l(),C.current=e,E.current=y?.id},[k,v,l,s,y?.id]);let z=(0,ed.ZC)(s);n.useEffect(()=>{!s&&z&&t&&l()},[s,t,l,z]);let T=n.useMemo(()=>t&&s?(0,a.jsx)(sg.F,{type:"progress",showCodeStreaming:i,chatMessagesNodeGuid:o,layerDisplayName:h,scrollToBottom:l},`progress-${o}`):null,[t,s,o,l,h,i]),S=n.useMemo(()=>{if(0===e.length&&r)return[d?(0,a.jsx)(aU,{},"fixing"):(0,a.jsx)(aR,{},"thinking")];let n=!1,i=!1;return e.flatMap((r,l)=>{let d=l===e.length-1,u=!1;switch(r.type){case"reasoning":let p=l<e.length-1;return[(0,a.jsx)(aO,{reasoning:r.reasoning,isReasoningComplete:p},`reasoning-${l}`)];case"plan":return n=!0,[(0,a.jsx)(a$,{plan:r.plan},`plan-${l}}`)];case"summary":return[f?null:(0,a.jsx)(sg.F,{type:"version",isCurrentVersion:t,versionNumber:x,restoreVersion:N,chatMessagesNodeGuid:o,layerDisplayName:h,versionTitle:m},`summary-artifact-${l}`),(0,a.jsx)(aH,{summary:r.summary},`summary-${l}`)];case"clientSideToolCall":return u=d&&s&&!(0,sm.j)(r.toolCall.toolName),[(0,a.jsx)(ax,{toolCall:r.toolCall,toolResult:r.toolResult,isMostRecentMessage:t&&d,trackingContext:c},`clientSideToolCall-${l}`),...u?[(0,a.jsx)(aP,{},"working")]:[]];case"selectionRequest":return[(0,a.jsx)(s_,{type:r.type,message:r.message,selectedNodeIds:r.selectedNodeIds,onContinue:r.onContinue},`selectionRequest-${l}`)];case"visible_message":return i=!0,[f||s||!d?null:(0,a.jsx)(sg.F,{type:"version",isCurrentVersion:t,versionNumber:x,restoreVersion:N,chatMessagesNodeGuid:o,layerDisplayName:h,versionTitle:m},`visible-message-artifact-${l}`),(0,a.jsx)(aB,{message:r.message},`visible_message-${l}`)];default:if(d&&T){let t=e.findIndex(e=>"summary"===e.type||"visible_message"===e.type),s=(n||i)&&(-1===t||t<l);return u="toolCall"===r.type&&!(0,sm.j)(r.name),s?[T]:u?[(0,a.jsx)(aP,{},"working")]:[]}return[]}})},[e,d,x,t,N,T,s,f,o,m,c,h,r]),A=(0,a.jsx)(aV,{trackingContext:c,isInProgress:s,featureType:u,lastMessage:y,chatMessagesNodeGuid:o}),L=f&&!s?(0,a.jsx)(sg.F,{type:"version",isCurrentVersion:t,versionNumber:x,restoreVersion:N,chatMessagesNodeGuid:o,layerDisplayName:h,versionTitle:m},`version-${x}`):null;return(0,a.jsx)("div",{role:"region","aria-label":(0,w.t)("figmake.chat.artifact.a11y_reasoning_section_title",{version:x,title:m||""}),children:(0,a.jsxs)("div",{..._.Ay.props(aM.container,p),"data-testid":"assistant-chat-messages-v2",children:[S,L,A]})})}function aD({message:e}){return(0,a.jsx)("div",{className:"x1n2onr6",children:(0,a.jsx)(sx.E,{children:(0,a.jsx)(sd.T,{role:"alert",children:e})})})}function aR(){return(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x167g77z",children:[(0,a.jsx)(sp.H,{}),(0,a.jsx)(aD,{message:(0,w.t)("figmake.chat.thinking")}),(0,a.jsx)(su.N,{children:(0,w.t)("figmake.chat.thinking")})]})}function aP(){return(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x167g77z",children:[(0,a.jsx)(sp.H,{}),(0,a.jsx)(su.N,{children:(0,w.t)("figmake.chat.working")})]})}function aU(){return(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x167g77z",children:[(0,a.jsx)(sp.H,{}),(0,a.jsx)(su.N,{children:(0,w.t)("figmake.chat.fixing")})]})}function aG({text:e}){let t=aA();return(0,a.jsxs)("div",{className:"x1ed109x",children:[" ",t(e.trim())]})}function a$({plan:e}){return(0,a.jsx)(aG,{text:e})}function aH({summary:e}){return(0,a.jsx)(aG,{text:e})}function aB({message:e}){return(0,a.jsx)(aG,{text:e})}function aV({trackingContext:e,isInProgress:t,featureType:s,lastMessage:r,chatMessagesNodeGuid:l}){let c=(0,A.q5)(),o=c?.key||null,x=e.clientLifecycleId&&!t&&c?.canEdit,{feedbackState:d,setFeedbackState:u,sentimentFeedbackCallback:m,additionalFeedbackCallback:h,productType:p}=(0,aL.q)(e,o,s,r?.id||"",l),f=s===i.lV.AI_ASSISTANT?eb.JT.ASSISTANT_CHAT:eb.JT.CODE_CHAT,_=(0,z.uQ)(),y={action:f,source:s,clientLifecycleId:e.clientLifecycleId,quick_actions_session_id:null,file_key:o,product_type:p};return x?(0,a.jsxs)("div",{className:"x11yfylt x78zum5 xg2d0mh",children:[(0,a.jsx)(sh.z,{aiTrackingContext:y,sentimentFeedbackCallback:m,additionalFeedbackCallback:h,hideInitialText:!0,externalFeedbackState:d,setExternalFeedbackState:u,thumbsUpLabel:(0,w.t)("figmake.chat.thumbs_up"),thumbsDownLabel:(0,w.t)("figmake.chat.thumbs_down")}),(0,g.kc)().make_edits_debug&&s===i.lV.AI_ASSISTANT&&(0,a.jsx)(n.Suspense,{fallback:null,children:(0,a.jsx)(aW,{nodeId:_,aiTrackingContext:y})})]}):null}let aW=n.lazy(()=>s.e(754).then(s.bind(s,480754)));var aK=s(276800);let aY=3*window.innerHeight;var aX=s(254362);function aJ({chatMessagesNodeGuid:e,messagesForRendering:t,exchangeMessageIds:s,emptyState:r,dragOverlay:l,featureType:c,layerDisplayName:o,isResizingPanel:x,clientLifecycleIdMap:d,showCodeStreaming:u,codeFileChanges:m}){let h=(0,n.useRef)(null),p=(0,n.useRef)(null),g=(0,n.useRef)(null),f=(0,n.useRef)(null),_=(0,n.useRef)(new Map),y=(0,n.useRef)(new Map),j=(0,n.useRef)(void 0),{handleScroll:k,showScrollToBottomButton:v,handleScrollToBottomClick:b,requestScrollToBottom:N,onScrollToBottom:C,isFirstMountScrollComplete:E}=function({scrollContainerRef:e,scrollEndRef:t,nearBottomThreshold:s=.3,scrollToBottomOnMount:a=!1,numScrollToBottomRetries:r=5}){let[i,l]=(0,n.useState)(!1),[c,o]=(0,n.useState)(!1),[x,d]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),[h,p]=(0,n.useState)(!1),g=(0,n.useRef)(0),f=(0,n.useRef)(0),_=(0,n.useRef)(null);(0,n.useEffect)(()=>()=>{_.current&&clearTimeout(_.current),f.current&&(clearTimeout(f.current),f.current=null)},[]);let y=(0,n.useCallback)(t=>{if(!e.current)return!1;let{scrollTop:a,scrollHeight:n,clientHeight:r}=e.current,i=void 0!==t?t:r*s;return n-a-r<i},[s,e]),j=(0,n.useCallback)((s="smooth",a=aK.lQ)=>{if(!e.current||f.current)return;if(e.current&&y(5)){a();return}let n=()=>{f.current&&(clearTimeout(f.current),f.current=null),d(!1),requestAnimationFrame(()=>a())},i=0,l=()=>{i++;let a=e.current;if(!a){n();return}if(i>2&&"smooth"===s){let{scrollTop:e,scrollHeight:t,clientHeight:s}=a;t-e-s>aY&&(a.scrollTop=t-aY)}if(requestAnimationFrame(()=>t.current?.scrollIntoView({behavior:s})),i>=r){n();return}f.current=setTimeout(()=>{requestAnimationFrame(()=>{if(!a){n();return}y(5)?n():l()})},"smooth"===s?300:50)};l()},[t,e,y,r]),k=(0,n.useCallback)(()=>{c||i?(d(!0),y()||m(!0)):(j(),m(!1))},[y,c,j,i]);return(0,n.useEffect)(()=>{a&&!h?j("instant",()=>p(!0)):a||p(!0)},[a,h,j]),{showScrollToBottomButton:u,handleScroll:(0,n.useCallback)(e=>{_.current&&clearTimeout(_.current);let t=e-g.current,s=f.current,a=e=>{s||l(e)};e!==g.current&&(t<0?(o(!0),y()||(a(!0),m(x))):(o(!1),t>=0&&y()&&(a(!1),m(!1),x&&j())),y()&&m(!1)),g.current=e,s||(_.current=window.setTimeout(()=>{o(!1),_.current=null},200))},[y,x,j]),handleScrollToBottomClick:(0,n.useCallback)(()=>{l(!1),m(!1),j()},[j]),requestScrollToBottom:k,onScrollToBottom:j,isFirstMountScrollComplete:h,userHasControl:i,isScrollingUp:c,pendingScrollToBottom:x,isNearBottom:y}}({scrollContainerRef:h,scrollEndRef:g,scrollToBottomOnMount:t.length>0}),w=(0,sr.iZ)();!function(e){let{messagesForRendering:t,currentUserId:s,onScrollToBottom:a,requestScrollToBottom:r,scrollContainerRef:i}=e,l=(0,n.useRef)(t.length);(0,n.useEffect)(()=>{if(t.length>l.current){let e=t.slice(l.current),n=e.filter(e=>"user"===e.type&&e.user?.id===s),c=e.filter(e=>"system"===e.type),o=i.current;if(o){let{scrollTop:e,scrollHeight:t,clientHeight:s}=o;t-e-s<100?a():n.length>0||c.length>0?a():r()}else n.length>0||c.length>0?a():r();l.current=t.length}else t.length<l.current&&(l.current=t.length)},[t,s,a,r,i])}({messagesForRendering:t,currentUserId:w?.id,onScrollToBottom:C,requestScrollToBottom:N,scrollContainerRef:h});let z=(0,n.useMemo)(()=>v?(0,a.jsx)(et.E,{className:"x78zum5 x6s0dn4 xl56j7k x10l6tqk x1td3qas x10w6t97 x1c7jfne x1nrll8i xuuh30 x1yjdb4r x16rqkct x16a2w50 x1ypdohk x1epfdc x1vjfegm xk82a7y",onClick:b,children:(0,a.jsx)(ss.W,{})}):null,[v,b]),T=(0,n.useCallback)(e=>0===t.length?0:_.current.get(e)||600,[t.length,600]),S=(0,st.z)({size:t.length-1,parentRef:h,estimateSize:T,overscan:10});p.current=S;let A=(0,sa.A)(()=>{p.current&&!j.current&&p.current.measure()},16),L=(0,n.useCallback)((e,t)=>{y.current.set(e,t),_.current.get(e)!==t.height&&(_.current.set(e,t.height),A())},[A]);(0,n.useEffect)(()=>{let e=j.current;if(!e&&x&&(y.current.clear(),S.virtualItems.forEach(e=>{let t=h.current?.querySelector(`[data-virtual-index="${e.index}"]`);if(t){let s=a5(t);y.current.set(e.index,s)}}),f.current)){let e=a5(f.current);y.current.set(t.length-1,e)}e&&!x&&(y.current.clear(),p.current&&p.current.measure()),j.current=x},[x,S.virtualItems,t.length]);let q=(0,n.useMemo)(()=>{let e=0;return t.map(t=>{if("system"===t.type){if("restore"===t.systemMessageType||"manual_edit"===t.systemMessageType)return e++}else if("assistant"===t.type)return 1+(t.messages.some(e=>"summary"===e.type||"visible_message"===e.type)?e++:e);return 0})},[t]),I=0===t.length?(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x98rzlu x1iyjqo2 xs83m0k x1r8uery xysyzu8 xl56j7k",children:r}):(0,a.jsxs)(sn.P,{className:"x78zum5 xdt5ytf x98rzlu x1iyjqo2 xs83m0k x1r8uery xb3r6kr xjkvuk6",scrollContainerRef:h,onScroll:k,innerClassName:"x1xn8qrt xnjsko4",children:[(0,a.jsx)("div",{style:{height:`${S.totalSize}px`,width:"100%",position:"relative"},className:"x78zum5 xdt5ytf",children:S.virtualItems.map(n=>{let r=t[n.index];if(!r)return null;let i=y.current.get(n.index);return(0,a.jsx)(a0,{isLast:!1,setSize:L,isResizingPanel:x,frozenDimensions:i,index:n.index,setMeasureRef:n.measureRef,start:n.start,isFirstMountScrollComplete:E,children:(0,a.jsx)(a1,{chatMessagesNodeGuid:e,clientLifecycleIdMap:d,codeFileChanges:m,exchangeMessageIds:s,featureType:c,index:n.index,isLast:!1,layerDisplayName:o,message:r,requestScrollToBottom:N,showCodeStreaming:u,versionNumber:q[n.index]??0})},`${r.type}-message-${n.index}`)})}),t.length>0&&(0,a.jsx)(a0,{isLast:!0,setSize:L,isResizingPanel:x,frozenDimensions:y.current.get(t.length-1),index:t.length-1,setMeasureRef:e=>{f.current=e},isFirstMountScrollComplete:E,children:(0,a.jsx)(a1,{chatMessagesNodeGuid:e,clientLifecycleIdMap:d,codeFileChanges:m,exchangeMessageIds:s,featureType:c,index:t.length-1,isLast:!0,layerDisplayName:o,message:t[t.length-1],requestScrollToBottom:N,showCodeStreaming:u,versionNumber:q[t.length-1]??0})},"last-message"),c===i.lV.AI_ASSISTANT&&t.length>0&&t[t.length-1]?.type==="user"&&(0,a.jsx)("div",{className:"x10dr8xq x1hr3lfm x78zum5 xdt5ytf",children:(0,a.jsx)(aR,{})},"post-user-thinking"),(0,a.jsx)("div",{ref:g},"messages-end")]});return(0,a.jsxs)("div",{className:"x1n2onr6 x78zum5 xdt5ytf x5yr21d xh8yej3","data-testid":"code-chat-messages",style:{visibility:E?"visible":"hidden"},children:[I,z,l&&(0,a.jsx)("div",{className:"x10l6tqk x13vifvy xu96u03 x3m8u43 x1ey2m1c xhtitgo",children:l})]})}let aQ=null,aZ=new WeakMap,a0=n.memo(function(e){let{setSize:t,isResizingPanel:s,frozenDimensions:r,index:i,setMeasureRef:l,start:c,isLast:o,isFirstMountScrollComplete:x}=e,d=(0,n.useRef)(i),[u,m]=n.useState(!1),h=(0,n.useRef)(0),p=x&&(s?r:u);(0,n.useEffect)(()=>{d.current=i},[i,d]);let g=(0,n.useRef)(!1),f=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=f.current;if(!e||s)return;let a=(aQ||(aQ=new ResizeObserver(e=>{requestAnimationFrame(()=>{for(let t of e){let e=aZ.get(t.target);e&&e(t)}})})),aQ);return aZ.set(e,e=>{let s=e.contentRect.height;s>0&&Math.abs(s-h.current)>.5&&(h.current=s,t(d.current,{width:e.contentRect.width,height:s}),m(!0))}),a.observe(e),()=>{a.unobserve(e),aZ.delete(e)}},[t,s]),(0,n.useEffect)(()=>{if((o||!g.current)&&f.current&&!s){g.current=!0;let e=a5(f.current);e.height&&(t(d.current,e),m(!0)),l&&l(f.current)}},[o,t,l,s]);let _=s&&r?{width:`${r.width}px`,height:`${r.height}px`}:{};return(0,a.jsx)("div",{ref:f,"data-virtual-index":i,style:{...c?{position:"absolute",top:c,left:0,width:"100%"}:{},..._,visibility:p?"visible":"hidden"},children:(0,a.jsx)("div",{className:"x10dr8xq x1hr3lfm x78zum5 xdt5ytf",tabIndex:-1,children:e.children})})});function a1({index:e,message:t,featureType:s,versionNumber:r,isLast:i,chatMessagesNodeGuid:l,clientLifecycleIdMap:c,codeFileChanges:o,layerDisplayName:x,exchangeMessageIds:d,requestScrollToBottom:u,showCodeStreaming:m}){let h=(0,A.q5)(),p=h?.key||null,f=(0,n.useMemo)(()=>(0,O.qE)(p,l),[p,l]),_=h?.name;switch(t.type){case"user":return(0,a.jsx)(so,{user:t.user,featureType:s,plainText:t.plainText,imports:t.imports,inspectedElement:t.inspectedElement,selectedNodeIds:t.selectedNodeIds},`${t.type}-message-${e}`);case"system":switch(t.systemMessageType){case"restore":return(0,a.jsx)(aX.V,{message:t,chatMessagesNodeGuid:l,systemMessageIndex:r,featureType:s,isMostRecent:i,trackingContext:{persistentEntityId:f,clientLifecycleId:c.get(t.id)??""},title:t.title||_,layerDisplayName:x},`${t.type}-message-${e}`);case"manual_edit":if(!(0,g.kc)().bake_manual_edits)return null;if(t.id===aX.ct&&o)return(0,a.jsx)(aX.Re,{chatMessagesNodeGuid:l,featureType:s,codeFileChanges:o,layerDisplayName:x,versionNumber:r},`${t.type}-message-${e}`);return(0,a.jsx)(aX.pr,{message:t,chatMessagesNodeGuid:l,systemMessageIndex:r,featureType:s,isMostRecent:i,trackingContext:{persistentEntityId:f,clientLifecycleId:c.get(t.id)??""},title:t.title||_,layerDisplayName:x},`${t.type}-message-${e}`);case"duplicated_file":return(0,a.jsx)(aX.M_,{},`${t.type}-message-${e}`);case"deleted_chat_history":return(0,a.jsx)(aX.a_,{message:t},`${t.type}-message-${e}`);default:return null}case"assistant":let y=t.messages[t.messages.length-1],j=t.clientLifecycleId??c.get(y?.id||"")??"",k=d.has(y?.id||"");return(0,a.jsx)(aF,{chatMessagesNodeGuid:l,featureType:s,hasExchangeMessages:d.size>0,isAutoErrorFix:t.isAutoErrorFix??!1,isInProgress:k,isMostRecent:i,layerDisplayName:x??void 0,messages:t.messages,scrollToBottom:u,showCodeStreaming:m,title:t.title||_,trackingContext:{persistentEntityId:f,clientLifecycleId:j},versionNumber:r})}}function a5(e){if(!e)return{width:0,height:0};let t=e.getBoundingClientRect();return{width:t.width,height:t.height}}var a2=s(822695),a7=s(980852),a3=s(500275);let a6={hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1,transition:{duration:.3}},exit:{opacity:0,scale:.8,transition:{duration:.2}}},a8={animate:e=>({opacity:[.5,1,.5],y:[0,-2,0],transition:{duration:1,repeat:Number.POSITIVE_INFINITY,ease:"easeOut",times:[0,.5,1],delay:e}})};function a4({visible:e}){return(0,a.jsx)(y.N,{mode:"wait",children:e&&(0,a.jsx)(j.P.div,{className:"x78zum5 x6s0dn4 x1v8gsql xc7ga6q x1i2kgm6 x1db2dqx",animate:"visible",exit:"exit",initial:"hidden",variants:a6,children:(0,a.jsxs)("div",{className:"x78zum5 x195vfkc xpqajaz",children:[(0,a.jsx)(j.P.span,{className:"x1g8rjiy xuoj239 x1vc12gn xorixrz",custom:0,animate:"animate",variants:a8}),(0,a.jsx)(j.P.span,{className:"x1g8rjiy xuoj239 x1vc12gn xorixrz",custom:.25,animate:"animate",variants:a8}),(0,a.jsx)(j.P.span,{className:"x1g8rjiy xuoj239 x1vc12gn xorixrz",custom:.5,animate:"animate",variants:a8})]})})})}function a9({typingUsers:e}){return(0,a.jsx)("div",{className:"xqtp20y x1vjfegm x1n2onr6",children:(0,a.jsxs)("div",{className:"x10l6tqk x2rgi x131sewu x78zum5 xh8yej3 x13a6bvl",children:[(0,a.jsx)(a4,{visible:e.length>0}),(0,a.jsx)(y.N,{mode:"wait",children:e.map((e,t)=>(0,a.jsx)(o.K,{"aria-label":e.name,"data-tooltip-show-above":!0,children:(0,a.jsx)(j.P.div,{className:"x1qgsegg xaatb59 xlofgcs x16rqkct",style:{marginLeft:t>0?"-6px":"0"},animate:"visible",exit:"exit",initial:"hidden",variants:a6,children:(0,a.jsx)(eS.H8,{user:e})})},e.sessionID))})]})})}function ne(){return(0,a.jsxs)("svg",{width:"41",height:"41",viewBox:"0 0 41 41",fill:"none",children:[(0,a.jsx)("rect",{x:"0.776855",y:"0.777344",width:"40",height:"40",rx:"5",fill:"white"}),(0,a.jsx)("rect",{x:"2.77686",y:"2.77734",width:"36",height:"36",rx:"4",fill:"url(#paint0_linear_9279_71495)"}),(0,a.jsx)("circle",{cx:"28.2769",cy:"13.2773",r:"5.5",fill:"#FFD966"}),(0,a.jsx)("path",{d:"M10.7964 19.4661L2.77686 28.4176V35.7773C2.77686 37.4342 4.12 38.7773 5.77686 38.7773H34.7769L17.4119 19.4604C15.6442 17.4939 12.5608 17.4966 10.7964 19.4661Z",fill:"#009951"}),(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"paint0_linear_9279_71495",x1:"20.7769",y1:"2.77734",x2:"20.7769",y2:"38.7773",gradientUnits:"userSpaceOnUse",children:[(0,a.jsx)("stop",{stopColor:"#6EC2FF"}),(0,a.jsx)("stop",{offset:"0.117896",stopColor:"#6FC2FF"}),(0,a.jsx)("stop",{offset:"0.213837",stopColor:"#72C4FF"}),(0,a.jsx)("stop",{offset:"0.2912",stopColor:"#76C6FF"}),(0,a.jsx)("stop",{offset:"0.353363",stopColor:"#7CC8FF"}),(0,a.jsx)("stop",{offset:"0.403704",stopColor:"#84CBFF"}),(0,a.jsx)("stop",{offset:"0.4456",stopColor:"#8CCFFF"}),(0,a.jsx)("stop",{offset:"0.48243",stopColor:"#95D2FF"}),(0,a.jsx)("stop",{offset:"0.51757",stopColor:"#9FD7FF"}),(0,a.jsx)("stop",{offset:"0.5544",stopColor:"#A9DBFF"}),(0,a.jsx)("stop",{offset:"0.596296",stopColor:"#B4DFFF"}),(0,a.jsx)("stop",{offset:"0.646637",stopColor:"#BEE4FF"}),(0,a.jsx)("stop",{offset:"0.7088",stopColor:"#C9E8FF"}),(0,a.jsx)("stop",{offset:"0.786163",stopColor:"#D3ECFF"}),(0,a.jsx)("stop",{offset:"0.882104",stopColor:"#DCF0FF"}),(0,a.jsx)("stop",{offset:"1",stopColor:"#E5F4FF"})]})})]})}function nt(){return(0,a.jsx)(y.N,{children:(0,a.jsxs)(j.P.div,{className:"x1n2onr6 xh8yej3 x5yr21d x1yjdb4r x78zum5 xdt5ytf x6s0dn4 xl56j7k",initial:{opacity:0},animate:{opacity:.95},exit:{opacity:0,transition:{delay:.1}},transition:{duration:.2},children:[(0,a.jsxs)("div",{className:"x1n2onr6 xrostsh xng8ra x78zum5 x6s0dn4 xl56j7k",children:[(0,a.jsx)(j.P.div,{className:"x10l6tqk xu96u03",style:{originX:.5,originY:.5},initial:{rotate:0,x:34,y:2,scale:.8,opacity:0},animate:{rotate:-20,x:20,y:4,scale:1,opacity:.95},exit:{rotate:-23,x:20,y:4,scale:.8,opacity:0,transition:{delay:.1}},transition:{duration:.3,type:"spring",delay:.1},children:(0,a.jsx)(ne,{})}),(0,a.jsx)(j.P.div,{className:"x1vjfegm",style:{originX:.5,originY:.5},initial:{scale:.8,y:0,opacity:0},animate:{scale:1,y:0,opacity:.95},exit:{scale:.8,y:0,opacity:0,transition:{delay:.1}},transition:{duration:.4,type:"spring"},children:(0,a.jsx)(ne,{})}),(0,a.jsx)(j.P.div,{className:"x10l6tqk x3m8u43",style:{originX:.5,originY:.5},initial:{rotate:0,x:-34,y:4,scale:.8,opacity:0},animate:{rotate:23,x:-22,y:4,scale:1,opacity:.95},exit:{rotate:23,x:-22,y:2,scale:.8,opacity:0,transition:{delay:.1}},transition:{duration:.4,type:"spring",delay:.1},children:(0,a.jsx)(ne,{})})]}),(0,a.jsxs)(j.P.div,{className:"xw7yly9 x78zum5 xdt5ytf x6s0dn4",children:[(0,a.jsx)(j.P.p,{className:"x1wtuluy x1vzchgk x123g5w4 x1akne3o x1ghz6dp",initial:{opacity:0,y:8},animate:{opacity:.95,y:0},exit:{opacity:0,y:0,transition:{delay:0}},transition:{duration:.2,ease:"easeOut"},children:(0,w.t)("figmake.code_chat.drag_upload_overlay.title")}),(0,a.jsx)(j.P.p,{className:"x17hqfcz xemv814 x1ma9mv9 x1n0bwc9 x1xmf6yo x2b8uid x1jkqq1h",initial:{opacity:0,y:8},animate:{opacity:.95,y:0},exit:{opacity:0,y:0,transition:{delay:0}},transition:{duration:.2,delay:.1,ease:"easeOut"},children:(0,w.t)("figmake.code_chat.drag_upload_overlay.description")})]})]})})}var ns=s(250019),na=s(35552),nn=s(773205),nr=s(307829),ni=s(454851),nl=s(517946),nc=s(788110),no=s(312325),nx=s(658704),nd=s(719423),nu=s(361170),nm=s(422872),nh=s(571430),np=s(235711),ng=s(295253),nf=s(498726),n_=s(143277),ny=s(103345),nj=s(810149),nk=s(441030),nv=s(707490),nb=s(329965),nN=s(244205),nC=s(61102),nE=s(654200),nw=s(854095);function nz({targetKey:e,isShowing:t,onComplete:s}){return(0,a.jsx)(nC.rq,{arrowPosition:nE.F_.BOTTOM,description:(0,w.tx)("figmake.design_system_imports.selected_design_system_overlay.description"),emphasized:!0,isShowing:t,onClose:s,onTargetLost:s,primaryCta:{label:(0,w.tx)("figmake.design_system_imports.learn_more"),href:nw.kC,type:"link",variantOverride:"white",ctaTrackingDescriptor:nN.c.DS_IMPORT_LEARN_MORE},targetKey:e,title:(0,w.tx)("figmake.design_system_imports.selected_design_system_overlay.title"),trackingContextName:"Make Design System Imports > Selected Design System Overlay"})}let nT=(0,np.r1)("seen_figmake_selected_design_system_onboarding");function nS({isViewOnly:e,hasMessages:t,libraryImport:s,disabled:i}){let o;let x=(0,f.md)(nT),{show:d,isShowing:u,complete:m}=(0,nm.e)({overlay:nk.q6k,priority:n_.N.DEFAULT_MODAL},[x]),h=(0,A.tS)();n.useEffect(()=>{if(e)return;let t=(0,l.$d)();t[nw.dY]||t[nw.x1]||p.l7.ai("code-chat",()=>{a7.UN()?.createNewCodeFile({path:nw.dY,sourceCode:"",entryPoint:null,isEntrypointCodeFile:!1,onError:e=>{b.$D(c.e.MAKE,e)},enableDuplicateCheck:g.kc().bake_dup_code_files})})},[e]);let _=(0,A.q5)(),y=(0,ek.X$)("LibraryImportButton"),j=(0,ek.YY)(y).unwrapOr(!1),[v,N]=n.useState(!1),C=(0,n.useRef)(null),E=(0,f.Xr)(nv.jx),z=(0,r.wA)();n.useEffect(()=>{s&&!f.zl.get(B.FX)&&d({canShow:e=>!e})},[s,d]);let S=s?.frozen?s:null,{getTriggerProps:L,manager:q}=nr.b(),I=e=>{let t=(0,l.$d)()[e]||null;t&&((0,R.Zr)(t),E(nv.Ic.CODE),t.codeFilePath&&(0,nj.ci)(t.codeFilePath))},O=j&&(0,g.kc)().bake_starter_limit,M=()=>{if(O){z(T.to({type:ny.DV,data:{team:_?.team??null,resource:nf.Bi.CODE_CHAT_LIBRARY_IMPORT,currentPlan:nh.F.Plan.STARTER,upsellPlan:nh.F.Plan.PRO,editorType:ej._Y.FIGMAKE,upsellSource:ng.b.CODE_CHAT_LIBRARY_IMPORT}}));return}let e=C.current;if(!e||v)return;k.az.trackDefinedEvent("ds_import.library_import_button_clicked",{...(0,ns.FN)(s),file_key:h||""});let a=e.getBoundingClientRect(),n=new nu.Mi(a.left,a.top);N(!0),z(T.to({type:nb.u,data:{defaultPosition:{left:n.x,bottom:window.innerHeight-n.y+10},onCloseCallback:()=>{N(!1)},hasExistingChatMessages:t}}))},F=L(),D=F.onMouseDown;F.onMouseDown=e=>{e.preventDefault(),e.stopPropagation(),k.az.trackDefinedEvent("ds_import.settings_button_clicked",{...(0,ns.FN)(s),file_key:h||""}),m(),D(e)};let P=(0,a.jsxs)(nr.bL,{manager:q,children:[(0,n.createElement)(et.E,{...{0:{className:"x1ia1hqs x14msgrb xi46uaa xfrllxf xe0pwq x19ypqd9 x1u2bih1 xuk1p4z xv2f06h xvy4d1p xxk0z11 x78zum5 x6s0dn4 xl56j7k xxhr3t"},1:{className:"x1ia1hqs x14msgrb xi46uaa xfrllxf xe0pwq x19ypqd9 x1u2bih1 xuk1p4z xvy4d1p xxk0z11 x78zum5 x6s0dn4 xl56j7k xxhr3t x1yjdb4r"}}[!!(!i&&S)<<0],disabled:i,key:"editButton",...F,"data-onboarding-key":$.oD},(0,a.jsx)(nl.g,{})),(0,a.jsxs)(nr.mc,{children:[(0,a.jsxs)(nr.q7,{onClick:()=>{k.az.trackDefinedEvent("ds_import.edit_styles_menu_item_clicked",{...(0,ns.FN)(s),file_key:h||""}),I(nw.VK)},children:[(0,a.jsx)(nr.Q$,{children:(0,a.jsx)(nc.G,{})}),(0,a.jsxs)("div",{children:[(0,w.t)("sites.modal.edit_styles_menu_title"),(0,a.jsx)(nr.ME,{children:(0,w.t)("sites.modal.edit_styles_menu_subtitle")})]})]}),(0,a.jsxs)(nr.q7,{onClick:()=>{k.az.trackDefinedEvent("ds_import.edit_guidelines_menu_item_clicked",{...(0,ns.FN)(s),file_key:h||""});let e=(0,l._J)(nw.dY)||(0,l._J)(nw.x1);e&&I(e.codeFileFullPathWithoutScheme)},children:[(0,a.jsx)(nr.Q$,{children:(0,a.jsx)(no.A,{})}),(0,a.jsxs)("div",{children:[(0,w.t)("sites.modal.edit_guidelines_menu_title"),(0,a.jsx)(nr.ME,{children:(0,w.t)("sites.modal.edit_guidelines_menu_subtitle")})]})]})]})]}),U=s?.libraries;return U&&U.length>0&&U.every(e=>e&&e.library_key)&&(1===U.length?o=U[0].library_name:U.length>1&&(o=(0,w.t)("figmake.ds_imports.library_selector_multiple_libraries"))),S?(0,a.jsxs)("div",{ref:C,className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xmkeg23 x1y0btm7 x7z60cl xpzoddv x1v8gsql xxk0z11 x3nfvp2 x1q0g3np x6s0dn4 xxhr3t x2lah0s",children:[(0,n.createElement)(et.E,{className:"xuk1p4z xv2f06h x1hb7l2i x1a2w583 xjppbhk xsz7qvg x1lqa7cf x1ug7bdz xxhr3t",disabled:!0,key:"libraryImportButton",onClick:aK.lQ},(0,a.jsx)("div",{className:"x10739mo xlup9mm xb3r6kr xlyipyv xuxw1ft",children:o})),P]}):o?(0,a.jsxs)("div",{ref:C,...{0:{className:"x3nfvp2 x1q0g3np xxk0z11 x6s0dn4 xxhr3t x2lah0s xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xmkeg23 x1y0btm7 x7z60cl xpzoddv"},1:{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up xmkeg23 x1y0btm7 x7z60cl xpzoddv x1v8gsql xxk0z11 x3nfvp2 x1q0g3np x6s0dn4 xxhr3t x2lah0s"}}[!!i<<0],children:[(0,a.jsx)(nz,{targetKey:$.oD,isShowing:u,onComplete:m}),(0,n.createElement)(et.E,{...{0:{className:"x1hb7l2i x1a2w583 xjppbhk xsz7qvg x1lqa7cf xuk1p4z xv2f06h xxhr3t"},1:{className:"xuk1p4z xv2f06h x1hb7l2i x1a2w583 xjppbhk xsz7qvg x1lqa7cf x1ug7bdz xxhr3t"}}[!!i<<0],disabled:i,key:"libraryImportButton",onClick:M},(0,a.jsx)("div",{className:"x10739mo xlup9mm xb3r6kr xlyipyv xuxw1ft",children:o}),(0,a.jsx)("div",{className:"x1kky2od x78zum5 xl56j7k xb3r6kr",children:(0,a.jsx)(nx.r,{})})),P]}):(0,a.jsx)("div",{ref:C,children:(0,a.jsx)(ni.d,{"aria-label":(0,w.t)("sites.modal.select_library"),"aria-expanded":v,"data-tooltip-show-above":!0,disabled:i,htmlAttributes:{"data-onboarding-key":$.t$},onClick:M,children:(0,a.jsx)(nd.l,{})})})}var nA=s(918552),nL=s(99748);function nq(){let[e,t]=n.useState(!1),s=(0,n.useRef)(null),i=(0,r.wA)(),l=n.useCallback(()=>{let a=s.current;if(!a||e)return;let n=a.getBoundingClientRect(),r=new nu.Mi(n.left,n.bottom+4);t(!0),i(T.to({type:nL.D,data:{defaultPosition:r,onCloseCallback:()=>{t(!1)}}}))},[i,e]);return(0,a.jsx)(ni.d,{"aria-label":"Connections","aria-expanded":e,"data-tooltip-show-above":!0,onClick:l,ref:s,children:(0,a.jsx)(nA.K,{})})}var nI=s(915242),nO=s(316339);function nM({disabled:e,onClick:t,onUndo:s,isEnhanced:n}){return(0,g.kc)().bake_enhance_prompt?(0,a.jsx)(y.N,{mode:"wait",children:n?(0,a.jsx)(j.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2,ease:"easeInOut"},children:(0,a.jsx)(o.K,{"aria-label":(0,w.t)("figmake.chat_box.undo_enhance_prompt"),"data-tooltip-show-above":!0,disabled:e,onClick:s,children:(0,a.jsx)(x.H,{})})},"undo"):(0,a.jsx)(j.P.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.2,ease:"easeInOut"},children:(0,a.jsx)(o.K,{"aria-label":(0,w.t)("figmake.chat_box.enhance_prompt"),"data-tooltip-show-above":!0,disabled:e,onClick:t,children:(0,a.jsx)(d.T,{})})},"enhance")}):(0,a.jsx)(a.Fragment,{})}function nF({enableAssetImport:e,enableImageAttachment:t,enableDsImport:s,createLoadedAttachment:i,attachments:l,isViewOnly:x,chatMessagesNodeGuid:d,codeInstanceGuid:h,enhancePrompt:p,isEnhancing:_,generationInProgress:y,hasMessages:j,libraryImport:k}){let v=(0,r.wA)(),N=(0,f.md)(M.f3),E=n.useRef(null),[z,S]=(0,f.fp)((0,F.mC)(d)),[A,L]=n.useState(""),[I,O]=n.useState(!1),D=(0,V.g7)(),R=n.useCallback(async e=>{let t=e.target.files?.[0];t&&(await (0,nI.z)(t,i),E.current&&(E.current.value=""))},[i]),P=n.useCallback(async()=>{try{for await(let e of(L(z),p(z)))S(e);O(!0)}catch(e){L(""),O(!1),(0,b.$D)(c.e.MAKE,e instanceof Error?e:Error(String(e)))}},[p,z,S]),U=n.useCallback(()=>{S(A),O(!1),L("")},[A,S]);n.useEffect(()=>{I&&""===z&&(O(!1),L(""))},[z,I]);let G=e&&!D?(0,a.jsx)(o.K,{onClick:()=>{v(T.to({type:K.H,data:{chatMessagesNodeGuid:d}}))},"aria-label":l.length>=tj.qQ?(0,w.t)("sites.panel.make.attach_limit_reached",{limit:tj.qQ}):(0,w.t)("sites.panel.make.attach_design"),"data-tooltip-show-above":!0,disabled:x||l.length>=tj.qQ||D,htmlAttributes:{"data-onboarding-key":$.wj},children:(0,a.jsx)(u.D,{})}):null,B=t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"file",className:"x1s85apg",ref:E,accept:q.xp.join(","),onChange:R}),(0,a.jsx)(o.K,{"aria-label":l.length>=tj.qQ?(0,w.t)("sites.panel.make.attach_limit_reached",{limit:tj.qQ}):(0,w.t)("sites.panel.make.attach_image"),"data-tooltip-show-above":!0,disabled:x||l.length>=tj.qQ,onClick:()=>{E.current?.click()},children:(0,a.jsx)(m.T,{})})]}):null;return t||e?(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,g.kc)().bake_chat_attach_menu&&!D?(0,a.jsx)(a2.D,{enableAssetImport:e,enableImageAttachment:t,attachments:l,isViewOnly:x,chatMessagesNodeGuid:d,createLoadedAttachment:i}):(0,a.jsxs)(a.Fragment,{children:[G,B]}),(0,a.jsx)(nM,{disabled:x||(0,C.jN)(z)||_,onClick:P,onUndo:U,isEnhanced:I}),s&&(0,a.jsx)(nS,{isViewOnly:x,hasMessages:j,libraryImport:k,disabled:y||x||D}),(0,g.kc)().bake_click_to_inspect&&N&&h&&(0,a.jsx)(H.l,{disabled:x||D,componentPreview:N,onboardingKey:$.kx,showTooltipAbove:!0,codeInstanceGuid:h}),(0,g.kc)().bake_mcp_client&&(0,a.jsx)(nq,{})]}):(0,a.jsx)("div",{})}function nD({setInput:e,chatMessagesNodeGuid:t,codeInstanceGuid:s,exchangeMessageIds:r,layerDisplayName:c,codeFileChanges:o,sendMessage:x,emptyState:d,sendDisabled:u,enableAssetImport:m=!1,enableImageAttachment:_=!1,chatBoxRightExtraContent:y,showChatHeader:j=!1,featureType:b,enableDragUpload:C=!1,enableDsImport:T=!1,isResizingPanel:M,isLastUserMessageAutoErrorFix:$,messagesForRendering:H,clientLifecycleIdMap:K,showCodeStreaming:Y,rootPath:X,onChatInputFocus:J,typingUsers:Q=[],forceReadOnly:Z,hideChatBox:ee}){let et=(0,D.ry)()||Z,es=(0,g.kc)().bake_client_side_context_limit||!1,{codeLibraryInstance:ea}=(0,V.oA)(),en=(0,f.Xr)(B.St),er=(0,S.eY)(),{Sprig:ei}=(0,N.A)(),el=function(e){let t=(0,sr.iZ)();return t?e.filter(e=>"user"===e.type&&e.user.id===t.id).length:0}(H.filter(e=>"user"===e.type&&!r.has(e.id))),{libraryImport:ec}=(0,ns.S1)(),{exchange:eo,user:ex}=(0,F.$W)(t),ed=(0,n.useRef)(null),eu=(0,n.useRef)(null),em=(0,tT.YT)(),eh=(0,A.q5)(),ep=eh?.key,eg=(0,n.useMemo)(()=>(0,O.qE)(ep||null,t),[ep,t]);n.useEffect(()=>{ed.current&&ed.current.focus()},[]),(0,tT.vG)(),(0,na.p)(t,s=>{if(!ed.current)return;let a=ed.current.selectionStart,n=ed.current.selectionEnd,r=f.zl.get((0,F.mC)(t));e(r.substring(0,a)+s+r.substring(n))},(e,t,s)=>{k.az.trackDefinedEvent("ai_for_production.code_chat_design_node_pasted",{number_of_nodes:t,number_of_instances:s,persistent_entity_id:eg,file_key:ep})});let{attachments:ef,setAttachments:ey,stashAllAttachments:ej,createLoadedAttachment:ek,attachmentsReady:ev}=(0,tj._9)(t),eb=n.useMemo(()=>ef.some(e=>"success"===e.status&&"FIGMA_NODE"===e.type&&e.image),[ef]),eN=n.useCallback(()=>{ey(e=>e.map(e=>"success"===e.status&&"FIGMA_NODE"===e.type?function(e,t){let{nodeGuid:s,uniqueId:a}=t,n=e.get(s);if(!n)return t;let r=(0,tj.NC)(n);return r?{status:"success",nodeGuid:n.guid,image:r,imageHash:null,type:"IMAGE",uniqueId:a}:t}(er,e):e))},[ey,er]),{selectedElement:eC,selectedElementCodeSnippet:eE}=(0,P.fl)(),{setChatError:ew,chatError:ez,clearChatError:eT}=(0,tk.tk)(t),[eS,eA]=n.useState(!0),eL=(0,f.md)(tT.Ng),eq=n.useRef(!1);n.useMemo(()=>{(()=>{let e=f.zl.get((0,F.mC)(t)).length,{figmaNodeLength:s,imageTokens:a,figmaNodeCount:n,imageCount:r}=ef.reduce((e,t)=>{if("success"!==t.status)return e;if("FIGMA_NODE"===t.type){let s=t.codeFiles.reduce((e,t)=>e+t.code.length,0);return{figmaNodeLength:e.figmaNodeLength+s,imageTokens:e.imageTokens,figmaNodeCount:e.figmaNodeCount+1,imageCount:e.imageCount}}if("IMAGE"===t.type){let s=t.image?.length/750||0;return{figmaNodeLength:e.figmaNodeLength,imageTokens:e.imageTokens+s,figmaNodeCount:e.figmaNodeCount,imageCount:e.imageCount+1}}return e},{figmaNodeLength:0,imageTokens:0,figmaNodeCount:0,imageCount:0}),i=eC&&eE?(0,U.F)(eC,eE):void 0,l=e/3,c=s/3,o=(i?JSON.stringify(i).length:0)/3,x=l+c+o+a,d=x<=15e4;d!==eq.current&&(d||k.az.trackDefinedEvent("ai_for_production.code_chat_client_side_context_limit_exceeded",{total_number_of_tokens_estimate:x,image_tokens_estimate:a,figma_node_tokens_estimate:c,text_tokens_estimate:l,point_and_prompt_tokens_estimate:o,text_character_count:e,image_attachment_count:r,figma_node_attachment_count:n,direct_selection_count:eC?1:0,file_key:ep,persistent_entity_id:eg}),eq.current=d,eA(d))})()},[eg,ep,t,ef,eC,eE]),n.useEffect(()=>{eS||ez?.error.message===tk.T_.MAX_CONTENT_LENGTH_EXCEEDED?eS&&ez?.error.message===tk.T_.MAX_CONTENT_LENGTH_EXCEEDED&&eT():(0,g.kc)().bake_downgrade_figma_nodes_to_images&&eb?(ew({error:Error(tk.T_.MAX_CONTEXT_LENGTH_EXCEEDED_IMAGE_FALLBACK)}),eN()):ew({error:Error(tk.T_.MAX_CONTENT_LENGTH_EXCEEDED)})},[eS,ez,ew,eT,eb,eN]);let{communityAttribution:eI}=(0,tz.Pe)(),eO=(0,W.Oc)(),eM=(0,z.Tv)(),eF=async({message:e,errors:t,hidden:s,isUserInput:a=!1})=>{if(!et&&!eL&&(e||s))try{eT();let n=function(e,t,s){let a=(0,a7.UN)(),n=[],r=e.filter(e=>"success"===e.status&&"FIGMA_NODE"===e.type).map(e=>{let n=e.codeFiles.map(e=>{let t=a.get(e.codeFileGuid);return t?(p.l7.ai("set-code-file-path",()=>{let e=(0,g.kc)().multi_file_code_layers||(0,g.kc)().bake_canvas;t.codeFilePath=e&&s?`${s}/${a3.zM}`:a3.zM,t.isEntrypointCodeFile=!1}),{fullFilePath:t.codeFileFullPathWithoutScheme,code:t.sourceCode,codeFileGuid:t.guid}):(console.error("codeFileNode not found",{codeFileAttachment:e}),null)}).filter(e=>!!e);return{type:"node",guid:e.nodeGuid,codeFiles:n,communityAttribution:t.get(e.nodeGuid),image:(0,g.kc)().bake_d2r_image?e.image??void 0:void 0}}),i=e.filter(e=>"success"===e.status&&"IMAGE"===e.type).map(e=>({type:"image",guid:e.nodeGuid,image:e.image,imageHash:(0,g.kc)().bake_image_include_hash?e.imageHash??void 0:void 0}));return n.push(...r),n.push(...i),n}(ef,eI,X);(0,g.kc)().make_import_improvements_experimental&&function(e){let t;e.forEach(e=>{"node"===e.type&&e.codeFiles&&e.codeFiles.forEach(e=>{if(void 0===e.code)return;let s=e.code,a=!1;if(s=s.replace(/^(?!export\s)(async\s+)?function\s+(\w+)/gm,e=>(a=!0,`export ${e}`)),a&&e.fullFilePath){let t=(0,l._J)(e.fullFilePath);t&&t.sourceCode!==s&&p.l7.ai("export-functions",()=>{t.sourceCode=s})}let n=e.code.match(/export\s+default\s+function\s+(\w+)/);n&&n[1]&&!t&&(t={functionName:n[1],filePath:e.fullFilePath})})});let s=H&&H.length>0;if(t&&ea&&!s){let e=t.filePath.replace(/^\//,"").replace(/\.tsx?$/,""),s=`import ${t.functionName} from "./${e}";

export default function App() {
  return <${t.functionName} />;
}`,a=(0,l._J)("/App.tsx");a&&p.l7.ai("update-app-tsx",()=>{a.sourceCode=s}),en(!0)}}(n),ej();let r=eC&&eE?(0,U.F)(eC,eE):void 0,c=ec?.libraries?ec.libraries.map(e=>e.library_key):void 0,o={plainText:e,libraryKey:c&&c.length>0?c[0]:void 0,libraryKeys:c,imports:n,inspectedElement:r,errors:t,hidden:s,selectedNodeIds:eM},d=(0,nO.u)(e||"",n,eC?.elementAndParentSources);if(await x(o,d),ec?.libraries&&ec.libraries.length>0&&ec.libraries[0]?.library_key){let e=ec.libraries.map(e=>e.library_key),t={fileKey:ep||"",libraryKey:ec.libraries[0].library_key,library_keys:e.join(",")};(0,g.kc)().bake_ds_import_l3a?(0,I.ZR)(ec.libraries[0].library_key).then(e=>{k.az.trackDefinedEvent("ds_import.library_used_in_generation",{...t,includeComponents:e.data.meta.has_generated_components})}):k.az.trackDefinedEvent("ds_import.library_used_in_generation",{...t})}em("success"),(0,g.kc)().bake_sprig&&b===i.lV.FIGMAKE&&a&&el>=2&&ei("track","bake_survey_1_3_chats_sent")}catch(e){em("error",e instanceof Error?e.message:"Unknown error"),ew(e instanceof Error?{error:e}:{error:Error("Unknown error")})}},eD=(0,v.F)(eF);(0,n.useEffect)(()=>{let e=()=>{eD.current({message:f.zl.get((0,F.mC)(t)),isUserInput:!0})};return G.Uy.on("submit",e),()=>{G.Uy.removeListener("submit",e)}},[eD,t]),(0,nn.G)({enabled:b===i.lV.FIGMAKE&&!!eh?.canEdit,chatMessagesNodeGuid:t,setInput:e,sendMessage:eF});let eR=(0,L.KP)(),eP=void 0!==eo&&eo.messages.length>0,eU=(0,R.Wn)(t);!function({chatMessagesNodeGuid:e,featureType:t}){let{exchange:s,user:a}=(0,F.$W)(e),r=void 0!==s&&s.messages.length>0,l=(0,A.tS)(),c=(0,sr.iZ)();n.useEffect(()=>{if(!r||!l||a?.userID!==c?.id)return;let e=e=>{let a;e.preventDefault(),e.returnValue=!0;let n=s.messages[0];n&&n.type===h.K$p.USER_MESSAGE&&(a=(0,i.MK)(n.textContent).requestUuid),k.az.trackDefinedEvent("ai_for_production.unsaved_changes_warning_shown",{fileKey:l,featureType:t,requestUuid:a,userMessageId:n?.id})};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[r,l,t,s?.messages,a?.userID,c?.id])}({chatMessagesNodeGuid:t,featureType:b});let eG=(0,V.g7)(),{enhancePrompt:e$,isEnhancing:eH}=function(e){let[t,s]=(0,n.useState)(!1),{setChatError:a,clearChatError:r}=(0,tk.tk)(e);return{enhancePrompt:(0,n.useCallback)(async function*(e){let t;if(!e.trim())return e;s(!0),r();try{t=(await sj.Ay.shared.figmakeEnhancePrompt({prompt:e},{...(0,e_.Ay)()})).getReader();let s="";for(;;){let{done:e,value:a}=await t.read();if(e)break;s+=a.delta,yield s}return s}catch(t){let e=t instanceof Error?t:Error("Failed to enhance prompt");throw a({error:Error(tk.T_.PROMPT_ENHANCEMENT_FAILED)}),e}finally{t?.releaseLock(),s(!1)}},[a,r]),isEnhancing:t}}(t),eB=!eP&&ev&&!eU&&(eS||!es)&&!eH&&!eL,eV=H?.length?(0,w.t)("living_designs.chat.placeholder.iterate"):(0,w.t)("living_designs.chat.placeholder.blank_slate"),[eW,eK]=n.useState(!1),eY=async e=>{if(et||eL||!_||!C||0===e.files.length||e.files.length>tj.qQ)return;let t=Array.from(e.files).filter(e=>e&&q.xp.some(t=>e.type.startsWith(t.replace("*",""))));if(ef.filter(e=>"error"!==e.status).length+t.length>tj.qQ){(0,tj.hH)(h.FDn.MAXIMUM_ATTACHMENTS_EXCEEDED),eK(!1);return}let s=t.map(async e=>{await (0,nI.z)(e,ek)});await Promise.all(s),eK(!1)};return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf xh8yej3 x5yr21d",ref:eu,children:[(0,a.jsxs)("div",{className:"x1n2onr6 xh8yej3 x5yr21d x78zum5 xdt5ytf",children:[j&&(0,a.jsx)(se,{showAiBetaBadge:b!==i.lV.FIGMAKE}),(0,a.jsx)(aJ,{chatMessagesNodeGuid:t,clientLifecycleIdMap:K,codeFileChanges:o,dragOverlay:eW?(0,a.jsx)(nt,{}):void 0,emptyState:d,exchangeMessageIds:r,featureType:b,isResizingPanel:M,layerDisplayName:c,messagesForRendering:H,showCodeStreaming:Y}),(0,a.jsx)(a9,{typingUsers:Q}),(0,a.jsx)("div",{className:"x10l6tqk xu96u03 x3m8u43 x1vqgdyp x47corl x1ey2m1c xdu2321"})]}),ee?null:(0,a.jsx)(E.Y,{isDragTarget:()=>C,onTargetDragEnter:()=>eK(!0),onTargetDragLeave:()=>eK(!1),onTargetDrop:eY,children:(0,a.jsx)(t7,{ref:ed,canCancelGeneration:ex?.sessionID===eR,canSend:eB&&!u,chatBoxLeftExtraContent:(0,a.jsx)(nF,{attachments:ef,chatMessagesNodeGuid:t,codeInstanceGuid:s,createLoadedAttachment:ek,enableAssetImport:m,enableDsImport:T,enableImageAttachment:_,enhancePrompt:e$,generationInProgress:eP,hasMessages:H.length>0,isEnhancing:eH,isViewOnly:et,libraryImport:ec}),chatBoxRightExtraContent:y,chatContainerRef:eu,chatMessageCount:H.length,chatMessagesNodeGuid:t,errorFixingDisabled:eP,featureType:b,generationInProgress:eP,inspectedElement:eC,isDraggingAttachment:eW,isLastUserMessageAutoErrorFix:$,onFocus:J,placeholderText:eV,sendMessage:({message:e,errors:s})=>eF({message:e??f.zl.get((0,F.mC)(t)),errors:s,isUserInput:!0}),showPasteDesignsCallout:eO&&m&&!et&&!eL&&0===H.length&&0===ef.length&&!eG})})]})}},760697:(e,t,s)=>{s.d(t,{H:()=>j});var a=s(104076),n=s(716976),r=s(929302),i=s(91478),l=s(268389),c=s(170627),o=s(980852),x=s(795033),d=s(192075),u=s(959834),m=s(946847),h=s(233420),p=s(798811),g=s(38119),f=s(266230),_=s(157067),y=s(35552);let j=(0,u.Ju)(function(e){let t=r.hS({open:e.open,onClose:e.onClose}),[,s]=(0,x.fp)(h.YH);n.useEffect(()=>{let e={name:m.Sn.CHAT_ASSET_SEARCH,module:(0,a.jsx)(g.z6,{})};return s(t=>[e,...t]),()=>{s(e=>e.slice(1))}},[s]);let{claimAPendingAttachmentOrMakeOne:u,setAttachments:j}=(0,f._9)(e.chatMessagesNodeGuid||""),{addCommunityAttribution:k}=(0,_.Pe)(),v=n.useCallback((e,t,s)=>{let a=(0,o.UN)(),n=e[0];if(!n)return;let r=a.get(n);if(!r)return;let i=a.getInternalCanvas();i&&(c.Hq.system("figmake-inserted-component",()=>{i.appendChild(r)}),(0,y.E)(n,a,j,()=>{},()=>{},u))},[j,u]),b=n.useCallback((e,t)=>{k(t,{hubFileId:e.hub_file_id.toString(),creatorName:e.editor_name,hubFileName:e.file_name})},[k]);return(0,a.jsx)(i.bL,{manager:t,width:"fit-content",children:(0,a.jsxs)(l.vo,{children:[(0,a.jsx)(l.Y9,{children:(0,a.jsx)(l.hE,{children:(0,d.t)("sites.panel.make.attach_design")})}),(0,a.jsx)(l.nB,{padding:0,children:(0,a.jsx)(p.s3,{name:m.Sn.CHAT_ASSET_SEARCH,recordingKey:"chatAssetSearch",children:(0,a.jsx)(g.z6,{isFigmake:!0,isVisualSearch:!1,closeOnEscape:!0,assetInsertionCallback:v,hubFileFragmentInsertionCallback:b,keyboardNavigationProviderOptions:{syncRealFocusToFauxFocus:!0}})})})]})})},"ChatAssetSearchModal",u.ZU.YES)},329965:(e,t,s)=>{s.d(t,{u:()=>J});var a=s(104076),n=s(716976),r=s(903927),i=s(542653),l=s(88314),c=s(878604),o=s(268389),x=s(4921),d=s(293422),u=s(695777),m=s(444816),h=s(719423),p=s(73795),g=s(812714),f=s(795033),_=s(120440),y=s(883765),j=s(653899),k=s(848561),v=s(259161),b=s(192075),N=s(366535),C=s(211862),E=s(624155),w=s(959834),z=s(288054),T=s(782307),S=s(634491),A=s(183379),L=s(7659),q=s(431810),I=s(423390),O=s(636609),M=s(810149),F=s(533144),D=s(707490),R=s(631571),P=s(929302),U=s(91478),G=s(282794),$=s(250019);let H=(0,w.Ju)(function(e){let t=P.hS({open:e.open,onClose:e.onClose}),{library:s,onClose:i}=e,l=(0,r.wA)(),{createLibraryImport:c}=(0,$.S1)(),x=(0,C.tS)();(0,j.h)(()=>{y.az.trackDefinedEvent("ds_import.library_warning_modal_shown",{library_key:s.library_key,file_key:x||""})});let u=n.useCallback(()=>{y.az.trackDefinedEvent("ds_import.library_warning_modal_continue_clicked",{library_key:s.library_key,file_key:x||""}),c(s),l((0,N.AS)()),i()},[c,l,s,i,x]);return(0,a.jsx)(U.bL,{manager:t,width:"lg",height:"fixed",children:(0,a.jsxs)(o.vo,{children:[(0,a.jsx)(o.Y9,{children:(0,a.jsx)(o.hE,{children:(0,b.t)("figmake.ds_imports.library_selector_warning_modal.title")})}),(0,a.jsx)(o.nB,{children:(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl x1xmf6yo x1e56ztr",children:[(0,a.jsxs)("div",{className:"x78zum5 xou54vl x6s0dn4",children:[(0,a.jsx)(G.D,{thumbnailUrl:s.thumbnail_url,coverThumbnail:!0,name:s.library_name}),(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1jnr06f",children:[(0,a.jsx)("span",{className:"x17hqfcz xemv814 x1ma9mv9",children:s.library_name}),(0,a.jsx)("span",{className:"x1n0bwc9 xclx6tv x17akokd x1qxcl5b",children:s.team_name})]})]}),(0,a.jsx)("p",{children:(0,b.t)("figmake.ds_imports.library_selector_warning_modal.body")})]})}),(0,a.jsx)(o.wi,{children:(0,a.jsx)(o.jk,{children:(0,a.jsx)(d.$n,{onClick:u,children:(0,b.t)("figmake.ds_imports.library_selector_warning_modal.continue")})})})]})})},"ChatLibrarySelectorWarningModal");var B=s(854095);let V={textSecondary:{kMwMTN:"x1n0bwc9",$$css:!0}};function W({closeModal:e,hasExistingChatMessages:t}){let{allDsImportReadyLibraries:s,allDsImportReadyLibrariesRequestStatus:n}=(0,$.Bo)();return"loading"===n||s?.length?(0,a.jsx)(O.$,{className:"x1y1aw1k xjkvuk6 xh8yej3 x78zum5 xdt5ytf x167g77z",children:(0,a.jsx)(I.S,{children:(0,a.jsx)(K,{closeModal:e,hasExistingChatMessages:t})})}):(0,a.jsx)(X,{})}function K({closeModal:e,hasExistingChatMessages:t}){let{allDsImportReadyLibraries:s,allDsImportReadyLibrariesRequestStatus:r}=(0,$.Bo)(),i=(0,T.z)(),{libraryImport:c}=(0,$.S1)(),o=n.useMemo(()=>i(s||[]),[s,i]),x=n.useMemo(()=>new Set(c?.libraries.map(e=>e.library_key)||[]),[c?.libraries]);return"loading"===r?(0,a.jsx)(a.Fragment,{children:(0,l.y1)(3).map(e=>(0,a.jsx)(q.Q,{},e))}):0===o.length?null:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"x1qh3cfz xexx8yu xy13l1i x18d9i69 x163pfp",children:(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1cy8zhl x1jnr06f xc7ga6q x1sxf85j x1qh3cfz x1b06okx xcr9a89",children:[(0,a.jsx)("div",{..._.Ay.props(p.g.textBodyMediumStrong),children:(0,b.t)("sites.modal.select_library_banner_title")}),(0,a.jsxs)("div",{..._.Ay.props(p.g.textBodyMedium,V.textSecondary),children:[(0,b.t)("sites.modal.select_library_banner_subtitle"),"\xa0",(0,a.jsx)(v.Ph,{href:B.kC,newTab:!0,children:(0,b.t)("sites.modal.learn_more")})]})]})}),(0,a.jsx)(S.Tp,{entrypoint:z.r6.FIGMAKE,initialTab:void 0,initialUpdatesModalScope:E.aD.CURRENT,children:(0,a.jsx)(k.dP,{children:o.map((s,n)=>{let r=x.has(s.library_key);return(0,a.jsx)(Y,{library:s,index:n,isSelected:r,hasExistingChatMessages:t,closeModal:e},`LibraryListItem-${n}`)})})})]})}function Y({library:e,index:t,isSelected:s,hasExistingChatMessages:n,closeModal:i}){let l=(0,r.wA)(),c=(0,C.tS)(),{toggleLibrarySelection:o,createLibraryImport:d,isLibraryTogglePending:h}=(0,$.S1)(),p=(0,g.kc)().bake_ds_import_multi_library_support,f=h(e.library_key);return p?(0,a.jsx)(L.V,{header:e.library_name,subheader:e.team_name,thumbnailUrl:e.thumbnail_url,coverThumbnail:!0,callToAction:(0,a.jsx)(x.f,{checked:s,onIcon:(0,a.jsx)(u.f,{}),offIcon:(0,a.jsx)(m.c,{}),"aria-label":`Toggle ${e.library_name} selection`,disabled:f,onChange:()=>{f||(!n||s||p?o(e):(i(),l(N.to({type:H,data:{library:e}}))))},size:"md",variant:"primary"}),name:e.library_name,onClick:void 0,kbPath:[A.m3.TabBodySection.Body,t]},`LibraryListItem-${t}`):(0,a.jsx)(L.V,{header:e.library_name,subheader:e.team_name,thumbnailUrl:e.thumbnail_url,coverThumbnail:!0,callToAction:void 0,name:e.library_name,onClick:()=>{f||(y.az.trackDefinedEvent("ds_import.library_selector_overlay_library_selected",{library_key:e.library_key,file_key:c||""}),n&&!p?(i(),l(N.to({type:H,data:{library:e}}))):(d(e),i()))},kbPath:[A.m3.TabBodySection.Body,t]},`LibraryListItem-${t}`)}function X(){let e=(0,f.Xr)(D.jx),t=(0,f.md)(R.FX),s=(0,C.tS)();return(0,j.h)(()=>{y.az.trackDefinedEvent("ds_import.library_selector_empty_state_seen",{file_key:s||""})}),(0,a.jsx)("div",{className:"x9f619 x167g77z xh8yej3 x5yr21d x78zum5 x6s0dn4 xl56j7k xwib8y2",children:(0,a.jsxs)("div",{className:"xhwf2h4 x167g77z x78zum5 xdt5ytf x6s0dn4 xl56j7k x2b8uid",children:[(0,a.jsx)(h.l,{}),(0,a.jsx)("div",{..._.Ay.props(p.g.textBodyMediumStrong),children:(0,b.t)("sites.modal.no_libraries_found")}),(0,a.jsxs)("div",{..._.Ay.props(p.g.textBodyMedium,V.textSecondary),children:[(0,b.t)("sites.modal.select_library_banner_subtitle"),"\xa0",(0,a.jsx)(v.Ph,{href:B.kC,newTab:!0,children:(0,b.t)("sites.modal.learn_more")})]}),!t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np xl56j7k x2b8uid x6s0dn4",children:[(0,a.jsx)("div",{className:"x1dmp6jm xqtp20y xmkeg23 x1y0btm7 x7z60cl"}),"\xa0",(0,a.jsx)("div",{..._.Ay.props(p.g.textBodyMedium,V.textSecondary),children:(0,b.t)("sites.modal.or")}),"\xa0",(0,a.jsx)("div",{className:"x1dmp6jm xqtp20y xmkeg23 x1y0btm7 x7z60cl"})]}),(0,a.jsx)("div",{..._.Ay.props(p.g.textBodyMedium,V.textSecondary),children:(0,b.t)("sites.modal.add_guidelines_text")}),(0,a.jsx)(d.$n,{variant:"primary",onClick:()=>{y.az.trackDefinedEvent("ds_import.library_selector_empty_state_guidelines_clicked",{file_key:s||""});let t=(0,i.$d)(),a=t[B.dY]||t[B.x1]||null;a&&((0,F.Zr)(a),e(D.Ic.CODE),a.codeFilePath&&(0,M.ci)(a.codeFilePath))},children:(0,b.t)("sites.modal.add_guidelines_button_text")})]})]})})}let J=(0,w.Ju)(function(e){let{defaultPosition:t,onCloseCallback:s,hasExistingChatMessages:i}=e,l=(0,r.wA)(),x=n.useCallback(()=>{s(),l((0,N.AS)())},[l,s]);return(0,a.jsx)(c.bL,{defaultPosition:t,width:332,maxHeight:336,onClose:x,children:(0,a.jsxs)(o.vo,{children:[(0,a.jsx)(o.Y9,{children:(0,a.jsx)(o.hE,{children:(0,b.t)("sites.modal.select_library")})}),(0,a.jsx)(o.nB,{padding:0,children:(0,a.jsx)("div",{className:"x78zum5 xdt5ytf xou54vl x2ozue6 xh8yej3 x9f619",children:(0,a.jsx)(W,{closeModal:x,hasExistingChatMessages:i})})})]})})},"ChatLibrarySelectorOverlay",w.ZU.YES)},822695:(e,t,s)=>{s.d(t,{D:()=>_});var a=s(104076),n=s(716976),r=s(903927),i=s(307829),l=s(420680);let c=(0,n.memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M13.5 5A2.5 2.5 0 0 1 16 7.5c0 .82-.397 1.544-1.006 2a2.5 2.5 0 0 1 1.006 2 2.5 2.5 0 0 1-2.5 2.5 2.5 2.5 0 0 1-1.5-.504V15.5a2.5 2.5 0 0 1-5 0c0-.82.396-1.544 1.005-2a2.493 2.493 0 0 1 0-4A2.5 2.5 0 0 1 7 7.5 2.5 2.5 0 0 1 9.5 5zm3.5 9a.5.5 0 0 1 .5.5v1h1a.5.5 0 0 1 0 1h-1v1a.5.5 0 0 1-1 0v-1h-1a.5.5 0 0 1 0-1h1v-1a.5.5 0 0 1 .5-.5m-7.5 0a1.5 1.5 0 1 0 1.5 1.5V14zm0-4a1.5 1.5 0 0 0 0 3H11v-3zm4 0a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3m-4-4a1.5 1.5 0 1 0 0 3H11V6zM12 9h1.5a1.5 1.5 0 0 0 0-3H12z"})})});var o=s(870611),x=s(803126);s(120440);var d=s(192075),u=s(366535),m=s(298056),h=s(789596),p=s(760697),g=s(266230),f=s(915242);function _({enableAssetImport:e,enableImageAttachment:t,attachments:s,isViewOnly:_,chatMessagesNodeGuid:y,createLoadedAttachment:j,toggleComponent:k}){let v=(0,r.wA)(),b=n.useRef(null),{getTriggerProps:N,manager:C}=i.b(),E=n.useCallback(async e=>{let t=e.target.files?.[0];t&&(await (0,f.z)(t,j),b.current&&(b.current.value=""))},[j]),w=e?(0,a.jsxs)(i.q7,{onClick:()=>{v(u.to({type:p.H,data:{chatMessagesNodeGuid:y}}))},disabled:_||s.length>=g.qQ,children:[(0,a.jsx)(i.Q$,{children:(0,a.jsx)(c,{})}),(0,a.jsx)("div",{className:"xifkd7f",children:s.length>=g.qQ?(0,d.t)("sites.panel.make.attach_limit_reached",{limit:g.qQ}):(0,d.t)("figmake.attachments.import_from_figma")})]}):null,z=t?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(i.q7,{disabled:_||s.length>=g.qQ,onClick:()=>{b.current?.click()},children:[(0,a.jsx)(i.Q$,{children:(0,a.jsx)(o.s,{})}),(0,a.jsx)("div",{className:"xifkd7f",children:s.length>=g.qQ?(0,d.t)("sites.panel.make.attach_limit_reached",{limit:g.qQ}):(0,d.t)("figmake.attachments.upload_image")})]})}):null;return t||e?(0,a.jsxs)(i.bL,{manager:C,children:[k?(0,a.jsx)(k,{...N(),disabled:_||s.length>=g.qQ}):(0,a.jsx)(l.K,{...N(),"aria-label":(0,d.t)("sites.panel.make.attach_design"),"data-tooltip-show-above":!0,"data-onboarding-key":h.wj,disabled:_||s.length>=g.qQ,children:(0,a.jsx)(x.e,{})}),t&&(0,a.jsx)("input",{type:"file",className:"x1s85apg",ref:b,accept:m.xp.join(","),onChange:E}),(0,a.jsxs)(i.mc,{children:[w,z]})]}):null}},622107:(e,t,s)=>{s.d(t,{$X:()=>F});var a=s(104076),n=s(65545),r=s(951002),i=s(651534),l=s(812714),c=s(190028),o=s(352630),x=s(259161),d=s(192075),u=s(502907),m=s(260745),h=s(217862),p=s(649693),g=s(20267),f=s(211862),_=s(944350),y=s(904017),j=s(382137),k=s(295253),v=s(590662),b=s(141330),N=s(764298),C=s(307858),E=s(700126),w=s(723339),z=s(127082),T=s(373224);let S="https://help.figma.com/hc/articles/31722591905559-Figma-Make-FAQs";function A(){let e=(0,y.No)(),t=e.unwrapOr(null)?.tier||null,s=(0,f.q5)(),r=(0,z.Oc)(),i=s?.teamId??"",c=(0,C.$Y)(i),x=r?k.b.FIGMAKE_METER_LIMIT_TOAST:k.b.LIVING_DESIGNS_METER_LIMIT_TOAST,u=(0,h.y)(i,x);return t===n.Agb.STARTER&&(0,l.kc)().bake_starter_limit&&c?(0,a.jsx)(o.$z,{variant:"primary",onClick:u,children:(0,d.tx)("figmake.meter_limit.view_plans")}):null}function L(){let{handleUpgrade:e,getIsUpgradeHandlerLoading:t}=(0,j.wH)({entryPoint:m.tc.CODE_CHAT_LIMIT,folderId:null}),s=(0,z.Oc)()?_.G_.FIGMAKE:_.G_.SITES;return t()?(0,a.jsx)(o.$z,{variant:"primary",disabled:!0,children:(0,d.tx)("figmake.meter_limit.request_upgrade")}):(0,a.jsx)(o.$z,{variant:"primary",onClick:e({licenseType:s,upgradeReason:T.i.CODE_CHAT_LIMIT,entryPoint:m.tc.CODE_CHAT_LIMIT}),children:(0,d.tx)("figmake.meter_limit.request_upgrade")})}function q(){let e=(0,z.Oc)()?b.JT.FIGMAKE:b.JT.LIVING_DESIGNS,{meterResetDate:t,meteringWindow:s}=(0,v.Ig)(e);if(!t)return{resetDate:null,formattedResetDate:null,meteringWindow:null};let a=(0,g.A0)(t);if(!a)return{resetDate:null,formattedResetDate:null,meteringWindow:null};let n=(0,c.A)(a).format("LL");return{resetDate:a,formattedResetDate:n,meteringWindow:s}}function I(){let{formattedResetDate:e,meteringWindow:t}=q();return e?t===v.co.DAILY?(0,d.tx)("figmake.meter_limit.plans_ai_credit_limit_reached_reset_imminent"):(0,d.tx)("figmake.meter_limit.plans_ai_credit_limit_reached",{resetDate:e}):null}function O(){let{formattedResetDate:e}=q();return e?(0,d.tx)("figmake.meter_limit.reached_your_current_credits_limit",{resetDate:e}):(0,d.tx)("figmake.meter_limit.primary")}function M(){let{resetDate:e}=q(),{getPlanAndPlanUser:t,getIsUpgradeHandlerLoading:s}=(0,j.wH)({entryPoint:m.tc.CODE_CHAT_LIMIT,folderId:null}),a=(0,z.Oc)()?_.G_.FIGMAKE:_.G_.SITES;if(!e||s())return null;let{planUser:n}=t(a);if(!n)return(0,d.tx)("figmake.meter_limit.seat_type_generic_credit_limit_reached",{resetDate:e});{let t=n.currentSeat?.billableProductKey??p.Gu.VIEW;return(0,d.tx)("figmake.meter_limit.seat_type_credit_limit_reached",{seatType:(0,u.JT)(t),resetDate:e})}}function F({testId:e,renderer:t}){let s=(0,E.l)(),n=(0,y.No)(),l=n.unwrapOr(null)?.tier||null,c=(0,w.Tk)(),o=c?.restriction,u=c?.meteringWindow;if(!o||o===w.ee.DISABLE_WITHOUT_TOAST)return null;let m=function(e){switch(e){case w.ee.UNAVAILABLE_ON_EDU_PLANS:return{title:(0,d.tx)("figmake.view_only.unavailable_on_edu")};case w.ee.UNAVAILABLE_FOR_EDU_USER:return{title:(0,d.tx)("figmake.view_only.you_dont_have_access",{learnMoreLink:(0,a.jsx)(x.Ph,{newTab:!0,trusted:!0,href:"https://help.figma.com/hc/articles/360041061214#faqs",children:(0,d.tx)("general.learn_more")})}),icon:(0,a.jsx)(i.t,{})};case w.ee.MAKE_UNAVAILABLE_ON_PLAN:return{title:(0,d.tx)("figmake.view_only.unavailable_on_plan",{learnMoreLink:(0,a.jsx)(x.Ph,{newTab:!0,trusted:!0,href:S,children:(0,d.tx)("general.learn_more")})}),icon:(0,a.jsx)(i.t,{})};case w.ee.MAKE_UNAVAILABLE_ON_SEAT:return{title:(0,d.tx)("figmake.view_only.unavailable_on_seat",{learnMoreLink:(0,a.jsx)(x.Ph,{newTab:!0,trusted:!0,href:S,children:(0,d.tx)("general.learn_more")})}),icon:(0,a.jsx)(i.t,{})};case w.ee.INTERIM_VIEW_ONLY_COMING_SOON:return{title:(0,d.tx)("figmake.view_only.coming_soon_title"),content:()=>(0,d.tx)("figmake.view_only.check_back_in_coming_weeks_learn_more",{learnMoreLink:(0,a.jsx)(x.Ph,{newTab:!0,trusted:!0,href:S,children:(0,d.tx)("general.learn_more")})}),icon:(0,a.jsx)(i.t,{})};case w.ee.VIEW_ONLY_ASK_TO_EDIT:return{title:void 0,content:()=>(0,d.tx)("figmake.view_only.banner_message"),button:(0,a.jsx)(N.RJ,{viewOnly:!0,variant:"primary"}),icon:null};case w.ee.METER_LIMIT:return{title:void 0,content:()=>(0,a.jsx)(O,{})};case w.ee.METER_LIMIT_UPGRADE_PLAN:return{content:()=>(0,a.jsx)(I,{}),button:(0,a.jsx)(A,{}),icon:null};case w.ee.METER_LIMIT_UPGRADE_SEAT:return{title:void 0,content:()=>(0,a.jsx)(M,{}),button:(0,a.jsx)(L,{}),icon:null};case w.ee.PLAN_AI_DISABLED:return{title:(0,d.tx)("living_designs.chat.disabled_reason.title.not_available"),content:()=>(0,d.tx)("living_designs.chat.disabled_reason.subtitle.ai_disabled_in_file")};case w.ee.DISABLE_CATCH_ALL:return{title:(0,d.tx)("living_designs.chat.disabled_reason.title.not_available")};case w.ee.DISABLE_WITHOUT_TOAST:return{title:null};default:(0,r.xb)(e)}}(o);return(0,a.jsx)(t,{testId:e,config:m,trackingProperties:{meteringWindow:u,codeChatRestriction:o,isViewOnly:s,tier:l}})}},792845:(e,t,s)=>{s.d(t,{t:()=>r});var a=s(104076),n=s(684742);function r({label:e,onClick:t,disabled:s}){return(0,a.jsx)(n.E,{...{0:{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x12ulsxz xdqyycr x9h44rk xmkeg23 x1y0btm7 x7z60cl x1n0bwc9 x1ypdohk xuk1p4z xp695gr xv2f06h"},1:{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x12ulsxz xdqyycr x9h44rk xmkeg23 x1y0btm7 x7z60cl xuk1p4z xge78cn x1h6gzvc"}}[!!s<<0],onClick:t,disabled:s,children:e})}s(120440)},540041:(e,t,s)=>{s.d(t,{Z:()=>p,d:()=>g});var a=s(104076),n=s(119636),r=s(795033);s(120440);var i=s(883765),l=s(192075),c=s(211862),o=s(723339),x=s(707242),d=s(789596),u=s(963433),m=s(107799),h=s(792845);let p=()=>[{key:x.El.SIGNUP_FLOW,title:(0,l.t)("living_designs.suggestions.signup_flow.title"),prompt:(0,l.t)("living_designs.suggestions.signup_flow.prompt")},{key:x.El.DASHBOARD,title:(0,l.t)("living_designs.suggestions.dashboard.title"),prompt:(0,l.t)("living_designs.suggestions.dashboard.prompt")},{key:x.El.GRADIENT_GALLERY,title:(0,l.t)("living_designs.suggestions.gradient_gallery.title"),prompt:(0,l.t)("living_designs.suggestions.gradient_gallery.prompt")}];function g({nodeGuid:e}){let t=(0,c.q5)(),s=(0,o.ry)(),x=(0,r.Xr)((0,m.mC)(e)),g=(0,u.Gu)(),f=(e,s)=>{i.az.trackDefinedEvent("figmake.empty_state_template_suggestion_clicked",{fileKey:t?.key??"",templateName:e}),x(s)};return!1===g?(0,a.jsxs)("div",{className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l x1h93xvk x78zum5 xdt5ytf x6s0dn4 x1v2ro7d x2b8uid x1rmx8ao",children:[(0,a.jsx)("div",{className:"x16rqkct x1v8gsql xe8ttls","aria-hidden":!0,children:(0,a.jsx)(n.e,{})}),(0,a.jsx)("h2",{children:(0,l.t)("living_designs.chat.empty_state.update_existing")})]}):(0,a.jsxs)("div",{className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l x1h93xvk x78zum5 xdt5ytf x6s0dn4 x1v2ro7d x2b8uid x1rmx8ao",children:[(0,a.jsx)("div",{className:"x16rqkct x1v8gsql xe8ttls","aria-hidden":!0,children:(0,a.jsx)(n.e,{})}),(0,a.jsx)("h2",{children:(0,l.t)("living_designs.chat.empty_state.from_scratch")}),(0,a.jsx)("div",{className:"xh8yej3 x78zum5 x1q0g3np x1a02dak x167g77z xl56j7k","data-onboarding-key":d.OU,children:p().map((e,t)=>(0,a.jsx)(h.t,{label:e.title,onClick:()=>f(e.key,e.prompt),disabled:s},t))})]})}},24441:(e,t,s)=>{s.d(t,{L:()=>r}),s(120440);var a=s(127082);let n={defaultTypography:{kLWn49:"xno9bf3",kGuDYH:"x17akokd",k63SB2:"x1yuz8eb",kb6lSQ:"xqp8s7e",$$css:!0},figmakeTypography:{kLWn49:"x1fc57z9",kGuDYH:"x1lh6uom",k63SB2:"x1yuz8eb",kb6lSQ:"xuf8qxk",$$css:!0},userMessageTypography:{kLWn49:"xno9bf3",kGuDYH:"x17akokd",k63SB2:"x1yuz8eb",kb6lSQ:"xqp8s7e",$$css:!0},figmakeUserMessageTypography:{kLWn49:"x17fgdl5",kGuDYH:"x1lh6uom",k63SB2:"x1yuz8eb",kb6lSQ:"xuf8qxk",$$css:!0},artifactTypography:{kMwMTN:"x1n0bwc9",kLWn49:"xno9bf3",kGuDYH:"x17akokd",k63SB2:"x1yuz8eb",kb6lSQ:"xqp8s7e",$$css:!0},figmakeArtifactTypography:{kMwMTN:"x1n0bwc9",kLWn49:"x1o2sk6j",kGuDYH:"x1lh6uom",k63SB2:"x1yuz8eb",kb6lSQ:"xuf8qxk",$$css:!0},artifactActiveTypography:{kMwMTN:"x1ptu4o3",kLWn49:"x14kxzw3",kGuDYH:"xiqqdae",k63SB2:"x6xwguf",kb6lSQ:"xqp8s7e",$$css:!0},figmakeArtifactActiveTypography:{kMwMTN:"x1ptu4o3",kLWn49:"x1o2sk6j",kGuDYH:"x1lh6uom",k63SB2:"x6xwguf",kb6lSQ:"xr8fz4w",$$css:!0}};function r(){let e=(0,a.Oc)(),t=e?n.figmakeUserMessageTypography:n.userMessageTypography,s=e?n.figmakeArtifactTypography:n.artifactTypography;return{userMessageTypographyStyle:t,artifactActiveTypographyStyle:e?n.figmakeArtifactActiveTypography:n.artifactActiveTypography,artifactTypographyStyle:s,defaultTypographyStyle:e?n.figmakeTypography:n.defaultTypography}}},699374:(e,t,s)=>{s.d(t,{S:()=>n});var a=s(716976);function n({textareaRef:e,maxHeight:t}){return(0,a.useCallback)(()=>{if(e&&"current"in e&&e.current){let s=e.current;s.style.height="auto";let a=window.getComputedStyle(s),n=parseFloat(a.paddingTop),r=parseFloat(a.paddingBottom),i=(parseFloat(a.lineHeight)-parseFloat(a.fontSize))/2,l=Math.min(s.scrollHeight-n-r-i-i,t);s.style.height=`${l}px`,s.style.overflowY=l>=t?"auto":"hidden"}},[t,e])}},250019:(e,t,s)=>{s.d(t,{Bo:()=>S,FN:()=>A,HL:()=>L,S1:()=>T});var a=s(716976),n=s(542653),r=s(673349),i=s(638004),l=s(266808),c=s(170627),o=s(926653),x=s(980852),d=s(812714),u=s(795033),m=s(550209),h=s(211862),p=s(985416),g=s(620720),f=s(963433),_=s(410915);let y=(0,p.Wh)(()=>(0,u.eU)(null)),j=(0,p.Wh)(()=>(0,u.eU)(null)),k=(0,p.Wh)(()=>(0,u.eU)(new Set)),v={library_type:"team",library_name:"Unknown",library_file_key:"",library_key:(0,o.l)(""),thumbnail_url:"",global_css:""},b={library_type:"team",library_name:"Loading...",library_file_key:"",library_key:(0,o.l)(""),thumbnail_url:"",global_css:""};function N(e,t,s,a){if("loaded"===s){let s=e.map(e=>t?.find(t=>t.library_key===e)).filter(e=>!!e);return s.length>0?{libraries:s,frozen:a}:{libraries:[v],frozen:a}}return"loading"===s||null===s?{libraries:[b],frozen:a}:{libraries:[v],frozen:a}}let C=e=>{(0,d.kc)().bake_ds_import_l3a&&c.l7.user("cleanup-library-code-files",()=>{let t=(0,n.$d)();Object.keys(t).forEach(s=>{let a=t[s];a?.sourceCodeLibraryKey===e&&l.glU?.deleteCodeFile(a.guid)})})},E=(e,t)=>{c.l7.user("remove-library-selection",()=>{e.sourceCodeLibraryKeys=e.sourceCodeLibraryKeys?.filter(e=>e!==t)||[]}),C(t)},w=e=>{if(!e.raw_text_styles)return;let t=JSON.parse(e.raw_text_styles||"[]");c.l7.ai("figmake custom fonts",()=>{t.forEach(e=>{e.fontFamily&&e.fontWeight&&L({fontFamily:e.fontFamily,styleName:e.fontWeight,postscript:e.postscript||""})})})},z=(e,t)=>{(0,d.kc)().bake_ds_import_l3a&&(0,g.OL)(e.library_key,t).then(t=>{t.forEach(t=>{let s=`components/${function(e){let t=e.trim();t=t.replace(/^\/+/,"");let s="",a="";for(let e=0;e<t.length;e++){let n=t[e];n&&(/[a-zA-Z0-9]/.test(n)?s+=n:"-"===n||"_"===n||" "===n?"-"!==a&&(s+="-"):"-"!==a&&s.length>0&&(s+="-"),a=n)}return(s=s.replace(/^[-_]+|[-_]+$/g,"")).split(/[-_]/).filter(e=>e.length>0).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join("")}(e.library_name)}/${t.asset_file_name}.tsx`,a=(0,n.$d)()[s];c.l7.user("create-new-code-file",()=>{if(a)a.sourceCode=t.interactive_code,a.sourceCodeLibraryKey=e.library_key;else{let n=x.UN()?.createNewCodeFile({path:s,sourceCode:t.interactive_code,entryPoint:null,isEntrypointCodeFile:!1,onError:e=>{m.$D(i.e.MAKE,e)},enableDuplicateCheck:d.kc().bake_dup_code_files});n&&(a=(0,x.UN)().get(n)||void 0)&&(a.sourceCodeComponentOrStateGroupKey=t.key,a.sourceCodeComponentOrStateGroupVersion=Number(t.version),a.sourceCodeLibraryKey=e.library_key)}})})})};function T(){let e=(0,h.tS)(),{codeLibraryInstance:t}=(0,f.oA)(),[s,i]=(0,u.fp)(k),o=(0,_.EI)(t),{allDsImportReadyLibraries:x,allDsImportReadyLibrariesRequestStatus:m}=S(),p=function(e){let{allDsImportReadyLibraries:t,allDsImportReadyLibrariesRequestStatus:s}=S();return a.useMemo(()=>{if(!e)return null;let a=[];return(e.forEach(e=>{if(e.type===l.K$p.USER_MESSAGE){let t=(0,r.MK)(e.textContent);t.libraryKey?a=[t.libraryKey]:t.libraryKeys}}),0===a.length)?null:N(a,t,s,!0)},[t,e,s])}(o),g=a.useMemo(()=>{if(t?.sourceCodeLibraryKeys&&t.sourceCodeLibraryKeys.length>0&&t.sourceCodeLibraryKeys[0]){let e=t.sourceCodeLibraryKeys.filter(e=>!!e);if(e.length>0)return N(e,x,m,!!p)}return p},[t,x,m,p]),y=a.useCallback(a=>{if(!t)return;let r=a.library_key;if(!s.has(r)){i(new Set([...s,r]));try{let s=t.sourceCodeLibraryKeys||[];if(s.includes(r))E(t,r);else if(c.l7.user("add-library-selection",()=>{t.sourceCodeLibraryKeys=[...s,r]}),w(a),z(a,e||""),!(0,d.kc)().bake_ds_import_multi_library_support&&0===s.length){let e=(0,n.$d)()["/styles/globals.css"];e&&(e.sourceCode=a.global_css)}}finally{setTimeout(()=>{i(e=>{let t=new Set(e);return t.delete(r),t})},100)}}},[e,t,s,i]);return{libraryImport:g,createLibraryImport:a.useCallback(e=>{if(!t)return;let a=e.library_key;s.has(a)||((t.sourceCodeLibraryKeys||[]).forEach(s=>{s!==e.library_key&&E(t,s)}),y(e))},[t,y,s]),toggleLibrarySelection:y,isLibraryTogglePending:a.useCallback(e=>s.has(e),[s])}}function S(){let[e,t]=(0,u.fp)(y),[s,n]=(0,u.fp)(j);return a.useEffect(()=>{null===s&&(n("loading"),(0,g.N6)().then(e=>{t(e.data.meta),n("loaded")}).catch(e=>{n("error")}))},[s,n,t]),{allDsImportReadyLibraries:e,allDsImportReadyLibrariesRequestStatus:s}}function A(e){let t=e?.libraries||[],s=t.map(e=>e?.library_key).filter(Boolean).join(",");return{library_key:1===t.length&&t[0]?.library_key||"",library_keys:s}}function L(e){let t=l.t8O?.getLocalTextStyleFontInfo();if(t&&t.find(t=>t.family===e.fontFamily&&t.style===e.styleName))return;let s=(0,x.UN)().createStyle("TEXT");s.fontName={family:e.fontFamily,style:e.styleName,postscript:e.postscript},s.name=`${e.fontFamily}: ${e.styleName}`}},174026:(e,t,s)=>{s.d(t,{q:()=>o});var a=s(716976),n=s(651234),r=s(795033),i=s(883765),l=s(819851);let c=(0,s(252285).H)({});function o(e,t,s,o,x){let[d,u]=(0,r.fp)(c(x)),m=`${x||"unknown"}-${o}`,h=d[m]||{selectedFeedback:null,shouldShowAdditionalFeedback:!1},p=a.useCallback(e=>{u({...d,[m]:e})},[u,d,m]),{persistentEntityId:g,clientLifecycleId:f}=e,_=(0,l.ow)(),y=s===n.lV.FIGMAKE?"figmake":s===n.lV.CODE_IN_SITES?"sites":_?"figjam":"design",j=a.useCallback((e,a,n)=>{f&&i.az.trackDefinedEvent("ai_for_production.chat_feedback",{feedbackType:e,productType:y,feedback:a,messageId:n,fileKey:t||void 0,featureType:s,persistentEntityId:g,clientLifecycleId:f})},[t,s,f,g,y]);return{feedbackState:h,setFeedbackState:p,sentimentFeedbackCallback:a.useCallback((e,t)=>{j(e.toString(),t,o)},[j,o]),additionalFeedbackCallback:a.useCallback((e,t)=>{j(e.toString(),t,o)},[j,o]),productType:y}}},35552:(e,t,s)=>{s.d(t,{E:()=>k,p:()=>v});var a=s(716976),n=s(500275),r=s(266808),i=s(170627),l=s(681958),c=s(980852),o=s(795033),x=s(883765),d=s(328341),u=s(260495),m=s(74620),h=s(211862),p=s(331497),g=s(719947),f=s(482911),_=s(266230),y=s(250019);async function j(e,t){let s;let a=(0,f.I8)(e);if(i.l7.ai("figmake custom fonts",()=>{a.forEach(e=>{e.fontFamily&&e.fontWeight&&(0,y.HL)({fontFamily:e.fontFamily,styleName:e.fontWeight,postscript:e.postscript||""})})}),i.l7.ai("figmake",()=>{let t=e.createCodeLayerFromDesign("paste",!0,n.n0);if(1!==t.length)throw Error("Expected exactly one code layer to be created");s=t[0]}),s)await (0,u.Jr)().loadAllImagesUnder(s,r.MoD.ALL,"rev-image-paste");else{let s=o.zl.get(_.Ah).find(t=>(0,_.ak)(t,e.guid));t(t=>t.filter(t=>!(0,_.ak)(t,e.guid))),i.Hq.system("figmake",()=>{let t=(0,c.UN)().get(e.guid);t&&t.removeSelfAndChildren()});let a=s?.designToCodeErrors;a&&a[0]?(0,_.hH)(a[0]):(0,_.hH)(r.FDn.DESIGN_2_REACT_OTHER)}}async function k(e,t,s,a,n,c){if(!e)return;let d=t.get(e);if(!d)return;let u=(0,g.A)(d)?"IMAGE":"FIGMA_NODE";if("FIGMA_NODE"===u&&"TEXT"===d.type){a(d.characters),i.l7.system("clean-up-chat-box-pasted-text-node",()=>{d.removeSelfAndChildren()}),s(e=>{let t=e.find(e=>"pending"===e.status);return t?e.filter(e=>e.uniqueId!==t.uniqueId):e});return}let m=c(e);try{if("FIGMA_NODE"===u){let t,a,r;let{count:i,instanceCount:c}=(t=0,a=0,r=0,(0,l.hV)(d,e=>{t++;try{e?.isInstance&&a++}catch(e){r++}}),{count:t,instanceCount:a,couldNotCount:r});n(e,i,c),await j(d,s)}else!function(e,t,s){let a=(0,_.NC)(e),n=(0,_.Zz)(e);if(r.glU?.addImageNodeAsImageImport(e.id),a){let r={status:"success",nodeGuid:e.guid,image:a,imageHash:n,type:"IMAGE",uniqueId:t};s(t=>t.map(t=>(0,_.ak)(t,e.guid)?r:t))}}(d,m,s);x.az.trackDefinedEvent("ai_for_production.chat_attachment_added",{attachmentType:u,fileKey:o.zl.get(h.yV)?.key??void 0})}catch(t){s(t=>t.map(t=>(0,_.ak)(t,e)?{...t,status:"error"}:t))}}function v(e,t,s){let n=(0,m.eY)(),i=r.Ez5?.figmakeState(),l=(0,p.ut)(i?.pastedNodeGuid,null),c=(0,d.ZC)(l),{attachments:o,setAttachments:x,claimAPendingAttachmentOrMakeOne:u}=(0,_._9)(e);a.useEffect(()=>{l!==c&&k(l,n,x,t,s,u)},[n,x,c,o,l,t,u,s])}},537665:(e,t,s)=>{s.d(t,{OL:()=>F});var a=s(716976),n=s(903927),r=s(130249),i=s(651234),l=s(614641),c=s(882931),o=s(500275),x=s(542653),d=s(951002),u=s(638004),m=s(266808),h=s(170627),p=s(980852),g=s(812714),f=s(795033),_=s(883765),y=s(550209),j=s(432099),k=s(192075),v=s(58212),b=s(638641),N=s(354114),C=s(211862),E=s(592726),w=s(252285),z=s(107799),T=s(635533),S=s(234429),A=s(923669),L=s(329232),q=s(836543),I=(e=>(e.FAILED_TO_RETRIEVE_CODE_FILES="FAILED_TO_RETRIEVE_CODE_FILES",e))(I||{});class O extends Error{constructor(e,t,s){super(t),this.type=e,this.status=s,this.name="RestoreVersionError"}}let M=(0,w.q)();function F({codeSnapshotKey:e,chatMessagesNodeGuid:t,featureType:s,persistentEntityId:r,clientLifecycleId:i,restoreToVersionTitle:l}){let c=(0,E.iZ)(),o=(0,C.q5)(),x=o?.key||null,d=(0,n.wA)(),[u,m]=(0,f.fp)(M(t)),h=(0,q.A)();return{restoreVersion:a.useMemo(()=>{if(x&&e&&c&&t&&o?.canEdit)return async()=>{if(u){d(v.F.enqueue({message:(0,k.t)("figmake.chat.version_restore_in_progress")}));return}try{m(!0),d(v.F.enqueue({message:(0,k.t)("figmake.chat.a11y_restoring_a_previous_version"),role:"status"}));let a=(0,p.UN)().get(t);if(!a)throw Error(`Chat messages node not found: ${t}`);await D({fileKey:x,codeSnapshotKey:e,user:c,featureType:s,chatMessagesNode:a,restoreToVersionTitle:l}),h({showVisualBells:!1}),_.az.trackDefinedEvent("ai_for_production.version_restore_clicked",{success:!0,codeSnapshotKey:e,fileKey:x,featureType:s,persistentEntityId:r,clientLifecycleId:i}),d(v.F.enqueue({message:(0,k.t)("figmake.chat.a11y_restoring_version_completed"),role:"status"}))}catch(a){let t=a instanceof O?a.type:"";_.az.trackDefinedEvent("ai_for_production.version_restore_clicked",{success:!1,errorType:t,errorMessage:a.message,codeSnapshotKey:e,fileKey:x,featureType:s,persistentEntityId:r,clientLifecycleId:i}),a instanceof O&&"FAILED_TO_RETRIEVE_CODE_FILES"===a.type&&409===a.status?d(v.F.enqueue({message:(0,k.t)("figmake.chat.version_restore_try_again_soon"),icon:b.zX.EXCLAMATION})):d(v.F.enqueue({message:(0,k.t)("figmake.chat.version_restore_failed"),error:!0}))}finally{m(!1)}}},[x,e,c,t,o?.canEdit,s,r,i,d,u,m,l,h])}}async function D({fileKey:e,codeSnapshotKey:t,user:s,featureType:a,chatMessagesNode:n,restoreToVersionTitle:p}){let _;try{_=await (0,A.l)({fileKey:e,codeSnapshotKey:t})}catch(t){let e=t instanceof j.Dr?t.status:void 0;throw new O("FAILED_TO_RETRIEVE_CODE_FILES",t.message,e)}let k=(0,l.Pq)(a,n,{multi_file_code_layers:(0,g.kc)().multi_file_code_layers,bake_canvas:(0,g.kc)().bake_canvas}),v=a===i.lV.FIGMAKE,b=((0,g.kc)().multi_file_code_layers||(0,g.kc)().bake_canvas)&&n.codeFilePath,C=(0,S.Zi)(s,{codeSnapshotKey:t},p),E=v?(0,x.qx)():b?(0,x.qx)(k):(0,x.qx)(),w=Object.fromEntries(E.map(e=>[e.codeFileFullPathWithoutScheme,e]));h.Hq.ai("restore-version",()=>{(0,d.vA)(void 0!==m.glU,"Fullscreen must be defined");let e=e=>{let t=L.O.get(e.guid);t&&(t.hasSystemEdited=!0)};if(v||b){let{entrypointFilePath:t}=function(e,t){let s;let a=[];for(let n of e)!function(e,t){switch(t){case i.lV.FIGMAKE:return"/App.tsx"===e.codeFileFullPathWithoutScheme;case i.lV.CODE_IN_SITES:case i.lV.FIGMAKE_IN_DESIGN:return e.isEntrypointCodeFile;default:return!1}}(n,t)?(n.codeFilePath=`${o.GX}${n.codeFileFullPathWithoutScheme}`,a.push(n)):s=n;return(0,l.zK)(a),{entrypointFilePath:s?.codeFileFullPathWithoutScheme}}(E,a),s=Object.fromEntries((0,x.qx)(k).map(e=>[e.codeFileFullPathWithoutScheme,e])),c=Object.entries(_),d=c[0],m=t?(0,r.F$)(k,t):void 0,h=1===c.length&&d&&t&&d[0]!==m;for(let[t,a]of c){let i=h&&m?m:(0,r.F$)(k,t),{codeFile:c}=(0,l.Ur)(s,k,i,a,{trackSystemEditedSession:e,reportErrorToSentry:e=>{(0,y.$D)(u.e.MAKE,e)},enableDuplicateCheck:(0,g.kc)().bake_dup_code_files});c&&(c.sourceCode=a,f.zl.set((0,T.Nm)(n.guid),"assistant"))}}else{let t=Object.entries(_);(0,d.vA)(1===E.length,"Code layer must have exactly one code file"),(0,d.vA)(1===t.length,"Code layer snapshot must have exactly one code file");let[s,a]=t[0],{codeFile:r}=(0,l.Ur)(w,k,E[0].codeFileFullPathWithoutScheme,a,{trackSystemEditedSession:e,reportErrorToSentry:e=>{(0,y.$D)(u.e.MAKE,e)},enableDuplicateCheck:(0,g.kc)().bake_dup_code_files});r&&(r.sourceCode=a,f.zl.set((0,T.Nm)(n.guid),"assistant"))}let t=[...n.chatMessages,C];n.chatMessages=t,N.Y5.commit();let s=a===i.lV.FIGMAKE?(0,x._J)("/App.tsx"):E[0];s&&(0,c.J)(s),(0,z.wi)(n.guid,{switchToPreview:!1})})}},773205:(e,t,s)=>{s.d(t,{G:()=>h,H:()=>m});var a=s(716976),n=s(812714),r=s(795033),i=s(883765),l=s(590268),c=s(211862),o=s(107799),x=s(540041),d=s(723339);let u="figmake-initial-message";function m(){let[e,t]=(0,r.fp)(o.H0),s=(0,r.md)(o.lA);if(null===e){let e=l.x4?.getItem(u);t(!!e&&'""'!==e||!!s)}return e}function h({enabled:e,chatMessagesNodeGuid:t,setInput:s,sendMessage:m}){let h;let p=(0,n.kc)().killswitch_make_initial_message,[g,f]=a.useState(!1),_=(0,d.ry)(),y=(0,r.md)(c.ze),[j,k,v]=(0,l.Vc)(u,"",{}),[b,N]=(0,r.fp)(o.lA);if(b){let e=(0,x.Z)().find(e=>e.key===b.toLowerCase());e&&(h=e.prompt)}else j&&'""'!==j&&(h=j);a.useEffect(()=>{e&&!p&&t&&h&&!g&&!_&&y&&(s(h),m({message:h}),f(!0),i.az.trackDefinedEvent("figmake.send_initial_message",{fileKey:y||"",promptKey:b||void 0}),v(),N(null))},[t,h,g,e,p,_,y,b])}},99748:(e,t,s)=>{s.d(t,{D:()=>Z});var a=s(104076),n=s(716976),r=s(903927),i=s(878604),l=s(268389),c=s(795033),o=s(120440),x=s(366535),d=s(959834),u=s(636609),m=(e=>(e.LIST_MCP_CLIENTS="list_mcp_clients",e.INSPECT_MCP_CLIENT="add_mcp_client",e))(m||{});let h=(0,c.eU)({screen:"list_mcp_clients",selectedMcpServerId:null});var p=s(827695),g=s(293422),f=s(929302),_=s(91478),y=s(918552),j=s(516604),k=s(73795),v=s(441513),b=s(113139);let N=v.z.object({id:v.z.string(),name:v.z.string(),url:v.z.string(),logo_url:v.z.string().optional(),transport:v.z.enum(["http","sse"]),user_id:v.z.string(),is_public:v.z.boolean()}).transform(e=>({id:e.id,name:e.name,url:e.url,transport:e.transport,logoUrl:e.logo_url,userId:e.user_id,isPublic:e.is_public})),C=v.z.object({id:v.z.string(),mcp_server_id:v.z.string(),user_id:v.z.string()}).transform(e=>({id:e.id,mcpServerId:e.mcp_server_id,userId:e.user_id})),E=v.z.object({id:v.z.string(),mcp_server_id:v.z.string(),user_id:v.z.string(),server:N}).transform(e=>({id:e.id,mcpServerId:e.mcp_server_id,userId:e.user_id,server:e.server})),w=v.z.object({clients:v.z.array(E)}),z=v.z.object({servers:v.z.array(N)}),T=v.z.object({client:C}),S=v.z.object({client:C}),A=new class{constructor(){this.GetMcpServersSchemaValidator=(0,b.YV)("GetMcpServersSchemaValidator",z,null),this.GetMcpClientsSchemaValidator=(0,b.YV)("GetMcpClientsSchemaValidator",w,null),this.CreateMcpClientSchemaValidator=(0,b.YV)("CreateMcpClientSchemaValidator",T,null),this.DeleteMcpClientSchemaValidator=(0,b.YV)("DeleteMcpClientSchemaValidator",S,null)}getMcpServers(){return this.GetMcpServersSchemaValidator.validate(async({xr:e})=>await e.get("/api/mcp/servers"))}getMcpClients(){return this.GetMcpClientsSchemaValidator.validate(async({xr:e})=>await e.get("/api/mcp/clients"))}createMcpClient(e){return this.CreateMcpClientSchemaValidator.validate(async({xr:t})=>await t.post("/api/mcp/clients",b.td.toAPIParameters(e)))}deleteMcpClient(e){let{id:t}=e;return this.DeleteMcpClientSchemaValidator.validate(async({xr:e})=>await e.del(`/api/mcp/clients/${t}`))}};var L=s(826160),q=s(25080),I=s(710211);let O=I.M4.Query({fetch:async()=>(await A.getMcpServers()).data.meta.servers}),M=I.M4.Query({fetch:async()=>(await A.getMcpClients()).data.meta.clients});var F=s(146283),D=s(816565),R=s(58212),P=s(359166),U=s(686549),G=s(178623),$=s(20267),H=s(211862);let B=(0,d.Ju)(function(e){let{onServerAdded:t}=e,s=f.hS({open:e.open,onClose:e.onClose}),i=(0,r.wA)(),{initiateOauth:c}=function({onAuthSuccess:e,onAuthFailure:t}){let[s,a]=n.useState({isAuthorizing:!1,server:null,window:null}),r=(0,H.tS)(),i=(0,$.Ay)(),l=n.useCallback(async e=>{let t=await G.Ay.mcp.listTools({id:e.id,url:e.url,transportType:e.transport},i);return t.needsAuthorization?{needsAuth:!0,authorizationUrl:t.authorizationUrl}:{needsAuth:!1}},[i]),c=n.useCallback(async s=>{try{let{needsAuth:a}=await l(s);a?t(s):await e(s)}catch(e){console.error("Error checking server authorization after OAuth:",e),t(s)}},[l,t,e]);n.useEffect(()=>{if(!s.isAuthorizing)return;let e=setInterval(()=>{s.window.closed&&(clearInterval(e),c(s.server),a({isAuthorizing:!1,server:null,window:null}))},500);return()=>clearInterval(e)},[s.window,s.server,s.isAuthorizing,c]);let o=n.useCallback(async s=>{let{needsAuth:n,authorizationUrl:i}=await l(s);if(!n){await e(s);return}let c=(0,P.TQ)();if(c&&r)c.setItem("mcp_oauth_last_file_key",r);else{console.error("Cannot store file key for OAuth callback:",{localStorage:c,fileKey:r}),t(s);return}let o=(0,U.FJ)(i,"_blank");if(!o){console.error("Failed to open OAuth window"),t(s);return}a({isAuthorizing:!0,server:s,window:o})},[r,l,t,e]);return{isAuthorizing:s.isAuthorizing,initiateOauth:o}}({onAuthSuccess:n.useCallback(async e=>{try{await A.createMcpClient({mcpServerId:e.id}),t(),i(x.Lo())}catch(e){F.k.error("Failed to create MCP client:",e),i(R.F.enqueue({message:"Failed to connect to server. Please try again.",error:!0}))}},[t,i]),onAuthFailure:e=>{F.k.error("Failed to authorize with server:",e),i(R.F.enqueue({message:"Failed to authorize server. Please try again.",error:!0}))}}),o=n.useCallback(async e=>{await c(e)},[c]);return(0,a.jsx)(_.bL,{width:"fit-content",height:"dynamic",manager:s,children:(0,a.jsxs)(l.vo,{children:[(0,a.jsx)(l.Y9,{children:(0,a.jsx)(l.hE,{children:"Add Connection"})}),(0,a.jsx)(l.nB,{padding:0,children:(0,a.jsx)(V,{onServerAdded:o})})]})})},"MCP_SERVERS_DIRECTORY_MODAL",d.ZU.YES);function V({onServerAdded:e}){let{mcpServers:t,isLoading:s}=function(){let[e,{refetch:t}]=(0,I.IT)(O(null)),s="loading"===e.status;return{mcpServers:e.data??[],isLoading:s,refetch:t}}(),n=t.filter(e=>e.isPublic).sort((e,t)=>e.name.localeCompare(t.name));return s?(0,a.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k x1m3v4wt",children:(0,a.jsx)(p.k,{})}):(0,a.jsx)("div",{className:"xi4r6k5 xvue9z xysyzu8",children:(0,a.jsx)("div",{className:"xrvj5dj x1nfngrj x1p9eum2 x1nc4n6v",children:n.map(t=>(0,a.jsx)("div",{className:"xi4r6k5 x19y5rnk xmkeg23 x1y0btm7 x7z60cl x1yjdb4r",children:(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x1qughib x1nfngrj",children:[(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x1nfngrj x98rzlu",children:(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x1i71x30",children:[(0,a.jsx)("div",{className:"x1td3qas x10w6t97 x192jxwq x1v8gsql x78zum5 x6s0dn4 xl56j7k xb3r6kr",children:t.logoUrl?(0,a.jsx)(D.oW,{src:t.logoUrl,alt:`${t.name} logo`,className:"xh8yej3 x5yr21d xl1xv1r"}):(0,a.jsx)("div",{className:"x4oah1p xewu7z0 x1s688f x1dnis8n xawads1 x1n0bwc9",children:t.name.charAt(0).toUpperCase()})}),(0,a.jsx)("div",{className:"xrlp15q x1nmd3yn x1s688f xkbmbem x3wk4up x1akne3o",children:t.name})]})}),(0,a.jsx)("div",{className:"x2lah0s",children:(0,a.jsx)(g.$n,{variant:"secondary",onClick:()=>e(t),children:"Add"})})]})},t.name))})})}function W(){let e=(0,r.wA)(),{mcpClients:t,isLoading:s,refetch:i}=function(){let[e,{refetch:t}]=(0,I.IT)(M(null)),s="loading"===e.status;return{mcpClients:e.data??[],isLoading:s,refetch:t}}(),l=n.useCallback(()=>{e(x.to({type:B,data:{onServerAdded:()=>{i()}}}))},[e,i]),c=n.useCallback(async e=>{await A.deleteMcpClient({id:e}),i()},[i]);return s?(0,a.jsx)("div",{className:"x78zum5 x6s0dn4 xl56j7k x1m3v4wt",children:(0,a.jsx)(p.k,{})}):0===t.length?(0,a.jsx)("div",{className:"x9f619 x1nfngrj xh8yej3 x5yr21d x78zum5 x6s0dn4 xl56j7k xp6roeo x1mg88bx",children:(0,a.jsxs)("div",{className:"xhwf2h4 x1nfngrj x78zum5 xdt5ytf x6s0dn4 x2b8uid",children:[(0,a.jsx)(y.K,{}),(0,a.jsx)("div",{...o.Ay.props(k.g.textBodyMedium),children:"Want to connect to an MCP server?"}),(0,a.jsx)(g.$n,{onClick:l,children:"Add connection"})]})}):(0,a.jsxs)("div",{className:"xctkrei x8rdmch x78zum5 xdt5ytf x1i71x30",children:[(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x1nfngrj",children:t.map(e=>(0,a.jsx)(K,{mcpClientWithServer:e,onDelete:c},e.id))}),(0,a.jsx)(g.Pw,{iconPrefix:(0,a.jsx)(j.x,{}),onClick:l,variant:"secondary",children:"Add connection"})]})}function K({mcpClientWithServer:e,onDelete:t}){let{server:s}=e,[r,i]=n.useState(!1),[o,x]=(0,c.fp)(h),d=f.hS({open:r,onClose:()=>i(!1),preventUserClose:!0}),u=async s=>{s.stopPropagation();try{await t(e.id)}catch(e){console.error("Failed to delete MCP server:",e)}finally{i(!1)}};return(0,a.jsxs)("div",{className:"x78zum5 x1n2onr6 x1qughib x6s0dn4 xf7z5ut x19y5rnk",children:[(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x1i71x30",children:[(0,a.jsx)(L.h3,{shape:"ROUNDED_SQUARE",size:32,imgUrl:s.logoUrl||"",className:null,children:(0,a.jsx)(L.pw,{size:32,fontSize:14,color:(0,q.$L)(s.id,q.us),enabled:!0,shape:"ROUNDED_SQUARE",children:s.name.charAt(0).toUpperCase()})}),(0,a.jsx)("div",{className:"xrlp15q x1nmd3yn xk50ysn xkbmbem x3wk4up x1akne3o",children:s.name})]}),(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x1nfngrj",children:[(0,a.jsx)(g.$n,{variant:"secondary",onClick:t=>{t.stopPropagation(),x({screen:m.INSPECT_MCP_CLIENT,selectedMcpServerId:e.server.id})},children:"View tools"}),(0,a.jsx)(g.$n,{variant:"destructiveSecondary",onClick:e=>{e.stopPropagation(),i(!0)},children:"Delete"})]}),(0,a.jsx)(_.bL,{manager:d,width:"md",children:(0,a.jsxs)(l.vo,{children:[(0,a.jsx)(l.Y9,{children:(0,a.jsx)(l.hE,{children:"Delete connection"})}),(0,a.jsx)(l.nB,{children:"Are you sure you want to delete this connection? You cannot undo this operation."}),(0,a.jsx)(l.wi,{children:(0,a.jsxs)(l.jk,{children:[(0,a.jsx)(g.$n,{variant:"secondary",onClick:()=>i(!1),children:"Cancel"}),(0,a.jsx)(g.$n,{variant:"destructive",onClick:u,children:"Delete"})]})})]})})]})}var Y=s(194413),X=s(833805);let J=I.M4.Query({fetch:async e=>{let{mcpServerId:t,authInfo:s}=e;if(!t)return{tools:[],clientInfo:null};let a=(await A.getMcpClients()).data.meta.clients.find(e=>e.server.id===t);if(!a)return;let{server:n}=a,r=await G.Ay.mcp.listTools({id:n.id,url:n.url,transportType:n.transport},s);return{tools:r.needsAuthorization?[]:r.tools.tools,clientInfo:a}}});function Q(){let[e,t]=(0,c.fp)(h),s=(0,$.Ay)(),[n]=(0,X.IT)(J({mcpServerId:e.selectedMcpServerId,authInfo:s})),r="loaded"!==n.status;if(e.screen!==m.INSPECT_MCP_CLIENT)return null;if(r)return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1excjyp x1dipnxa x179dxpb xb3r6kr",children:[(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x1i71x30 xp6roeo xso031l x1q0q8m5 xertd99",children:[(0,a.jsx)(g.$n,{variant:"secondary",onClick:()=>{t({screen:m.LIST_MCP_CLIENTS,selectedMcpServerId:null})},children:(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 xg2d0mh",children:[(0,a.jsx)(Y.v,{}),"Back"]})}),(0,a.jsx)("div",{className:"xor4psk x1ncjjhx xaoa4km x2i041 x14terfx x1akne3o x1iyjqo2",children:"Loading..."})]}),(0,a.jsx)("div",{className:"x78zum5 xl56j7k x6s0dn4 x1iyjqo2 xz65tgg",children:(0,a.jsx)(p.k,{})})]});let{tools:i,clientInfo:l}=n.data??{tools:[],clientInfo:null};return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1excjyp x1dipnxa x179dxpb xb3r6kr",children:[(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x1i71x30 xp6roeo xso031l x1q0q8m5 xertd99",children:[(0,a.jsx)(g.$n,{variant:"secondary",onClick:()=>{t({screen:m.LIST_MCP_CLIENTS,selectedMcpServerId:null})},children:(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 xg2d0mh",children:[(0,a.jsx)(Y.v,{}),"Back"]})}),(0,a.jsx)("div",{className:"xor4psk x1ncjjhx xaoa4km x2i041 x14terfx x1akne3o x1iyjqo2",children:l?.server.name||"Unknown Server"})]}),0===i.length?(0,a.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9 x2b8uid x1ou3mml x1k4tb9n",children:"No tools available"}):i.map(e=>(0,a.jsxs)("div",{className:"xmkeg23 x1y0btm7 x7z60cl x19y5rnk x1dipnxa x78zum5 xdt5ytf x1nfngrj x1v8gsql x1htgra6",children:[(0,a.jsx)("div",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly x1akne3o",children:e.name}),e.description&&(0,a.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 x37zpob x3wk4up x1n0bwc9",children:e.description})]},e.name))]})}let Z=(0,d.Ju)(function(e){let{defaultPosition:t,onCloseCallback:s}=e,{screen:o}=(0,c.md)(h),d=(0,r.wA)(),p=n.useCallback(()=>{s(),d(x.AS())},[d,s]);return(0,a.jsx)(i.bL,{defaultPosition:t,width:420,maxHeight:420,onClose:p,children:(0,a.jsxs)(l.vo,{children:[(0,a.jsx)(l.Y9,{children:(0,a.jsx)(l.hE,{children:"MCP Servers"})}),(0,a.jsx)(l.nB,{padding:0,children:(0,a.jsx)("div",{className:"x78zum5 xdt5ytf xfd5v8p xh8yej3 x9f619 x1gskr33 x1ihwiht",children:(0,a.jsxs)(u.$,{className:"x98rzlu x1717udv x78zum5 xdt5ytf xb3r6kr",children:[o===m.LIST_MCP_CLIENTS&&(0,a.jsx)(W,{}),o===m.INSPECT_MCP_CLIENT&&(0,a.jsx)(Q,{})]})})})]})})},"McpClientsOverlay",d.ZU.YES)},254362:(e,t,s)=>{s.d(t,{a_:()=>A,M_:()=>S,ct:()=>z,Re:()=>T,pr:()=>w,V:()=>E});var a=s(104076),n=s(673349),r=s(980852),i=s(795033),l=s(120440),c=s(652539),o=s(192075),x=s(211862),d=s(141524),u=s(549936),m=s(716976),h=s(651234),p=s(684742),g=s(238198),f=s(236707),_=s(24441),y=s(743558);let j={container:{k1xSpc:"x78zum5",kVAM5u:"x7z60cl",kaIpWk:"x9h44rk",kMzoRj:"xmkeg23",ksu8eU:"x1y0btm7",k8WAf4:"x1vvogim",kg3NbH:"xaope02",kLWn49:"x1o2sk6j",kXwgrk:"xdt5ytf",kMwMTN:"x1n0bwc9",$$css:!0}};function k({changes:e,startExpanded:t=!1,maxHeight:s,chatMessagesNodeGuid:n,featureType:r,allowIndividualFileRestore:i=!1}){let[c,x]=(0,m.useState)(t),{defaultTypographyStyle:d}=(0,_.L)(),{restoreFile:u}=(0,y.q)({chatMessagesNodeGuid:n,featureType:r||h.lV.FIGMAKE}),f=i?u:void 0;if(0===e.length)return null;if(1===e.length){let t=e[0];return t?(0,a.jsx)("div",{...l.Ay.props(j.container,d),style:s?{maxHeight:s,overflowY:"auto"}:void 0,children:(0,a.jsx)(v,{change:t,getRestoreCallback:f})}):null}return(0,a.jsxs)("div",{...l.Ay.props(j.container,d),style:s?{maxHeight:s,overflowY:"auto"}:void 0,children:[(0,a.jsxs)(p.E,{className:"x78zum5 x6s0dn4 x167g77z x1ypdohk x87ps6o x1qughib x1n0bwc9",onClick:()=>x(!c),children:[(0,a.jsx)("span",{children:(0,o.t)("figmake.edits.edited_files",{fileCount:e.length})}),(0,a.jsx)("span",{...{0:{className:"xtc4nxu x1bmturs"},1:{className:"xtc4nxu x1bmturs x1iffjtl"}}[!!c<<0],children:(0,a.jsx)(g.a,{})})]}),c&&(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x167g77z x1vvogim xnjsko4",children:e.map((e,t)=>(0,a.jsx)(v,{change:e,getRestoreCallback:f},`${e.path}-${t}`))})]})}function v({change:e,getRestoreCallback:t}){let s;let n=t?.(e.path);return(0,a.jsxs)("div",{className:"x78zum5 x6s0dn4 x167g77z x1qughib xjwf9q1",children:[(0,a.jsx)("span",{className:"x98rzlu xb3r6kr xlyipyv xuxw1ft",title:e.path,children:(s=e.path).split("/").pop()??s}),(0,a.jsxs)("span",{className:"x1jnr06f x78zum5 x6s0dn4",children:[e.addedLines>0&&(0,a.jsx)("span",{className:"xq6u9c4",children:(0,o.t)("figmake.edits.lines_added",{count:e.addedLines})}),e.removedLines>0&&(0,a.jsx)("span",{className:"x172n1ly",children:(0,o.t)("figmake.edits.lines_removed",{count:e.removedLines})}),n&&(0,a.jsx)(p.E,{className:"xfawy5m x12oqio5 xet2fuk x1ypdohk xjbqb8w x12tve8b x1n0bwc9 x1c5oinq xfn42iu xng3xce x1r7ld26 x78zum5 x6s0dn4 xl56j7k xvy4d1p xxk0z11",onClick:n,children:(0,a.jsx)(f.H,{className:"x1wt4b31 x1kky2od xlup9mm"})})]})]})}var b=s(410915),N=s(537665),C=s(114344);function E({message:e,chatMessagesNodeGuid:t,systemMessageIndex:s,featureType:n,isMostRecent:r,trackingContext:i,title:c,layerDisplayName:x}){let{defaultTypographyStyle:d}=(0,_.L)(),{restoreVersion:m}=(0,N.OL)({codeSnapshotKey:e.codeSnapshotKey,chatMessagesNodeGuid:t,featureType:n,restoreToVersionTitle:c,...i}),h=(0,a.jsx)(u.F,{type:"version",isCurrentVersion:r,versionNumber:s+1,restoreVersion:m,chatMessagesNodeGuid:t,layerDisplayName:x,versionTitle:c});return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl",children:[(0,a.jsx)("div",{...l.Ay.props(d),children:(0,o.t)("figmake.chat.restoring_a_previous_version")}),h]})}function w({message:e,chatMessagesNodeGuid:t,systemMessageIndex:s,featureType:n,isMostRecent:r,trackingContext:i,title:c,layerDisplayName:x}){let{defaultTypographyStyle:d}=(0,_.L)(),m=c&&(0,o.t)("figmake.chat.edited_version",{versionTitle:c}),{restoreVersion:h}=(0,N.OL)({codeSnapshotKey:e.codeSnapshotKey,chatMessagesNodeGuid:t,featureType:n,restoreToVersionTitle:m,...i}),p=(0,a.jsx)(u.F,{type:"version",isCurrentVersion:r,versionNumber:s+1,restoreVersion:h,chatMessagesNodeGuid:t,layerDisplayName:x,versionTitle:m});return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl",children:[(0,a.jsx)("div",{...l.Ay.props(d),children:(0,o.t)("figmake.edits.manual_edit_message")}),(0,a.jsx)(k,{changes:e.changedFiles,startExpanded:!0,chatMessagesNodeGuid:t}),p]})}let z="in-progress-manual-edit";function T({chatMessagesNodeGuid:e,featureType:t,codeFileChanges:s,layerDisplayName:c,versionNumber:d}){let{defaultTypographyStyle:m}=(0,_.L)(),{changedFiles:h,error:p,hasBaseline:g}=s,f=(0,r.UN)().get(e),y=(0,b.EI)(f),j=(0,i.md)(x.yV);if(p||!g||0===h.length)return null;let v=(y?(0,n.eB)(y):void 0)||j?.name,N=v&&(0,o.t)("figmake.chat.edited_version",{versionTitle:v}),C=async()=>{},E=(0,a.jsx)(u.F,{type:"version",isCurrentVersion:!0,versionNumber:d+1,restoreVersion:C,chatMessagesNodeGuid:e,layerDisplayName:c,versionTitle:N});return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl",children:[(0,a.jsx)("div",{...l.Ay.props(m),children:(0,o.t)("figmake.edits.manual_edit_message")}),(0,a.jsx)(k,{changes:h,startExpanded:!0,chatMessagesNodeGuid:e,featureType:t,allowIndividualFileRestore:!0}),E]})}function S(){return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl",children:[(0,a.jsx)("p",{className:"xuzfeq1 x8yk33q x1e00guj x18zpg43 x22v61l",children:(0,o.t)("figmake.duplicated_file_system_message")}),(0,a.jsx)(L,{})]})}function A({message:e}){let{user:t}=(0,d.wW)(e.userId??null),s=t?.handle;if(!e.timestamp)return null;let n=new Date(e.timestamp),r=(0,o.t)("figmake.chat_management.messages.chat_history_cleared_timestamp",{time:n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),date:n.toLocaleDateString([],{month:"long",day:"numeric",year:"numeric"})});return(0,a.jsx)("div",{className:"x78zum5 xdt5ytf xou54vl",children:(0,a.jsx)("div",{className:"x1n0bwc9 x1k4tb9n",children:(0,o.t)("figmake.chat_management.messages.chat_history_cleared",{timestamp:r})+(s?(0,o.t)("figmake.chat_management.messages.chat_history_cleared_user",{username:s}):"")})})}function L(){return(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x1cy8zhl x1jnr06f x9h44rk xmkeg23 x1y0btm7 x7z60cl x1y1aw1k xyfqnmn xwib8y2 x163pfp",children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,a.jsx)("div",{className:"xvy4d1p xxk0z11 x78zum5 xl56j7k x6s0dn4",children:(0,a.jsx)(c.B,{svg:C.A,useOriginalSrcFills_DEPRECATED:!0,svgWidth:"14px",svgHeight:"14px"})}),(0,a.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:(0,o.t)("figmake.supabase.duplicated_file.cta")})]})})}},686586:(e,t,s)=>{s.d(t,{UP:()=>M,Uy:()=>O,Zl:()=>$,eh:()=>D,pA:()=>H,py:()=>R,zg:()=>G});var a=s(716976),n=s(903927),r=s(651234),i=s(570112),l=s(621579),c=s(638004),o=s(913834),x=s(813499),d=s(812714),u=s(795033),m=s(755444),h=s(550209),p=s(530138),g=s(967782),f=s(192075),_=s(619070),y=s(141773),j=s(211862),k=s(248043),v=s(985416),b=s(395556),N=s(183366),C=s(700126),E=s(635533),w=s(410915),z=s(157067),T=s(773205),S=s(923669),A=s(329232),L=s(631571),q=s(963433),I=s(11055);let O=new l.b("EmptyStateChatMessageEmitter");async function M(e,t,s,a){if(!s||!a||!o.glU)return;let n=await (0,p.v)(),l=await fetch(e),g=new n.ZipReader(new n.BlobReader(await l.blob())),_=await g.getEntries(),y=await Promise.all(_.map(async e=>{let t=e.filename.startsWith("/")?e.filename:`/${e.filename}`;if(function(e){if(!e.startsWith("/src/"))return!1;let t=e.split("/").pop();return!(!t||1>t.indexOf("."))}(t)){let s=await e.getData?.(new n.TextWriter);return[t.replace("/src/","/"),s]}})).then(e=>Object.fromEntries(e.filter(e=>void 0!==e)));(0,i.E)([{id:o.glU.generateUniqueID(),type:x.K$p.ASSISTANT_MESSAGE,userId:m.Ay().user_data?.id||"",textContent:JSON.stringify({modelConfigVersion:"",mode:"summary",plainText:t}),sentAt:Date.now(),toolCalls:[],toolResults:[],sentAt64:Date.now().toString()}],a,y,s,r.lV.FIGMAKE,{multi_file_code_layers:(0,d.kc)().multi_file_code_layers,bake_canvas:(0,d.kc)().bake_canvas},{trackSystemEditedSession:e=>{let t=A.O.get(e.guid);t&&(t.hasSystemEdited=!0)},setCodeLastEditedBy:e=>{u.zl.set((0,E.Nm)(e),"assistant")},createCodeSnapshot:S.O,reportErrorToSentry:e=>(0,h.$D)(c.e.AI_FOR_PRODUCTION,e),mirrorCommunityAttributionDisplay:z.gC,clearCommunityAttribution:z.En,translationFns:{getChatCommunityAttributionComment:e=>(0,f.t)("figmake.chat.community_attribution.attribution_comment",{creatorName:e.creatorName,hubFileName:e.hubFileName,hubFileLink:`${(0,m.Ay)().figma_url}${(0,k.X$)(e.hubFileId)}`,licenseName:"CC BY 4.0",licenseLink:"https://creativecommons.org/licenses/by/4.0/"})},translatedStrings:{figmakeChatUnsplashAttributionAttributionComment:(0,f.t)("figmake.chat.unsplash_attribution.attribution_comment"),figmakeChatShadcnAttributionAttributionComment:(0,f.t)("figmake.chat.shadcn_attribution.attribution_comment")},enableDuplicateCheck:(0,d.kc)().bake_dup_code_files})}function F(e){if(e.current){e.current.focus();let t=e.current.value.length;e.current.setSelectionRange(t,t)}}function D({inputValue:e,setInputValue:t,setPlaceholderText:s,textareaRef:n,defaultPlaceholder:r,setIsAnimating:i}){let l=(0,a.useRef)(null);return(0,a.useEffect)(()=>()=>{l.current&&clearTimeout(l.current)},[]),(0,a.useCallback)(a=>{l.current&&clearTimeout(l.current),i(!0);let c=e=>0===e?20:Math.max(7,Math.min(35,200/Math.sqrt(e))),o=()=>{s(r),i(!1),setTimeout(()=>F(n),0)},x=e=>{let s=c(e.length),a=0,n=()=>{a<e.length?(a++,t(e.slice(0,a)),l.current=setTimeout(n,s)):o()};n()},d=(e,t,s)=>{let a=c(e.length),n=e.length,r=()=>{n>0?(n--,t(e.slice(0,n)),l.current=setTimeout(r,a)):s()};r()};0===e.length?d(r,s,()=>{x(a)}):(s(""),d(e,t,()=>{x(a)}))},[e,t,s,r,n,i])}function R({setInputValue:e,textareaRef:t,setIsAnimating:s}){return(0,a.useCallback)(a=>{s(!0);let n=()=>{t.current&&(t.current.style.opacity="1"),setTimeout(()=>{s(!1),setTimeout(()=>F(t),0)},350)};t.current&&(t.current.style.opacity="0"),setTimeout(()=>{e(a),n()},350)},[s,e,t])}let P=(0,v.Wh)(()=>(0,u.eU)(!1)),U=(0,u.eU)(!1),G=(0,u.eU)(e=>e(U));function $(e,t){let[s,n]=(0,u.fp)(P),r=(0,u.Xr)(U),i=(0,C.l)(),l=(0,w.EI)(t),c=(0,T.H)(),o=(0,q.wp)(),x=e&&!s&&!i&&!l?.length&&!c&&!o;return(0,a.useEffect)(()=>(r(x),()=>{r(!1)}),[x,r]),{showFullWidthEmptyState:x,requestClose:()=>n(!0)}}function H(e){let{insertTemplate:t}=(0,y.Fz)(),s=(0,I.GV)(),a=(0,u.Xr)(L.Pl),r=(0,j.q5)(),i=(0,n.wA)();return async n=>{let l;if(!r)return;if(n.content.template)l={template:n.content.template,type:b.n.TeamTemplate};else if(n.content.hub_file)l={template:n.content.hub_file,type:b.n.HubFile};else throw Error("Unsupported resource type");await t({template:l,useMakeTemplateReplace:!0,triggeredFrom:e,onSuccess:()=>{N.j.addResourceUse({resourceId:n.id})},onFailure:()=>{(0,h.$D)(c.e.AI_FOR_PRODUCTION,Error("Failed to insert make template"),{extra:{resourceId:n.id}})}});let o=function(e){if(e.type===b.n.HubFile){let t=e.template.versions[e.template.current_hub_file_version_id]?.name;return(0,d.kc)().empty_state_template_insert_rename&&t?(0,f.t)("figmake.empty_state.template.community",{templateName:t}):t}if(e.type===b.n.TeamTemplate||e.type===b.n.TeamTemplateLg){let t=e.template.name;return(0,d.kc)().empty_state_template_insert_rename?(0,f.t)("figmake.empty_state.template.duplicate",{templateName:t}):t}}(l);r.name===(0,f.t)("fullscreen.fullscreen_view_selector.untitled")&&o&&i((0,_.Nw)({file:{key:r.key},name:o})),(0,g.YQ)({id:"ai_for_production.chat_response_received"}),a(!0),u.zl.set(P,!0),s()}}},624320:(e,t,s)=>{s.d(t,{R1:()=>O,iE:()=>R,mt:()=>M,n:()=>P,q3:()=>F,x6:()=>I});var a=s(104076),n=s(716976),r=s(903927),i=s(293422),l=s(429120),c=s(191036),o=s(266808),x=s(812714);s(120440);var d=s(883765),u=s(754038),m=s(219199),h=s(208882),p=s(350819),g=s(944520),f=s(11395),_=s(147643),y=s(192075),j=s(354114),k=s(201482),v=s(211862),b=s(894210),N=s(343398),C=s(619794),E=s(524101),w=s(560201),z=s(963433),T=s(347142),S=s(789596);function A(e,t,s=p.qB.SIGN_IN){let a=(0,N.Y9)();return n.useCallback(()=>{(0,f.UK)(e),a({origin:t,formState:s})},[a,e,t,s])}function L(){let e=A("SIGN_UP_BUTTON_BANNER",u.ty.FIGMA_REV_LOGGED_OUT_HEADER,p.qB.SIGN_UP);return(0,a.jsx)(i.WW,{htmlAttributes:{"data-test-id":"email-btn"},onClick:e,children:(0,y.tx)("footer_banner.sign_up_with_email")})}function q(){let e=(0,r.wA)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.H,{large:!0,brandTextColor:!0,onClick:()=>{(0,f.UK)("GOOGLE_SSO_BUTTON"),(0,u.Rm)({dispatch:e,origin:u.ty.FIGMA_REV_LOGGED_OUT_HEADER_WITH_GOOGLE,redirectUrl:m.Ay.location.pathname}).then(t=>{"login"===t.type&&e(h.My({userId:t.user.id}))},t=>{(0,g.g)("google_signup_error",u.ty.FIGMA_REV_LOGGED_OUT_HEADER_WITH_GOOGLE,{error:t.message}),(0,x.kc)().ff_show_auth_modal_on_google_sso_error&&(0,u.Y2)({dispatch:e,origin:u.ty.FIGMA_REV_LOGGED_OUT_HEADER_WITH_GOOGLE,message:t.message,redirectUrl:m.Ay.location.pathname})})},children:(0,y.t)("footer_banner.continue_with_google")}),(0,a.jsx)(C.P,{origin:u.DT.LOGGED_OUT_FILE,overrideUseFedCMPrompt:!1})]})}function I(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(L,{}),(0,a.jsx)("div",{className:"xmkeg23 x1y0btm7 x7z60cl x7xtdkp",children:(0,a.jsx)(q,{})})]})}function O(){let e=A("SHARE_BUTTON",u.ty.FIGMA_REV_LOGGED_OUT_HEADER);return(0,a.jsx)(i.WW,{variant:"primary",onClick:e,children:(0,y.t)("fullscreen.toolbar.multiplayer.share")})}function M(){let{canDuplicate:e}=(0,E.tz)(),t=(0,T.e4)();return e&&t}function F({blockWithAuthModal:e}){let{duplicateFile:t}=(0,E.tz)(),s=M(),n=A(o.rcl.PAGE_DUPLICATE,u.ty.FIGMA_REV_LOGGED_OUT_HEADER);return s?(0,a.jsx)(i.WW,{variant:"secondary",onClick:e?n:t,htmlAttributes:{"data-onboarding-key":S.S$},children:(0,y.t)("figmake.make_a_copy")}):(0,a.jsx)(a.Fragment,{})}let D=(0,w.ex)("figmake_open_fullscreen_preview_new_tab",function(){return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf xl56j7k x6s0dn4",children:[(0,a.jsx)("div",{children:(0,y.t)("figmake.open_new_tab_preview")}),(0,a.jsx)("div",{className:"xkrz9af xt970qd x5k8d2m",children:(0,y.t)("figmake.open_new_tab_preview_footer")})]})});function R({openInSameTab:e=!1,disabled:t=!1}){let{openFigmakeFullscreenInNewTab:s,openFigmakeFullscreenInSameTab:r}=(0,z.Ve)(),i=(0,v.tS)(),c=n.useCallback(()=>{d.az.trackDefinedEvent("ai_for_production.figmake_open_preview_in_new_tab_clicked",{fileKey:i??""}),s()},[s,i]),o=n.useCallback(()=>{d.az.trackDefinedEvent("ai_for_production.figmake_open_preview_in_same_tab_clicked",{fileKey:i??""}),r()},[r,i]);return(0,a.jsx)(_.J,{onClick:e?o:c,"aria-label":(0,y.t)("figmake.open_new_tab_preview"),"data-testid":"open-fullscreen-preview-button",disabled:t,htmlAttributes:{"data-tooltip":D,"data-tooltip-type":b.Ib.SPECIAL,"data-tooltip-offset-y":2,"data-onboarding-key":S.NR},children:(0,a.jsx)(l.K,{})})}function P(){let e=(0,z.Gu)()??!1,t=n.useCallback(()=>{j.Y5.triggerActionEnumInUserEditScope(o.rcl.COPY_MAKE_FOR_DESIGN)},[]);if(!(0,x.kc)().bake_canvas)return null;let s=(0,y.t)("figmake.copy-make-for-design");return(0,a.jsx)(_.J,{onClick:t,"aria-label":s,"data-testid":"copy-make-for-design-button",htmlAttributes:{"data-tooltip":s,"data-tooltip-type":b.Ib.TEXT,"data-tooltip-max-width":200},disabled:e,children:(0,a.jsx)(c.a,{})})}},789596:(e,t,s)=>{s.d(t,{$i:()=>a,FW:()=>p,HB:()=>u,NR:()=>l,OU:()=>m,S$:()=>r,Xe:()=>n,eq:()=>i,hj:()=>h,kx:()=>c,oD:()=>o,t$:()=>x,wj:()=>d});let a="full_view_body",n="figma_back_to_files",r="make_a_copy_button",i="make_publish_button",l="fullscreen_preview_button",c="point_and_edit",o="ds_import_selected_library",x="ds_import_use_design_system",d="code_chat_attach_design",u="code_chat_message_container",m="make_chat_empty_state_suggestions",h="make.trigger_publish_menu_open",p="make_empty_state_overlay_input"},11055:(e,t,s)=>{s.d(t,{GV:()=>b,My:()=>k,E7:()=>v});var a=s(716976),n=s(795033),r=s(883765),i=s(292168),l=s(955440),c=s(244205),o=s(211862),x=s(710211),d=s(209801),u=s(3234),m=s(366797),h=s(659925),p=s(872233),g=s(525423),f=s(997477),_=s(441513),y=(e=>(e.EXPLORE="explore",e))(y||{});let j=_.z.object({shelves:_.z.record(_.z.nativeEnum(y),_.z.object({shelf_id:_.z.string()})).optional().default({})});function k(){let{requestCloseEmptyState:e}=(0,a.useContext)(g.k),t=(0,n.Xr)(h.Wn),s=(0,n.Xr)(m.Np),i=(0,o.tS)();return(0,a.useCallback)(()=>{i&&(e(),s(!0),t(!1),r.az.trackDefinedEvent("figmake.filesystem_action",{fileKey:i,action:c.c.NEW_TEMPLATE,targetType:"template",entryPoint:"template_picker",codeFileGuid:void 0}))},[i,t,s,e])}function v({enabled:e}){let{resources:t,teamOrOrgName:s,status:a,requestLoadMoreForTeam:n}=(0,l.U)({resourceType:i.vt.FIGMAKE_TEMPLATE,pageSize:p.bO,caller:u.z.MAKE_TEMPLATE_PICKER,enabled:e}),r=function(e){let{getDynamicConfig:t}=(0,f.Fj)("make_template_picker_shelves"),{shelves:s}=j.parse(t().value);return s[e]?.shelf_id}(y.EXPLORE),[{data:c,status:o,hasNextPage:m,isFetchingNextPage:h},{fetchNextPage:g}]=(0,x.IT)(d.A.ShelfContentPaginatedQuery({shelfId:r??"",includeContent:!0,pageSize:p.md}),{enabled:!!r&&e});return{internalTemplatesData:{resources:t,teamOrOrgName:s,status:a,requestLoadMoreForTeam:n},communityTemplatesData:{resources:c??[],status:o,hasNextPage:!!m,isFetchingNextPage:h,fetchNextPage:g}}}function b(){let e=(0,n.Xr)(h.Wn),t=(0,n.Xr)(h.dp),s=(0,n.Xr)(h.jl);return()=>{e(!1),t(h.nM),s(null)}}},659925:(e,t,s)=>{s.d(t,{E0:()=>r,Wn:()=>n,dp:()=>c,jl:()=>o,nM:()=>i,sZ:()=>l});var a=s(795033);let n=(0,a.eU)(!1);var r=(e=>(e.EXPLORE="EXPLORE",e.INTERNAL="INTERNAL",e.COMMUNITY="COMMUNITY",e.SELECTED_TEAM_OR_ORG="SELECTED_TEAM_OR_ORG",e))(r||{});let i={type:"EXPLORE"},l={type:"INTERNAL"},c=(0,a.eU)(i),o=(0,a.eU)(null)},872233:(e,t,s)=>{s.d(t,{Sn:()=>r,bO:()=>a,md:()=>n});let a=2,n=8,r=4},525423:(e,t,s)=>{s.d(t,{k:()=>a});let a=(0,s(716976).createContext)({requestCloseEmptyState:()=>{}})},108429:(e,t,s)=>{s.d(t,{K:()=>B});var a=s(104076),n=s(827695),r=s(684742),i=s(293422),l=s(803126),c=s(795033);s(120440);var o=s(833805),x=s(115989),d=s(192075),u=s(211862),m=s(710211),h=s(304425),p=s(577932),g=s(32404),f=s(996715),_=s(972700),y=s(647178),j=s(716976),k=s(903927),v=s(929302),b=s(91478),N=s(268389),C=s(420680),E=s(475477),w=s(368581),z=s(623411),T=s(149073),S=s(366535),A=s(959834),L=s(293172),q=s(622018),I=s(847714),O=s(886597),M=s(649431),F=s(10074);function D({activeProjects:e,projectIdToPause:t,setProjectIdToPause:s}){let n=(0,c.md)(L.kz);return(0,a.jsx)(w.b,{legend:(0,a.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:(0,d.t)("figmake.settings.pause_project.radio.label")}),value:t,onChange:s,readonly:!!n,children:e.map(e=>(0,a.jsx)(w.c,{value:e.id,label:(0,a.jsx)(z.J,{children:(0,a.jsx)(R,{project:e})})},e.id))})}function R({project:e}){return(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:e.name}),(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,d.tx)("figmake.settings.pause_project.created",{timestamp:(0,a.jsx)(x.h1,{date:e.created_at})})})]},e.id)}function P({props:e,projectIdToPause:t}){let s=(0,u.tS)(),[n,r]=(0,c.fp)(L.kz),l=(0,_.h5)({toolCallId:e.toolCallId,toolName:e.toolName,trackingContext:e.trackingContext,source:e.source}),o=async()=>{if(!s){console.error("No open file key found");return}if(!t){console.error("No selected project found");return}r(t);try{await h.R.pauseProject({fileKey:s,projectId:t});let a=setInterval(async()=>{let n=await m.M4.fetch((0,O.GO)({fileKey:s,projectId:t}),{policy:"networkOnly"});n?.status.toLowerCase()===g.TL.INACTIVE&&(e.onClose(),clearInterval(a),(0,M.l4)(),r(null),e.connectToExistingProject?e.connectToExistingProject():l())},2e3)}catch(e){r(null),(0,y.ZH)(e)}};return n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,d.t)("figmake.supabase.pausing_project.subtitle")}),(0,a.jsx)(i.$n,{variant:"secondary",onClick:()=>e.onClose(),disabled:!0,children:(0,d.t)("figmake.pause_project_modal.button.cancel")}),(0,a.jsx)(q.lV,{variant:"destructive",children:(0,d.t)("figmake.pause_project_modal.button.loading")})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.$n,{variant:"secondary",onClick:()=>e.onClose(),children:(0,d.t)("figmake.pause_project_modal.button.cancel")}),(0,a.jsx)(i.$n,{variant:"destructive",onClick:o,disabled:!t,children:(0,d.t)("figmake.pause_project_modal.button.submit")})]})}let U=(0,A.Ju)(function(e){let t=v.hS({...e}),{organization:s}=(0,g.mS)(),{activeProjects:n}=(0,g.YY)(),r=(0,k.wA)(),i=!!e.toolCallId&&!!e.toolName,[l,c]=(0,j.useState)(void 0);return(0,a.jsx)(b.bL,{manager:t,width:394,children:(0,a.jsxs)(N.vo,{children:[(0,a.jsxs)(N.Y9,{children:[i&&(0,a.jsx)(C.K,{"aria-label":(0,d.t)("figmake.supabase.pause_project_modal.back"),onClick:()=>{e.onClose(),r((0,S.to)({type:I.Z,data:{toolCallId:e.toolCallId,toolName:e.toolName,trackingContext:e.trackingContext,source:e.source},showModalsBeneath:!0}))},children:(0,a.jsx)(T.C,{})}),(0,a.jsx)(N.hE,{children:(0,d.t)("figmake.pause_project_modal.title")})]}),(0,a.jsx)(N.nB,{scrolling:"none",children:(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf xou54vl",children:[(0,a.jsx)("div",{children:(0,d.tx)("figmake.pause_project_modal.body_with_link",{upgradeLink:(0,a.jsx)(E.N,{href:(0,F.$X)(s?.id||""),newTab:!0,children:(0,d.t)("figmake.pause_project_modal.upgrade_link")})})}),(0,a.jsx)(D,{activeProjects:n,projectIdToPause:l,setProjectIdToPause:c})]})}),(0,a.jsx)(N.wi,{children:(0,a.jsx)(N.jk,{className:"x78zum5 x1q0g3np x13a6bvl x167g77z x1xn8qrt xdqyycr xh8yej3 x9f619",children:(0,a.jsx)(P,{props:e,projectIdToPause:l})})})]})})},"PauseProjectModal");function G({toolCallId:e,toolName:t,connectToExistingProject:s,trackingContext:a,source:n}){let r=(0,k.wA)();return()=>r((0,S.to)({type:U,data:{toolCallId:e,toolName:t,connectToExistingProject:s,trackingContext:a,source:n},showModalsBeneath:!0}))}let $=(0,A.Ju)(function(e){let t=v.hS({open:e.open,onClose:e.onClose}),s=(0,_.h5)({toolCallId:e.toolCallId,toolName:e.toolName,trackingContext:e.trackingContext,source:e.source});return(0,a.jsx)(b.bL,{manager:t,width:386,children:(0,a.jsxs)(N.vo,{children:[(0,a.jsx)(N.Y9,{children:(0,a.jsx)(N.hE,{children:(0,d.t)("figmake.supabase_cost_warning_modal.title")})}),(0,a.jsx)(N.nB,{children:(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:[(0,d.t)("figmake.supabase_cost_warning_modal.body")," ",(0,a.jsx)(E.N,{href:F.Sy,newTab:!0,children:(0,d.t)("general.learn_more")})]})})}),(0,a.jsx)(N.wi,{children:(0,a.jsxs)(N.jk,{className:"x78zum5 x1q0g3np x13a6bvl x167g77z x1xn8qrt xdqyycr xh8yej3 x9f619",children:[(0,a.jsx)(i.$n,{variant:"secondary",onClick:e.onClose,children:(0,d.t)("figmake.supabase.cancel")}),(0,a.jsx)(i.$n,{variant:"destructive",onClick:()=>{e.onClose(),s()},children:(0,d.t)("figmake.supabase_cost_warning_modal.submit")})]})})]})})},"SupabaseCostWarningModal");var H=s(873657);function B({onSubmit:e,toolCallId:t,toolName:s,trackingContext:i,source:l}){let{existingProjects:c,isLoading:o}=(0,g.tE)(),x=function({onSubmit:e,toolCallId:t,toolName:s,trackingContext:a,source:n}){let{needsToPauseProject:r}=(0,g.Lz)(),i=(0,_.h5)({toolCallId:t,toolName:s,trackingContext:a,source:n}),l=G({toolCallId:t,toolName:s,trackingContext:a,source:n}),c=function({toolCallId:e,toolName:t,trackingContext:s,source:a}){let n=(0,k.wA)();return()=>n((0,S.to)({type:$,data:{toolCallId:e,toolName:t,trackingContext:s,source:a},showModalsBeneath:!0}))}({toolCallId:t,toolName:s,trackingContext:a,source:n}),o=function(){let{organization:e}=(0,g.mS)();return e?.plan!=="free"}();return()=>{if(e&&e(),o){c();return}if(r){l();return}i()}}({onSubmit:e,toolCallId:t,toolName:s,trackingContext:i,source:l});if(o)return(0,a.jsx)(n.k,{});let u=c.filter(e=>e.status.toLowerCase()!==g.TL.REMOVED);return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"xt970qd x1hr3lfm",children:(0,a.jsx)(r.E,{"aria-label":(0,d.t)("figmake.settings.connect_existing_project.create_project.button"),onClick:x,children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1v2ro7d",children:[(0,a.jsx)(K,{}),(0,a.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:(0,d.t)("figmake.settings.connect_existing_project.create_project.button")})]})})}),(0,a.jsx)("div",{className:"xyamay9 x1l90r2v",children:(0,a.jsx)(q.cG,{})}),(0,a.jsx)("div",{className:"x78zum5 xdt5ytf xou54vl xt970qd x1hr3lfm xl56j7k x1cy8zhl",children:u.map(n=>(0,a.jsx)(V,{project:n,onSubmit:e,toolCallId:t,toolName:s,trackingContext:i,source:l},n.id))})]})}function V({project:e,onSubmit:t,toolCallId:s,toolName:n,trackingContext:r,source:l}){let _=e.status.toLowerCase()===g.TL.INACTIVE||e.status.toLowerCase()===g.TL.PAUSING,j=function({onSubmit:e,project:t,isPaused:s,toolCallId:a,toolName:n,source:r,trackingContext:i}){let{needsToPauseProject:l}=(0,g.Lz)(),x=(0,u.tS)(),{organization:d}=(0,g.mS)(),_=d?.id,[,j]=(0,o.IT)((0,O.TT)({fileKey:x})),[,k]=(0,o.IT)((0,O.YF)({fileKey:x})),v=(0,H.S)(),b=(0,c.Xr)(f.Kj),N=async()=>{if(!x||!_){console.error("No open file key or organization ID found");return}e&&e(),b({project:t,state:"connecting"});try{await h.R.connectFile({fileKey:x,supabaseProjectId:t.id,supabaseOrgId:_})}catch(e){(0,y.AW)(e),b(null)}if((0,p.uF)(i||{persistentEntityId:"",clientLifecycleId:""},r,x,"existing"),await j.refetch(),s){try{await h.R.restoreFile({fileKey:x})}catch(e){(0,y.oT)(e),b(null)}C()}else E()},C=()=>{let e=setInterval(async()=>{let t=await m.M4.fetch((0,O.TT)({fileKey:x}),{policy:"networkOnly"});t?.connectedProject?.status.toLowerCase()===g.TL.ACTIVE_HEALTHY&&(clearInterval(e),E(),k.refetch())},2e3)},E=()=>{b(null),a&&n&&v({toolCallId:a,toolName:n,toolResult:{success:!0,message:"Connected to Supabase."}})},w=G({toolCallId:a,toolName:n,connectToExistingProject:N,trackingContext:i,source:r});return async()=>{s&&l?(e&&e(),w()):await N()}}({project:e,isPaused:_,onSubmit:t,toolCallId:s,toolName:n,trackingContext:r,source:l});return(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x1v2ro7d xh8yej3",children:[(0,a.jsx)(q.mj,{variant:"existing_project",inactive:_}),(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 x1v2ro7d xh8yej3",children:[(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1cy8zhl",children:[(0,a.jsx)("p",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:e.name}),(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x1cy8zhl x1jnr06f",children:[(0,a.jsx)(W,{isPaused:_}),(0,a.jsx)("span",{children:"\xb7"}),(0,a.jsx)("span",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,d.tx)("figmake.settings.pause_project.created",{timestamp:(0,a.jsx)(x.h1,{date:e.created_at})})})]})]}),(0,a.jsx)(i.$n,{variant:"secondary",onClick:j,children:(0,d.t)("figmake.settings.connect_existing_project.project.button")})]})]},e.id)}function W({isPaused:e}){return e?(0,a.jsx)("span",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh x1n0bwc9",children:(0,d.t)("figmake.settings.connect_existing_project.status.project.paused")}):(0,a.jsx)("span",{className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh xq6u9c4",children:(0,d.t)("figmake.settings.connect_existing_project.status.project.active")})}function K(){return(0,a.jsx)("div",{className:"x78zum5 x1td3qas x10w6t97 xfawy5m xl56j7k x6s0dn4 x1sxf85j x30nh5c",children:(0,a.jsx)(l.e,{})})}},847714:(e,t,s)=>{s.d(t,{Z:()=>x});var a=s(104076),n=s(929302),r=s(91478),i=s(268389);s(120440);var l=s(192075),c=s(959834),o=s(108429);let x=(0,c.Ju)(function(e){let t=n.hS({open:e.open,onClose:e.onClose});return(0,a.jsx)(r.bL,{manager:t,width:386,children:(0,a.jsxs)(i.vo,{children:[(0,a.jsx)(i.Y9,{children:(0,a.jsx)(i.hE,{children:(0,l.t)("figmake.connect_existing_projects_modal.title")})}),(0,a.jsx)(i.nB,{children:(0,a.jsx)("div",{className:"x1y1aw1k x1l90r2v",children:(0,a.jsx)(o.K,{onSubmit:e.onClose,toolCallId:e.toolCallId,toolName:e.toolName,trackingContext:e.trackingContext,source:e.source})})})]})})},"SupabaseConnectExistingProjectsModal")},972700:(e,t,s)=>{s.d(t,{AP:()=>I,h5:()=>O});var a=s(104076),n=s(716976),r=s(903927),i=s(929302),l=s(91478),c=s(268389),o=s(293422),x=s(216940),d=s(4921),u=s(633770),m=s(782747),h=s(243816);s(120440);var p=s(377842),g=s(192075),f=s(366535),_=s(506192),y=s(211862),j=s(710211),k=s(304425),v=s(959834),b=s(954741),N=s(577932),C=s(886597),E=s(622018),w=s(10074),z=s(647178),T=s(873657);function S({value:e,setValue:t,disabled:s}){let n=(0,g.t)("figmake.settings.create_project_modal.project_name.label"),r=(0,g.t)("figmake.settings.create_project_modal.project_name.placeholder");return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1v2ro7d",children:[(0,a.jsx)("div",{className:"x78zum5 x1q0g3np x1qughib",children:(0,a.jsx)("label",{htmlFor:n,className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:n})}),(0,a.jsx)("div",{className:"x78zum5 xdt5ytf x1jnr06f",children:(0,a.jsx)(x.p,{type:"text",id:n,value:e,onChange:t,placeholder:r,size:"lg",disabled:s})})]})}function A({value:e,setValue:t,helperText:s,disabled:r}){let i=(0,g.t)("figmake.settings.create_project_modal.db_pass.label"),l=(0,g.t)("figmake.settings.create_project_modal.db_pass.placeholder"),[c,o]=n.useState(!1),[f,_]=n.useState(!1);return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1v2ro7d",children:[(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib",children:[(0,a.jsx)("label",{htmlFor:i,className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:i}),(0,a.jsxs)("button",{onClick:e=>{e.preventDefault(),t((0,p.b)()),_(!0),o(!0),setTimeout(()=>{o(!1)},500)},className:"x1lcq9ky x1n0bwc9 x78zum5 x1q0g3np",children:[(0,a.jsx)(u._,{...{0:{className:"xmauxvm"},1:{className:"xzpxq2u xxkxylk xmauxvm"}}[!!c<<0]}),(0,a.jsx)("span",{children:(0,g.t)("figmake.settings.create_project_modal.password.generate")})]})]}),(0,a.jsxs)("div",{className:"x1n2onr6 x1rg5ohu",children:[(0,a.jsx)(x.p,{type:f?"text":"password",id:i,value:e,onChange:t,placeholder:l,size:"lg",disabled:r}),(0,a.jsx)("span",{className:"x10l6tqk x19up5dg xbfrwjf xmauxvm",children:(0,a.jsx)(d.f,{checked:f,onIcon:(0,a.jsx)(m._,{}),offIcon:(0,a.jsx)(h.j,{}),"aria-label":(0,g.t)("figmake.settings.create_project_modal.password.view_hide"),htmlAttributes:{"data-tooltip":(0,g.t)("figmake.settings.create_project_modal.password.view_hide"),"data-tooltip-type":"text"},onChange:()=>_(e=>!e)})})]}),s&&(0,a.jsx)("div",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:s})]})}var L=(e=>(e.US_EAST_1="us-east-1",e.US_EAST_2="us-east-2",e.US_WEST_1="us-west-1",e.AP_SOUTHEAST_1="ap-southeast-1",e.AP_NORTHEAST_1="ap-northeast-1",e.AP_NORTHEAST_2="ap-northeast-2",e.AP_SOUTHEAST_2="ap-southeast-2",e.EU_WEST_1="eu-west-1",e.EU_WEST_2="eu-west-2",e.EU_WEST_3="eu-west-3",e.EU_NORTH_1="eu-north-1",e.EU_CENTRAL_1="eu-central-1",e.EU_CENTRAL_2="eu-central-2",e.CA_CENTRAL_1="ca-central-1",e.AP_SOUTH_1="ap-south-1",e.SA_EAST_1="sa-east-1",e))(L||{});function q({selectedRegion:e,setSelectedRegion:t}){let s=(0,r.wA)(),n=(0,_.Um)(),i=e=>{switch(e){case"us-east-1":return(0,g.t)("figmake.settings.create_project_modal.region.us_east_1");case"us-east-2":return(0,g.t)("figmake.settings.create_project_modal.region.us_east_2");case"us-west-1":return(0,g.t)("figmake.settings.create_project_modal.region.us_west_1");case"ap-southeast-1":return(0,g.t)("figmake.settings.create_project_modal.region.ap_southeast_1");case"ap-northeast-1":return(0,g.t)("figmake.settings.create_project_modal.region.ap_northeast_1");case"ap-northeast-2":return(0,g.t)("figmake.settings.create_project_modal.region.ap_northeast_2");case"ap-southeast-2":return(0,g.t)("figmake.settings.create_project_modal.region.ap_southeast_2");case"eu-west-1":return(0,g.t)("figmake.settings.create_project_modal.region.eu_west_1");case"eu-west-2":return(0,g.t)("figmake.settings.create_project_modal.region.eu_west_2");case"eu-west-3":return(0,g.t)("figmake.settings.create_project_modal.region.eu_west_3");case"eu-north-1":return(0,g.t)("figmake.settings.create_project_modal.region.eu_north_1");case"eu-central-1":return(0,g.t)("figmake.settings.create_project_modal.region.eu_central_1");case"eu-central-2":return(0,g.t)("figmake.settings.create_project_modal.region.eu_central_2");case"ca-central-1":return(0,g.t)("figmake.settings.create_project_modal.region.ca_central_1");case"ap-south-1":return(0,g.t)("figmake.settings.create_project_modal.region.ap_south_1");case"sa-east-1":return(0,g.t)("figmake.settings.create_project_modal.region.sa_east_1");default:throw Error("Unknown region")}};return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1v2ro7d",children:[(0,a.jsx)("label",{id:"supabase-project-database-region-select",className:"xxrns5j x1q8tae1 x1vg90ec x1eab18d x1yyillh",children:(0,g.t)("figmake.settings.create_project_modal.region.label")}),(0,a.jsx)(b.l6,{ariaLabelledBy:"supabase-project-database-region-select",inputClassName:"x1kowl60 x6sinrp",id:"supabase-project-database-region-select",property:e,formatter:{format:i},onChange:t,dispatch:s,dropdownShown:n,children:Object.values(L).map(e=>(0,a.jsx)(b.c$,{value:e,children:i(e)},e))})]})}let I=(0,v.Ju)(function(e){let[t,s]=(0,n.useState)(!1),r=i.hS({...e,preventUserClose:t}),x=(0,y.q5)(),[d,u]=(0,n.useState)(x?.name||""),[m,h]=(0,n.useState)(""),[p,f]=(0,n.useState)(),[_,v]=(0,n.useState)("us-east-1"),[b,L]=(0,n.useState)(!1),[I,O]=(0,n.useState)(!0),[M,F]=(0,n.useState)(!1),D=(0,T.S)(),{toolCallId:R,toolName:P,onClose:U}=e,G=(0,n.useCallback)(()=>{L(!1),s(!1),F(!1),R&&P&&D({toolCallId:R,toolName:P,toolResult:{success:!0,message:"Connected to Supabase."}}),U()},[R,P,D,U]);!function(e,t,{intervalMsBetweenAttempts:s=2e3,enabled:a=!1,maxAttempts:r=5}={}){let i=(0,n.useRef)(!1);(0,n.useEffect)(()=>{if(!a||i.current)return;let n=!1;i.current=!0;let l=0,c=e=>new Promise(t=>setTimeout(t,e));return(async()=>{for(;!n&&l<r;){l++;try{if(await e()){t();break}}catch(e){console.error(e)}finally{await c(s)}}})(),()=>{n=!0,i.current=!1}},[a,s,e,r,t])}((0,n.useCallback)(async()=>{if(!x)return!1;let{connectedProject:e}=await j.M4.fetch((0,C.TT)({fileKey:x.key}),{policy:"networkOnly"});return!!e?.public_anon_key},[x]),G,{intervalMsBetweenAttempts:2e3,enabled:M}),(0,n.useEffect)(()=>{d.length>0&&m.length>0?O(!1):O(!0),m.length>=4&&f(void 0)},[d,m]);let $=async()=>{if(!x)return;if(m.length<4){f("dbPassTooShort");return}s(!0),L(!0);let t=await k.R.createProject({fileKey:x.key,projectName:d,dbPass:m,region:_}).then(e=>{let{id:t,organization_id:s,name:a,region:n,created_at:r,status:i}=e.data.meta;return{id:t,organization_id:s,name:a,region:n,created_at:r,status:i}}).catch(e=>{(0,z.YH)(e)});if(!t||!await k.R.connectFile({fileKey:x.key,supabaseProjectId:t.id,supabaseOrgId:t.organization_id}).catch(e=>{(0,z.AW)(e)})){L(!1);return}(0,N.uF)(e.trackingContext||{persistentEntityId:"",clientLifecycleId:""},e.source,x.key,"new"),F(!0)},H="dbPassTooShort"===p?(0,g.tx)("figmake.settings.create_project_modal.db_pass.too_short"):(0,g.tx)("figmake.settings.create_project_modal.db_pass.context",{learnMoreLink:(0,a.jsx)("a",{target:"_blank",href:w.kS,children:(0,g.t)("general.learn_more")})});return(0,a.jsx)(l.bL,{manager:r,width:386,children:(0,a.jsxs)(l.Rq,{onSubmit:$,children:[(0,a.jsx)(c.Y9,{children:(0,a.jsx)(c.hE,{children:(0,g.t)("figmake.settings.create_project_modal.title")})}),(0,a.jsx)(c.nB,{scrolling:"none",children:(0,a.jsxs)("div",{className:"x1vvogim xnjsko4 x78zum5 xdt5ytf x1c1vhfx",children:[(0,a.jsx)(S,{value:d,setValue:u,disabled:b}),(0,a.jsx)(q,{selectedRegion:_,setSelectedRegion:v}),(0,a.jsx)(A,{value:m,setValue:h,helperText:H,disabled:b})]})}),(0,a.jsx)(c.wi,{children:(0,a.jsxs)(c.jk,{className:"x78zum5 x1q0g3np x13a6bvl x167g77z x1xn8qrt xdqyycr xh8yej3 x9f619",children:[b&&(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,g.t)("figmake.supabase.creating_project.subtitle")}),(0,a.jsx)(o.$n,{variant:"secondary",onClick:()=>r.props.close({source:"button"}),children:(0,g.t)("figmake.settings.create_project_modal.button.cancel")}),b?(0,a.jsx)(E.lV,{variant:"primary",children:(0,g.t)("figmake.settings.create_project_modal.button.submit.loading")}):(0,a.jsx)(o.$n,{variant:"primary",type:"submit",disabled:I,children:(0,g.t)("figmake.settings.create_project_modal.button.submit")})]})})]})})},"CreateProjectModal");function O({toolCallId:e,toolName:t,trackingContext:s,source:a}){let n=(0,r.wA)();return()=>n((0,f.to)({type:I,data:{toolCallId:e,toolName:t,trackingContext:s,source:a},showModalsBeneath:!0}))}},647178:(e,t,s)=>{s.d(t,{AW:()=>d,EQ:()=>h,YH:()=>c,ZH:()=>o,fQ:()=>x,lN:()=>m,oT:()=>u,wH:()=>l});var a=s(638004),n=s(550209),r=s(253066),i=s(649431);function l(e){(0,r.r)(),(0,n.$D)(a.e.AI_FOR_PRODUCTION,e)}function c(e){if(e.message.match(/^(.*?)Project with name (.+?) already exists in your organization\.$/)){(0,i.ym)();return}if(e.message.match(/^(.*)maximum limits for the number of active free projects(.*)$/)){(0,i.ZK)();return}(0,i.u)(),l(e)}function o(e){(0,i.it)(),l(e)}function x(e){l(e)}function d(e){(0,i.jx)(),l(e)}function u(e){(0,i.n9)(),l(e)}function m(e){(0,i.m8)(),l(e)}class h extends Error{constructor(){super("No index.tsx file found in the code files"),this.name="NoIndexFileError"}}},622018:(e,t,s)=>{s.d(t,{cG:()=>M,jc:()=>q,lV:()=>I,ls:()=>O,Gt:()=>S,p1:()=>A,mj:()=>w});var a=s(104076),n=s(293422),r=s(827695),i=s(683642);s(120440);var l=s(652539),c=s(772963),o=s(192075),x=s(142914),d=s(716976),u=s(903927),m=s(638004),h=s(454851),p=s(781767),g=s(686549),f=s(550209),_=s(506192),y=s(211862),j=s(894210),k=s(304425),v=s(405223),b=s(10074);function N({connectedOrg:e}){let t=(0,y.tS)()||"",s=(0,u.wA)(),n=(0,_.BK)("CONNECTED_ORG_MORE_MENU"),r=d.useCallback(async()=>{try{await k.R.deauthorizeFile({fileKey:t})}catch(e){(0,f.$D)(m.e.AI_FOR_PRODUCTION,e)}},[t]),i=d.useMemo(()=>[{displayText:(0,o.t)("figmake.settings.connected_project.dropdown.manage_organization"),callback:()=>{(0,g.FJ)((0,b.n1)(e.id))}},{displayText:"",separator:!0},{displayText:(0,o.t)("figmake.settings.connected_org.dropdown.disconnect"),callback:()=>{r()}}],[e,r]),l=d.useRef(null),c=l.current?.getBoundingClientRect();return c||(n.showing&&(0,f.$D)(m.e.AI_PRODUCTIVITY,Error("FigMake connected project view: dropdownBoundingRect is null")),c=new DOMRect(0,0,0,0)),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.d,{"aria-expanded":n.showing,ref:l,"aria-label":(0,o.t)("figmake.settings.connected_org.dropdown.label"),onClick:()=>n.toggle(),htmlAttributes:{"data-tooltip-type":j.Ib.TEXT,"data-tooltip":(0,o.t)("figmake.settings.connected_org.dropdown.label")},children:(0,a.jsx)(p.J,{})}),n.showing&&(0,a.jsx)(v.j,{dispatch:s,parentRect:c,onSelectItem:e=>{e.callback&&e.callback()},showPoint:!1,items:i,lean:"left"})]})}var C=s(32404),E=s(114344);function w({inactive:e,variant:t="connected_project"}){return(0,a.jsx)("div",{...e?{className:"x78zum5 xl56j7k x6s0dn4 x1sxf85j x1v8gsql"}:{className:"x78zum5 xl56j7k x6s0dn4 x1sxf85j x1606gwu"},style:"existing_project"===t?{width:"32px",height:"32px"}:{width:"40px",height:"40px",border:"1px solid var(--color-border)"},children:(0,a.jsx)(l.B,{svg:E.A,useOriginalSrcFills_DEPRECATED:!0,svgWidth:"16px",svgHeight:"16px",style:{filter:e?"grayscale(100%)":void 0}})})}function z(){let{organization:e}=(0,C.mS)();return(0,a.jsx)("div",{className:"x1tamke2 xh8yej3 x9f619",children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xh8yej3",children:[(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1nhvcw1 xdpxx8g",children:[e&&(0,a.jsx)(c.G,{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly x256u9z xuxw1ft xb3r6kr xlyipyv",text:e?.name}),(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,o.t)("figmake.settings.project.org_info.title")})]}),e&&(0,a.jsx)(N,{connectedOrg:e})]})})}function T(){return(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1qughib x1cy8zhl xdpxx8g x1y8v6su x1tamke2 xh8yej3 x9f619",children:[(0,a.jsx)("p",{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly",children:(0,o.t)("figmake.settings.project.header.title")}),(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9",children:(0,o.t)("figmake.settings.project.header.subtitle")})]})}function S({showDefaultHeader:e=!1,children:t}){return(0,a.jsxs)(a.Fragment,{children:[e?(0,a.jsx)(T,{}):(0,a.jsx)(z,{}),(0,a.jsx)(M,{}),t]})}function A({badge:e,actions:t,inactive:s,header:n,subheader:r}){return(0,a.jsx)("div",{className:"x1tamke2",children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 xh8yej3",children:[(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x1nhvcw1 x6s0dn4 x1v2ro7d",children:[(0,a.jsx)(w,{inactive:s}),(0,a.jsxs)("div",{className:"x78zum5 xdt5ytf x1nhvcw1 x1cy8zhl",children:[(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:[(0,a.jsx)(c.G,{className:"xrbesu5 x12cwyba x1l993ej x1ejgcx7 x1aos5ly x1racy4e xuxw1ft xb3r6kr xlyipyv",text:n}),e]}),r||(0,a.jsx)(L,{})]})]}),(0,a.jsx)("div",{className:"x78zum5 x1q0g3np x6s0dn4 x167g77z",children:t})]})})}function L(){return(0,a.jsx)(c.G,{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up x1n0bwc9 x256u9z xuxw1ft xb3r6kr xlyipyv",text:(0,o.t)("figmake.settings.project.project_info.title")})}function q({url:e,linkText:t}){return(0,a.jsxs)("a",{className:"x78zum5 x1q0g3np x1qughib x6s0dn4 x1wt4b31 xebhuq6",target:"_blank",href:e,children:[(0,a.jsx)(i.S,{}),(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:t})]})}function I({variant:e,children:t}){return(0,a.jsx)(n.$n,{variant:e,disabled:!0,children:(0,a.jsxs)("div",{className:"x78zum5 x1q0g3np x6s0dn4",children:[(0,a.jsx)(r.k,{}),(0,a.jsx)("p",{className:"xrlp15q x1nmd3yn xm735u9 xkbmbem x3wk4up",children:t})]})})}function O({size:e}){let t=(0,C.RK)();return t?(0,a.jsx)(x.H8,{user:t,size:e}):null}function M(){return(0,a.jsx)("div",{className:"x178xt8z x13fuv20 x16ufvko xh8yej3"})}},873657:(e,t,s)=>{s.d(t,{S:()=>d});var a=s(651234),n=s(266808),r=s(211862),i=s(592726),l=s(580276),c=s(121363),o=s(191182),x=s(963433);function d(){let e=(0,r.tS)(),{codeLibraryInstance:t}=(0,x.oA)(),s=(0,i.iZ)(),d=(0,l.Xu)(),u=(0,c.P)();return({toolCallId:r,toolName:i,toolResult:l})=>{n.glU&&s&&t&&(0,o.O)({clientSideToolResult:{toolCallId:r,toolName:i,result:l},user:s,chatMessagesNode:t,rawUserChatDetails:void 0,featureType:a.lV.FIGMAKE,setInput:()=>{},fileKey:e,autoFixingUserMessageId:null,onFinish:()=>{},model:u,canUseSupabase:d})}}},649431:(e,t,s)=>{s.d(t,{A9:()=>_,SR:()=>y,ZK:()=>d,it:()=>p,jx:()=>m,l4:()=>g,m8:()=>j,n9:()=>h,rq:()=>f,u:()=>u,ym:()=>x});var a=s(686549),n=s(725837),r=s(192075),i=s(58212),l=s(638641),c=s(10074),o=(e=>(e.PROJECT_NAME_TAKEN="supabase-project-name-taken",e.ACTIVE_FREE_PROJECT_LIMIT="supabase-active-free-project-limit",e.PROJECT_CREATION_UNSUCCESSFUL="supabase-project-creation-unsuccessful",e.PROJECT_CONNECTION_UNSUCCESSFUL="supabase-project-connection-unsuccessful",e.PROJECT_RESTORE_UNSUCCESSFUL="supabase-project-restore-unsuccessful",e.PAUSING_PROJECT_UNSUCCESSFUL="supabase-pausing-project-unsuccessful",e.PAUSING_PROJECT_SUCCESSFUL="supabase-pausing-project-successful",e.DEPLOY_UNSUCCESSFUL="supabase-deploy-unsuccessful",e.DEPLOY_SUCCESSFUL="supabase-deploy-successful",e.NOTHING_TO_DEPLOY="supabase-nothing-to-deploy",e.AUTHENTICATION_UNSUCCESSFUL="supabase-authentication-unsuccessful",e))(o||{});function x(){n.D.dispatch(i.F.enqueue({message:(0,r.t)("figmake.supabase.errors.project_name_taken"),type:"supabase-project-name-taken",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function d(){n.D.dispatch(i.F.enqueue({message:(0,r.t)("figmake.supabase.errors.project_creation_unsuccessful.need_to_pause"),type:"supabase-active-free-project-limit",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0,button:{text:(0,r.t)("figmake.supabase.errors.project_creation_unsuccessful.need_to_pause.button"),action:()=>{(0,a.FJ)(c.v7,"_blank")}}}))}function u(){n.D.dispatch(i.F.enqueue({message:(0,r.t)("figmake.supabase.errors.project_creation_unsuccessful"),type:"supabase-project-creation-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function m(){n.D.dispatch(i.F.enqueue({message:(0,r.t)("figmake.supabase.errors.project_connection_unsuccessful"),type:"supabase-project-connection-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function h(){n.D.dispatch(i.F.enqueue({message:(0,r.t)("figmake.supabase.errors.project_restore_unsuccessful"),type:"supabase-project-restore-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function p(){n.D.dispatch(i.F.enqueue({message:(0,r.t)("figmake.supabase.errors.pausing_project_unsuccessful"),type:"supabase-pausing-project-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function g(){n.D.dispatch(i.F.enqueue({message:(0,r.t)("figmake.supabase.errors.pausing_project_successful"),type:"supabase-pausing-project-successful",icon:l.zX.CHECK,timeoutOverride:3e3}))}function f(){n.D.dispatch(i.F.enqueue({message:(0,r.t)("figmake.supabase.errors.deploy_unsuccessful"),type:"supabase-deploy-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function _(){n.D.dispatch(i.F.enqueue({message:(0,r.t)("figmake.supabase.errors.deploy_successful"),type:"supabase-deploy-successful",icon:l.zX.CHECK,timeoutOverride:3e3}))}function y(){n.D.dispatch(i.F.enqueue({message:(0,r.t)("figmake.supabase.errors.nothing_to_deploy"),type:"supabase-nothing-to-deploy",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}function j(){n.D.dispatch(i.F.enqueue({message:(0,r.t)("figmake.supabase.errors.authentication_unsuccessful"),type:"supabase-authentication-unsuccessful",icon:l.zX.EXCLAMATION,timeoutOverride:3e3,error:!0}))}},836543:(e,t,s)=>{s.d(t,{A:()=>g});var a=s(542653),n=s(795033),r=s(316862),i=s(211862),l=s(710211),c=s(304425),o=s(293172),x=s(574433),d=s(963433),u=s(647178),m=s(886597),h=s(588961),p=s(649431);function g(){let e=(0,n.Xr)(o.p7),{entryPointCodeInstance:t}=(0,d.oA)(),s=(0,x.vD)(t?.guid??null),g=(0,x.I4)(s),f=(0,i.tS)(),_=(0,n.Xr)(o.Xl),y=(0,n.Xr)(o.GV),j=(0,n.Xr)(h.GA),[,k]=(0,h.PM)();return async t=>{let{showVisualBells:s}=t;if(!f){console.error("No open file key found");return}try{e(o.Ut.DEPLOYING);let t=(0,a.$d)(),n={};for(let[e,s]of Object.entries(t))if(e.includes("/supabase/functions/server/")){let t=e.split("/").pop(),a=s.sourceCode;t&&a&&(n[t]=a)}if(!n["index.tsx"])throw new u.EQ;let r=await c.R.deployEdgeFunction({fileKey:f,files:n});j(r.data.meta.version),(0,h.ZO)(),setTimeout(()=>{l.M4.fetch((0,m.gZ)({fileKey:f,functionName:"make-server"}),{policy:"networkOnly"})},5e3),g(),s&&(0,p.A9)()}catch(t){if(t instanceof u.EQ){s&&(0,p.SR)();return}s&&(0,p.rq)(),(0,u.wH)(t);let e={id:(0,r.g)(),event_message:`Error while deploying: ${t instanceof Error?t.message:String(t)}`,timestamp:Date.now().toString(),level:"error"};k(t=>[...t,e])}finally{e(o.Ut.INIT),_(!1),y(!1)}}}},130724:(e,t,s)=>{s.d(t,{_:()=>n});var a=s(104076);let n=(0,s(716976).memo)(function(e){return(0,a.jsx)("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 16 16",...e,children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color-3, var(--color-icon-tertiary))",fillRule:"evenodd",d:"M8.5 2.568c0-.295.252-.529.543-.478q.521.092 1.009.27c.277.1.379.43.231.685a.544.544 0 0 1-.652.227 5 5 0 0 0-.68-.181.544.544 0 0 1-.451-.523m-4.953 8.58a.54.54 0 0 1 .677.13q.231.266.498.498c.196.17.259.453.13.677-.148.256-.484.332-.71.142a6 6 0 0 1-.737-.737c-.19-.226-.114-.562.142-.71m2.822 1.58a.544.544 0 0 0-.652.227.47.47 0 0 0 .231.685q.487.178 1.01.27a.47.47 0 0 0 .542-.478.544.544 0 0 0-.452-.522 5 5 0 0 1-.68-.182m5.49-9.323a.47.47 0 0 0-.71.142.544.544 0 0 0 .129.677q.266.231.498.498c.17.196.453.259.677.13.256-.148.332-.484.142-.71a6 6 0 0 0-.737-.737m1.096 6.878a.47.47 0 0 0 .685-.231q.178-.487.27-1.01a.47.47 0 0 0-.478-.542.544.544 0 0 0-.523.452q-.066.35-.181.679a.544.544 0 0 0 .227.652m-.36 1.575c.19-.226.114-.562-.142-.71a.544.544 0 0 0-.677.13q-.231.266-.498.498a.54.54 0 0 0-.13.677c.148.256.484.332.71.142q.4-.336.737-.737M10.05 13.64c.277-.1.379-.43.231-.685a.544.544 0 0 0-.652-.227q-.33.114-.68.182a.544.544 0 0 0-.451.522c0 .295.252.529.543.478q.522-.092 1.009-.27M5.717 3.045c.13.225.407.312.652.227q.33-.114.68-.181a.544.544 0 0 0 .45-.523c0-.295-.252-.529-.542-.478q-.522.092-1.009.27c-.277.1-.379.43-.231.685m-1.575.36c.226-.19.562-.114.71.142a.54.54 0 0 1-.13.677 5 5 0 0 0-.498.498.54.54 0 0 1-.677.13c-.256-.148-.332-.484-.142-.71q.336-.4.737-.737M3.045 5.717a.47.47 0 0 0-.685.231 6 6 0 0 0-.27 1.01.47.47 0 0 0 .478.542c.26 0 .473-.197.522-.452q.068-.35.182-.679a.544.544 0 0 0-.227-.652M2.568 8.5c-.295 0-.529.252-.478.543q.092.522.27 1.009c.1.277.43.379.685.231a.544.544 0 0 0 .227-.652 5 5 0 0 1-.182-.68.544.544 0 0 0-.522-.451m10.864-1a.544.544 0 0 1-.523-.452 5 5 0 0 0-.181-.679.544.544 0 0 1 .227-.652.47.47 0 0 1 .685.231q.178.487.27 1.01a.47.47 0 0 1-.478.542",clipRule:"evenodd"})})})},336129:(e,t,s)=>{s.d(t,{D:()=>n});var a=s(104076);let n=(0,s(716976).memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M14 4a3 3 0 0 1 1.656 5.5A3 3 0 0 1 14 15a2.98 2.98 0 0 1-2-.769V17a3 3 0 1 1-4.657-2.5 2.996 2.996 0 0 1 0-5A3 3 0 0 1 9 4zm3.5 11a.5.5 0 0 1 .5.5V17h1.5a.5.5 0 0 1 0 1H18v1.5a.5.5 0 0 1-1 0V18h-1.5a.5.5 0 0 1 0-1H17v-1.5a.5.5 0 0 1 .5-.5M9 15a2 2 0 1 0 2 2v-2zm0-5a2 2 0 1 0 0 4h2v-4zm5 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4M9 5a2 2 0 1 0 0 4h2V5zm3 4h2a2 2 0 1 0 0-4h-2z"})})})},918552:(e,t,s)=>{s.d(t,{K:()=>n});var a=s(104076);let n=(0,s(716976).memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M11.268 4.865c1.082-1.153 2.836-1.154 3.917 0 .642.685.9 1.621.78 2.511a2.66 2.66 0 0 1 2.304.78l.05.053.034.034.05.055c1.031 1.158 1.014 2.989-.05 4.125l-5.67 6.048-.024.031a.21.21 0 0 0 .024.247l1.164 1.242a.62.62 0 0 1 0 .836.53.53 0 0 1-.784 0L11.9 19.585a1.445 1.445 0 0 1 0-1.95l5.67-6.048a1.86 1.86 0 0 0 0-2.508l-.033-.034-.03-.032a1.59 1.59 0 0 0-2.32.032l-4.735 5.05-.02.021a.53.53 0 0 1-.764-.021.62.62 0 0 1 0-.836l4.734-5.05a1.86 1.86 0 0 0 0-2.508 1.59 1.59 0 0 0-2.35 0l-6.27 6.689-.021.02a.53.53 0 0 1-.763-.02.62.62 0 0 1 0-.836zm1.567 1.672a.53.53 0 0 1 .783 0 .62.62 0 0 1 0 .836l-4.636 4.945a1.86 1.86 0 0 0 0 2.508 1.59 1.59 0 0 0 2.351 0l4.637-4.945a.53.53 0 0 1 .783 0 .62.62 0 0 1 0 .836l-4.637 4.945c-1.065 1.136-2.78 1.154-3.866.054l-.052-.054c-1.082-1.154-1.082-3.026 0-4.18z"})})})},681283:(e,t,s)=>{s.d(t,{$:()=>n});var a=s(104076);let n=(0,s(716976).memo)(function(e){return(0,a.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,a.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",d:"M11.319 4a.501.501 0 0 1 0 1.001H6.5a1.5 1.5 0 0 0-1.499 1.5v11a1.5 1.5 0 0 0 1.5 1.498h10.997A1.5 1.5 0 0 0 19 17.5v-4.802a.5.5 0 1 1 1.001 0V17.5c0 1.381-1.12 2.5-2.5 2.501H6.5a2.5 2.5 0 0 1-2.5-2.5v-11a2.5 2.5 0 0 1 2.5-2.502zm4.523.445a1.865 1.865 0 0 1 2.637 0l.964.964a1.864 1.864 0 0 1 0 2.637l-6.067 6.066c-.18.181-.396.324-.633.417l-2.303.908-.115.04c-1.196.37-2.33-.81-1.865-2.01l.899-2.314.079-.177q.133-.26.34-.467zm-5.354 6.773a.9.9 0 0 0-.158.216l-.037.082-.898 2.315a.522.522 0 0 0 .599.697l.079-.024 2.301-.907a.9.9 0 0 0 .294-.193l4.748-4.748-2.183-2.183zm7.283-6.064a.863.863 0 0 0-1.22 0l-.61.61 2.183 2.183.61-.609a.863.863 0 0 0 0-1.22z"})})})}}]);

//# debugId=e2a11c0e-7fe2-52f1-82b0-9cb3a2b9aa39

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/bda98aad7f7f1e8611e85bfe45b9157395bfed7a/7112-89ce2c1808b54df5.min.js.map