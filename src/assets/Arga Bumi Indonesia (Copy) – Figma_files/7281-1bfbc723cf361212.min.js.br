"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="7829b2fd-b375-5614-8927-f8bab3d66ea7")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([[7281],{589337:(e,a,t)=>{t.d(a,{F:()=>s,HR:()=>c,Io:()=>i,Ok:()=>r,Pn:()=>_,V_:()=>o,dK:()=>u,nM:()=>d,rH:()=>n,sQ:()=>l,ue:()=>p});let o="on_canvas_pill--pillContainer--jvRgr",s="on_canvas_pill--centered--iOUXI",i="on_canvas_pill--pill--fSukI",l="on_canvas_pill--bottom--gwvqA",n="on_canvas_pill--node--xgavI",c="on_canvas_pill--symbol--3Kz9f",r="on_canvas_pill--forceBrandColor--DynJg",d="on_canvas_pill--row--I6QoB",_="on_canvas_pill--pillLargeBorderRadius--9uWP9",u="on_canvas_pill--pillText--ts0Xi ellipsis--ellipsis--Tjyfa",p="on_canvas_pill--iconNodeType--0xm99"},832067:(e,a,t)=>{t.d(a,{N:()=>n,S:()=>c});var o=t(716976),s=t(795033);let i=(0,s.eU)(0),l=(0,s.eU)(e=>e(i)>0);function n({isVisible:e}){let a=(0,s.Xr)(i);(0,o.useLayoutEffect)(()=>{if(e)return a(e=>e+1),()=>a(e=>Math.max(0,e-1))},[e,a])}function c(){return(0,s.md)(l)}},714714:(e,a,t)=>{t.d(a,{MO:()=>b,Tq:()=>x});var o=t(104076),s=t(716976),i=t(681958),l=t(324063),n=t(511570),c=t.n(n),r=t(652539),d=t(278491),_=t(692042),u=t(271899),p=t(589337),v=t(108557),m=t(253654),h=t(839808),E=t(564837),N=t(60943),f=t(559949),I=t(372209),g=t(253373),O=t(160761),w=t(939968);let b=s.forwardRef(function(e,a){let{boundingBox:t,isFigmaPurple:s}=e.node,i=function(e,a,t,o){let s=(0,_._X)({subscribeToUpdates_expensive:!0});if(!s)return null;let i={},l=(0,_.Yb)(s,{x:e.x,y:e.y,width:e.w,height:e.h});return i.left=l.x+s.x,i.top=l.y+s.y,a&&(i.left+=l.width/2),t&&(i.top=l.y+s.y+l.height),{containerStyle:i,pillStyle:o&&{maxWidth:o(l.width)},zoomScale:s.zoomScale}}(t,e.centered,e.bottom,e.maxWidth);if(!i)return null;let{containerStyle:l,pillStyle:n}=i;return(0,o.jsx)("div",{ref:a,className:c()(d.Dm,p.V_,{[p.F]:e.centered,[p.sQ]:e.bottom}),style:{...l,marginLeft:e.offsetX??0,marginTop:e.offsetY?.(i.zoomScale)??0},"data-testid":e.dataTestId,children:(0,o.jsx)("div",{className:c()(p.Io,s?p.HR:p.rH,e.largeBorderRadius&&p.Pn,e.forceBrandColor&&p.Ok),style:n,children:e.children})})});function x({node:e}){let a=(0,l.xx)((e,a)=>(0,u.D)(e,a)),t=e?a(e.guid,e.objectsPanelThumbnailId):"",s=t?(0,r.V)(t):function(e){let a=null;switch(e.type){case"TEXT":a=O.A;break;case"FRAME":a=e.isGroup?m.A:e.isStateGroup?I.A:(0,u.GN)({stackMode:e.stackMode,stackCounterAlignItems:e.stackCounterAlignItems});break;case"ROUNDED_RECTANGLE":a=N.A;break;case"ELLIPSE":a=v.A;break;case"STAR":a=f.A;break;case"VECTOR":a=w.A;break;case"GROUP":a=m.A;break;case"INSTANCE":a=h.A;break;case"SYMBOL":a=e.isState?g.A:I.A}return(0,i.oY)(e.type)&&e.hasEnabledStaticImagePaint&&(a=E.A),a}(e);return s?(0,o.jsx)(r.B,{className:p.ue,svg:s}):null}},877578:(e,a,t)=>{t.d(a,{s:()=>av});var o=t(104076),s=t(716976),i=t(903927),l=t(377692),n=t(211862),c=t(592726),r=t(779574),d=t(286132),_=t(305651),u=t(689161),p=t(491224),v=t(511570),m=t.n(v),h=t(681398),E=t(192075),N=t(74620),f=t(459496),I=t(832067),g=t(894210),O=t(122010),w=t(737139),b=t(49875),x=t(623355);let j="voice_widget--modal--xsQ2A",T="voice_widget--show--O6ORx voice_widget--modal--xsQ2A",D="voice_widget--topRow--O1wj-",R="voice_widget--voiceModalPanel--KD-J1";function C(e){let{fileKey:a}=e;var{userIdsInCall:t}=(0,d.W5)(a);let i=t.size,l=(0,N.aV)(),n=(0,c.iZ)();s.useEffect(()=>{!h.XN&&n?.id&&!t.has(n.id)&&(0,f.w$)(i)},[i,n?.id,t]);let r=!l&&!h.XN;return((0,I.N)({isVisible:r}),r)?(0,o.jsx)("div",{className:m()(j,T),children:(0,o.jsx)(u.T,{children:(0,o.jsx)(O.m,{role:"region",children:(0,o.jsx)(w.Id,{className:R,children:(0,o.jsxs)("div",{className:D,children:[(0,o.jsxs)("div",{className:"voice_widget--joinModalCountGroup--zxI6Q","aria-label":(0,E.t)("collaboration.voice.num_users_in_call",{numUsers:t.size}),role:"img",children:[(0,o.jsx)(p.D,{className:x.QH}),t.size]}),(0,o.jsx)(b.K,{fileKey:e.fileKey,"data-tooltip-type":g.Ib.TEXT,"data-tooltip":(0,E.t)("collaboration.voice.join_conversation"),isJoinWidget:!0,"data-onboarding-key":"audio-nux-key",children:(0,E.tx)("collaboration.voice.join")})]})})})})}):(0,o.jsx)(o.Fragment,{})}var A=t(492737),y=t(454851),k=t(684742),S=t(784161),L=t(755444),W=t(134873),P=t(432099),U=t(147046),$=t(366535),M=t(249586),G=t(11033),B=t(40452),V=t(765846),H=t(826160),F=t(523783),z=t(856909),X=t(652539),J=t(111679),Y=t(506192),K=t(405223),q=t(87535);let Q="captions_dialog--showGradient--ZAHRk";var Z=t(789982),ee=t(918452);let ea="DROPDOWN_TYPE_CAPTIONS_DIALOG_TYPE_SIZE";function et({caption:e,user:a}){let t=e.userId+"_"+e.timestamp;return(0,o.jsxs)("div",{className:"captions_dialog--captionRow--pgS-N",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(H.Ro,{className:"captions_dialog--avatar--ISexR",entity:{...a,id:e.userId},size:24}),(0,o.jsx)("div",{className:"captions_dialog--name--SmWv6",children:a?a.name:e.userId})]}),e.text.map((e,a)=>(0,o.jsx)("div",{className:"captions_dialog--paragraph--SjDQd",children:e.map((e,s)=>(0,o.jsx)("div",{className:"captions_dialog--sentence--SJkHn",children:`${e} `},t+"_"+a+"_"+s))},t+"_"+a))]},t)}let eo=()=>({small:{style:"captions_dialog--smallText--aUeBx",label:(0,E.t)("collaboration.voice.small")},medium:{style:"captions_dialog--mediumText--ODxEN",label:(0,E.t)("collaboration.voice.medium")},large:{style:"captions_dialog--largeText---t1d2",label:(0,E.t)("collaboration.voice.large")},x_large:{style:"captions_dialog--xlargeText--C60DA",label:(0,E.t)("collaboration.voice.x_large")}}),es=Date.now();function ei({call:e}){let a=eo(),[t,l]=s.useState([]),[c,r]=s.useState(a.small.style),[_,u]=s.useState(!1),[p,v]=s.useState(!1),[m,h]=s.useState(!1),N=(0,n.q5)();if(!N)throw Error("Open file required");let f=(0,i.d4)(e=>e.voice.activeCall[N.key]),I=(0,i.wA)(),[O,w]=s.useState(null),b=(0,Y.Um)(),x=s.useRef(null),j=!!(b&&b.type===ea),T=t.reduce((e,a)=>e.add(a.userId),new Set),D=(0,d.bF)(T,N.key).reduce((e,a)=>(e[a.userID]=a,e),{});s.useEffect(()=>{let a=e=>{e&&l(e)};return e.audioCaptionStream.subscribe(a),()=>e.audioCaptionStream.unsubscribe(a)}),s.useEffect(()=>{O&&O.scrollHeight-O.scrollTop-O.clientHeight<150&&es<Date.now()-150&&O.scrollTo({top:O.scrollHeight-O.clientHeight,behavior:"smooth"})}),s.useEffect(()=>{O&&!m&&(O.scrollTop=O.scrollHeight-O.clientHeight)},[O,m]);let R=!m&&f;return(0,o.jsxs)("div",{className:["captions_dialog--captionsDialog--gOIvh",c].join(" "),children:[(0,o.jsx)("div",{className:["captions_dialog--topDivider--BlM0x captions_dialog--_divider--m8Skg",_?Q:""].join(" ")}),R&&(0,o.jsx)("div",{className:"captions_dialog--scrollContainer--WuVOJ",ref:e=>w(e),onScroll:e=>{O&&(v(0!=O.scrollHeight-O.scrollTop-O.clientHeight),u(0!==O.scrollTop))},onWheel:e=>{e.deltaY<0&&(es=Date.now())},children:(0,o.jsx)("div",{className:"captions_dialog--scrollContainerInner--db2cV",children:t.map(e=>(0,o.jsx)(et,{caption:e,user:D[e.userId]},e.timestamp))})}),R&&(0,o.jsx)("div",{className:["captions_dialog--bottomDivider--WBbo5 captions_dialog--_divider--m8Skg",p?Q:""].join(" ")}),R&&(0,o.jsx)(k.E,{onClick:()=>O.scrollTo({top:O.scrollHeight-O.clientHeight,behavior:"smooth"}),className:`captions_dialog--scrollToBottomButton--SeU-4 ${p?"captions_dialog--showScrollToBottomButton--Lc7Iy":""}`,children:(0,E.tx)("collaboration.voice.new_transcripts")}),(0,o.jsxs)("div",{className:"captions_dialog--header--SA3Wv",onClick:()=>h(!m),children:[(0,o.jsx)(X.B,{className:R?"captions_dialog--closedCaptionsIconMaximized--N-lwT":"captions_dialog--closedCaptionsIconMinimized--Ou0WE",svg:Z.A}),(0,o.jsx)("span",{className:"captions_dialog--label---1DXk",children:(0,E.tx)("collaboration.voice.closed_captions")}),(0,o.jsx)(z.Ex,{text:(0,E.t)("collaboration.voice.beta"),className:"captions_dialog--betaTag--qFyxq",color:z.zE.BRAND}),(0,o.jsx)(q.K0,{svg:ee.A,ref:x,className:"captions_dialog--typeSizeIcon--Xhxj-",onClick:e=>{e.stopPropagation(),I(J.gR({type:ea}))},"data-tooltip-type":g.Ib.TEXT,"data-tooltip":(0,E.t)("collaboration.voice.text_size")}),x.current&&j&&(0,o.jsx)(K.j,{dispatch:I,items:Object.keys(a).map(e=>({name:e,displayText:a[e].label,className:[a[e].style,"captions_dialog--dropdownTextOptions--ma0Ue"].join(" "),isChecked:a[e].style===c})),showPoint:!0,parentRect:x.current?.getBoundingClientRect(),onSelectItem:e=>{e.name&&r(a[e.name].style)},minWidth:96}),(0,o.jsx)("div",{style:{clear:"both"}})]})]})}var el=t(316427),en=t(889081),ec=t(633065),er=t(792875),ed=t(864980);let e_=[_.$E.WARNING_RECV_AUDIO_DECODE_FAILED,_.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW,_.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW,_.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW];function eu(e){let a;if((0,er.Im)(e.activeWarnings))return null;for(let t of e_)if(e.activeWarnings[t]){a=e.activeWarnings[t];break}return a?(0,o.jsx)("div",{className:e.className,"data-tooltip-type":g.Ib.TEXT,"data-tooltip":a,"data-tooltip-show-below":!0,"data-tooltip-timeout-delay":50,children:(0,o.jsx)(ed.e,{className:"voice_warning_icon--icon--NvhIw","aria-label":a})}):null}function ep(e){switch(e){case _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW:return(0,E.t)("collaboration.voice.audio_input_too_low_warning");case _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW:return(0,E.t)("collaboration.voice.speaker_volume_too_low_warning");case _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW:case _.$E.WARNING_RECV_AUDIO_DECODE_FAILED:return(0,E.t)("collaboration.voice.poor_connection_warning");default:return null}}function ev(e){let{callEvent:a,onClick:t,notificationUserId:l}=e.notification,[n,c]=s.useState(null),[d,u]=s.useState(!1),p=s.useRef(),v=s.useRef(a),[m,h]=s.useState(),N=(0,i.d4)(e=>e.multiplayer.allUsers),f=(0,i.d4)(e=>e.voice.voiceUsersById),I=s.useMemo(()=>{if(l){if(l in f)return f[l].name;let e=N.find(e=>e.userID===l);if(e)return e.name}return"User"},[l,f,N]),g=m?.href,O=s.useMemo(()=>g?"a":"div",[g]);if(s.useEffect(()=>()=>{p?.current&&clearTimeout(p.current)},[]),s.useEffect(()=>{let e=()=>{u(!1),c(null)};m?(u(!0),c(null),m.persist||c(setTimeout(()=>{e()},2e3))):e()},[m]),s.useEffect(()=>()=>{n&&clearTimeout(n)},[n]),s.useEffect(()=>{switch(v.current=a,a){case _.$E.CONNECTED:h({msg:(0,E.t)("collaboration.voice.connected"),type:_.w.SUCCESS,icon:(0,o.jsx)(en.g,{})});break;case _.$E.CONNECTED_WITH_MIC_DISABLED:h({msg:(0,E.t)("collaboration.voice.connected_check_your_microphone_permissions_to_start_chatting"),allowMultiLine:!0,type:_.w.SUCCESS});break;case _.$E.CONNECTING:h({msg:(0,E.t)("collaboration.voice.connecting"),type:_.w.PENDING,persist:!0});break;case _.$E.ERROR:h({msg:(0,E.t)("collaboration.voice.something_went_wrong_try_again"),type:_.w.ERROR,persist:!0});break;case _.$E.CALL_INACTIVE:h({msg:(0,E.t)("collaboration.voice.things_got_quiet_for_awhile_so_we_ended_the_conversation"),type:_.w.PENDING,persist:!1,allowMultiLine:!0});break;case _.$E.TOKEN_WILL_EXPIRE:h({msg:(0,E.t)("collaboration.voice.it_s_been_quiet_for_a_while_so_we_ll_end_the_conversation_in_20_seconds_n_click_to_stay_on"),type:_.w.MESSAGE,persist:!0,onClick:t,allowMultiLine:!0});break;case _.$E.TOKEN_EXPIRED:h({msg:(0,E.t)("collaboration.voice.audio_has_timed_out_click_to_rejoin"),type:_.w.ERROR,persist:!0,onClick:t});break;case _.$E.USER_JOINED:h({truncatedPrefix:I,msg:(0,E.t)("collaboration.voice.joined"),type:_.w.MESSAGE});break;case _.$E.USER_LEFT:h({truncatedPrefix:I,msg:(0,E.t)("collaboration.voice.left"),type:_.w.MESSAGE});break;case _.$E.ERROR_MICROPHONE_PERMISSIONS_DENIED:let e=(0,E.t)("collaboration.voice.enable_mic_access_in_your_browser_to_join");ec.eD&&(e=(0,E.t)("collaboration.voice.enable_mic_access_for_the_figma_app_to_join")),h({msg:e,type:_.w.ERROR,href:r.AM.TROUBLESHOOT});break;case _.$E.WARNING_MICROPHONE_LEVELS_HIGH_AND_MUTED:h({msg:(0,E.t)("collaboration.voice.want_to_unmute_click_the_mic"),type:_.w.PENDING});break;case _.$E.ERROR_ON_LEAVE:h({msg:(0,E.t)("collaboration.voice.couldn_t_leave_please_try_again"),type:_.w.ERROR});break;case _.$E.SYSTEM_INCOMPATIBLE:h({msg:(0,E.t)("collaboration.voice.figma_audio_won_t_work_on_your_device_learn_why"),type:_.w.ERROR,persist:!0,allowMultiLine:!0,href:r.AM.TROUBLESHOOT});break;case _.$E.DISCONNECTING:case _.$E.RECONNECTING:p.current=setTimeout(()=>{v.current===_.$E.RECONNECTING&&(h({msg:(0,E.t)("collaboration.voice.attempting_to_reconnect"),type:_.w.PENDING,persist:!0}),p.current=void 0)},1500);break;case _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW:case _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW:case _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW:case _.$E.WARNING_RECV_AUDIO_DECODE_FAILED:let s=ep(a);if(!s)break;h({msg:s,type:_.w.WARNING,allowMultiLine:!0})}},[a]),void 0===a)return(0,o.jsx)(o.Fragment,{});let b=["expanded"===e.widgetState?"voice_flash_notifications--flashExpandedList--NkNnw voice_flash_notifications--flash--8i3SH":"voice_flash_notifications--flash--8i3SH",d?function(){switch(m?.type){case _.w.ERROR:return"voice_flash_notifications--flashError--6fLPW";case _.w.WARNING:return"voice_flash_notifications--flashWarning--tdCit";case _.w.MESSAGE:return"voice_flash_notifications--flashMessage--lt-k-";case _.w.SUCCESS:return"voice_flash_notifications--flashSuccess--hmpUM";case _.w.PENDING:default:return"voice_flash_notifications--flashPending--Hzt7W"}}():"voice_flash_notifications--flashHidden--uYI96"];return(0,o.jsx)(w.kg,{onClick:m?.onClick,className:b.join(" "),children:(0,o.jsxs)(O,{className:"voice_flash_notifications--flashNotificationMessageWrap--eXghM voice_flash_notifications--flashNotificationMessageBase--wxFPN",target:"_blank",rel:"noopener",href:m?.href,children:[m?.truncatedPrefix&&(0,o.jsx)("span",{className:"voice_flash_notifications--truncatedPrefix---gMQI ellipsis--ellipsis--Tjyfa",children:m?.truncatedPrefix}),m?.icon,m?.msg]})})}var em=t(390036),eh=t(72138),eE=t(228439),eN=t(286911),ef=t(55557),eI=t(828127);let eg="active_speakers_row--name--LtwVz ellipsis--ellipsis--Tjyfa",eO="active_speakers_row--pos1--88uza active_speakers_row--pos--D59NJ",ew="active_speakers_row--fadeOut--2tZhG",eb="active_speakers_row--willFadeIn--fFCX6",ex="active_speakers_row--activeSpeakerRowAvatar--zKOXb",ej=(e,a)=>e.userID===a.userID,eT=(e,a)=>{let t=e.sort((e,a)=>e.userID>a.userID?-1:1).map(e=>e.userID),o=a.sort((e,a)=>e.userID>a.userID?-1:1).map(e=>e.userID);if(t.length!==o.length)return!0;for(let e=0;e<t.length;e++)if(t[e]!==o[e])return!0;return!1},eD=(e,a)=>{let t=a.filter(a=>!e.find(e=>ej(e,a))),o=e.filter(e=>!a.find(a=>ej(e,a))),s=e.map(e=>o.indexOf(e)>-1?e:void 0),i=e.map(e=>-1===o.indexOf(e)?e:t.shift()).filter(e=>!!e);return t.length>0&&i.push(...t),a.length>1&&1===e.length&&(s[1]=e[0]),{fadeOut:s,active:i}};function eR({user:e,classNames:a,call:t}){let s;let l=(0,i.d4)(e=>e.multiplayer.observingSessionID),n=(0,i.d4)(e=>e.multiplayer.presenterSessionID??null),c=(Array.isArray(a)?[...a,ex]:[a,ex]).join(" "),d=(0,r.eo)(),u=(0,o.jsx)(H.Ro,{entity:{...e,id:e.userID},className:"active_speakers_row--activeSpeakerRowAvatarWithoutMultiplayer--W-S0A",size:24},e.userID),p=e=>{e.stopPropagation()};return"sessionID"in e&&(s=`active-speaker-row-voice-avatar-session-${e.sessionID}`,u=(0,o.jsx)(eN.vQ,{sessionID:e?.sessionID,observingSessionID:l,presenterSessionID:n??null,nominatedSessionID:null,user:e,showColorIndicators:!0,tooltipProxyId:s}),p=a=>{a.stopPropagation(),a.preventDefault(),d(e)}),(0,o.jsxs)("div",{className:c,children:[(0,o.jsx)("div",{className:"active_speakers_row--avatarObserveClickTarget--T1JH- voice_toolbar--avatarObserveClickTarget--QALFw",onClick:p,"data-tooltip-proxy-element-id":s}),u,(0,o.jsx)(eI.i,{userId:e.userID,userName:e.name,microphoneStyle:_.bU.FULL,call:t,volumeIconMutedState:eI.S.MINI,className:"active_speakers_row--voiceIndicatorPositioning--YqGFz"})]})}function eC({user:e,classNames:a}){return(0,o.jsx)("div",{className:eg+" "+(Array.isArray(a)?a.join(" "):a),children:e.name})}let eA=["active_speakers_row--pos0--Dc1bB active_speakers_row--pos--D59NJ",eO,"active_speakers_row--pos2--b5pkb active_speakers_row--pos--D59NJ","active_speakers_row--pos3--EAAkN active_speakers_row--pos--D59NJ","active_speakers_row--pos4--R5-5y active_speakers_row--pos--D59NJ","active_speakers_row--pos5--FYPvT active_speakers_row--pos--D59NJ","active_speakers_row--pos6--PTsn8 active_speakers_row--pos--D59NJ","active_speakers_row--pos7--DjtPj active_speakers_row--pos--D59NJ"];class ey extends s.Component{constructor(e){super(e),this.displayString="ActiveSpeakersRow",this.node=null,this.state={active:[],fadeOut:[]}}componentWillMount(){this.setState(eD(this.state.active,this.props.users))}shouldComponentUpdate(e,a){return e===this.props||(eT(this.props.users,e.users)&&this.setState(eD(this.state.active,e.users)),!1)}render(){let e=(e,a)=>`${e.name}-${a}`,a=[],t=ef.h.getInstance();if(!t)return null;if(1===this.state.fadeOut.length&&this.state.fadeOut[0]){let s=this.state.fadeOut[0];a.push((0,o.jsx)(eR,{call:t,user:s,classNames:[eA[0],ew]},e(s,"avatar")),(0,o.jsx)(eC,{user:s,classNames:[eO,ew,eg]},e(s,"name")))}else if(2===this.state.fadeOut.length&&!this.state.fadeOut[0]&&this.state.fadeOut[1]){let t=this.state.fadeOut[1];a.push((0,o.jsx)(eC,{user:t,classNames:[eO,ew,eg]},e(t,"name")))}else a.push.apply(a,this.state.fadeOut.map((a,s)=>a&&(0,o.jsx)(eR,{call:t,user:a,classNames:[eA[s],ew]},e(a,"avatar"))));if(1===this.state.active.length){let s=this.state.active[0];a.push((0,o.jsx)(eR,{call:t,user:s,classNames:[eA[0],eb]},e(s,"avatar")),(0,o.jsx)(eC,{user:s,classNames:[eO,eb,eg]},e(s,"name")))}else a.push.apply(a,this.state.active.map((a,s)=>(0,o.jsx)(eR,{call:t,user:a,classNames:[eA[s],eb]},e(a,"avatar"))));return a.sort((e,a)=>null===e.key||null===a.key?0:e.key>a.key?-1:1),setTimeout(()=>{this.node?.querySelectorAll("."+eb).forEach(e=>e.classList.remove(eb))},10),(0,o.jsx)("div",{ref:e=>this.node=e,className:"active_speakers_row--activeSpeakerRow--l5ylB",children:a})}}function ek(e){let{call:a,usersInCall:t}=e,i=(0,c.iZ)(),l=(0,V.mt)(a),n=s.useMemo(()=>l?.filter(e=>e!==i?.id)?.slice(0,6).reduce((e,a)=>{let o=t.find(({userID:e})=>e===a);return o?e.concat([o]):e},[])||[],[l,t,i]);return(0,o.jsx)(ey,{users:n})}var eS=t(364616),eL=t(844411);function eW(e){let{children:a,headerText:t,collapsedContent:i,onToggle:l,collapseStateOverride:n}=e,[c,r]=s.useState(!1),d=n||c;return(0,o.jsxs)("span",{children:[(0,o.jsx)(w.fI,{className:d?"voice_collapsible_dropdown--isCollapsed--SwBvz":"",children:(0,o.jsxs)("span",{className:"voice_collapsible_dropdown--dropdownSectionTitle--lpt22",onClick:a=>{a.preventDefault(),a.stopPropagation(),l&&!0!==e.hideToggleOption&&l(!d),r(!d)},children:[d?i:t,!e.hideToggleOption&&(0,o.jsx)(X.B,{svg:d?eS.A:eL.A,className:"voice_collapsible_dropdown--voiceDropdownChevronIcon--JgQxE"})]})}),!d&&a&&(0,o.jsx)(o.Fragment,{children:a})]})}var eP=t(560823);function eU(e){let a=(0,i.d4)(e=>e.voice.showWidgetParticipantList),t=(0,c.iZ)(),n=(0,i.wA)(),{userIdsInCall:u}=(0,d.W5)(e.fileKey),p=(0,d.bF)(u,e.fileKey),v=(0,r.eo)(),{usersInCall:m,callMetadata:h}=s.useMemo(()=>({usersInCall:p.filter(e=>e.userID!==t?.id),callMetadata:{microphoneStyle:_.bU.FULL,call:e.call}}),[p,t,e.call]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eN.sK,{}),m.length>0&&(0,o.jsx)("div",{className:eP.ev,children:(0,o.jsx)(eW,{headerText:`${e.currentUserInCall?"You and ":""}`+(0,em.td)(m.length,"person","people")+" in conversation",collapseStateOverride:!a,collapsedContent:(0,o.jsx)(ek,{usersInCall:m,call:e.call}),hideToggleOption:m.length<2,onToggle:e=>n(l.yF(!e)),children:(0,o.jsx)(eh.P,{className:eP.YM,children:m.map(e=>(0,o.jsx)(eE.Q,{callMetadata:h,user:e,isOverflow:!0,onUserClick:v},"sessionID"in e?e.sessionID:e.userID))})})})]})}var e$=t(816299),eM=t(623411),eG=t(234191),eB=t(941347),eV=t(325087);let eH=(0,s.memo)(function(e){return(0,o.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,o.jsx)("path",{fill:"var(--fpl-icon-color, var(--color-icon))",fillRule:"evenodd",d:"M7 7h10a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1M5 8a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2zm4.5 7a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm4.5-1.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5m-3.5-.5a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1zm2.5 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 0 1h-1a.5.5 0 0 1-.5-.5M7.5 13a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1z",clipRule:"evenodd"})})});var eF=t(812714),ez=t(824570);t(120440);var eX=t(883765),eJ=t(983500),eY=t(769109),eK=t(679359),eq=t(58212),eQ=t(111297),eZ=t(215853),e0=t(954741),e1=t(404343);let e5="device_controls--deviceControlRow--kSC19",e2="device_controls--controlLabel--Yp1lV",e4="device_controls--dropdownContainer--DfMXW",e9="device_controls--dropdownInput--w72f-",e7="device_controls--dropdownChevron--UBe58",e6="MICROPHONE_CONTROL_DROPDOWN",e3="PLAYBACK_DEVICE_CONTROL_DROPDOWN",e8=(0,eJ.jz)(e1.aHA);function ae(e,a,t,o,l,n,c){let r=(0,i.wA)(),[d,_]=(0,s.useState)(null),[u,p]=(0,s.useState)([]),v=(0,i.d4)(e=>e.dropdownShown?.type===o),m=(0,ez.wm)(()=>u.map(e=>e.deviceId),[u]),N=(0,s.useCallback)(async()=>{try{let e=await a(),t=new Set(m);(m.length!==e.length||e.some(e=>!(e.deviceId in t)))&&p(e)}catch{c||r(eq.F.enqueue({message:(0,E.t)("collaboration.voice.error_fetching_devices"),error:!0,type:"voice-device-error"}))}},[m,r,a,c]),f=(0,s.useCallback)(async()=>{try{if(n&&!h.Ay.chrome)return;let a=await e();a.deviceId!==d?.deviceId&&_(a)}catch{}},[n,e,d]),I=(0,s.useCallback)(async e=>{e.deviceId!==d?.deviceId&&_(e);try{await t(e)}catch{r(eq.F.enqueue({message:(0,E.t)("collaboration.voice.error_selecting_device"),error:!0,type:"voice-device-error"})),await f()}},[f,t,r,d]);return(0,s.useEffect)(()=>{(l||v)&&N()},[l,v,N]),(0,s.useEffect)(()=>{f(),N()},[]),[d,u,I]}function aa(e){let[a,t,s]=ae(e.call.currentMicrophone,e.call.getMicrophones,e.call.setMicrophone,e6,e.isOpen,!1,e.microphonePermissionDenied),[i,l,n]=ae(e.call.currentPlaybackDevice,e.call.getPlaybackDevices,e.call.setPlaybackDevice,e6,e.isOpen,!0,e.microphonePermissionDenied),c=e.targetRef.current?.getBoundingClientRect();return e.isOpen?(0,o.jsx)(at,{targetRect:c,currentMicrophone:a,microphoneDevices:t,setMicrophone:s,currentPlaybackDevice:i,playbackDevices:l,setPlaybackDevice:n}):null}function at(e){let{targetRect:a,currentMicrophone:t,microphoneDevices:l,setMicrophone:n,currentPlaybackDevice:c,playbackDevices:r,setPlaybackDevice:d}=e,_=(0,i.wA)(),u=s.useId(),p=s.useId(),[v,m]=(0,s.useState)({type:""}),N=()=>{m({type:""})},f={format:e=>e?.label||"",isEqual:(e,a)=>e.deviceId===a.deviceId},I=(0,eF.kc)().a11y_voice_dropdowns?(0,o.jsx)("span",{className:"x5b7gxt",children:(0,o.jsx)(eB.P,{})}):(0,o.jsx)(eB.P,{}),g=(0,eF.kc)().a11y_voice_dropdowns?(0,o.jsx)("span",{className:"x5b7gxt",children:(0,o.jsx)(eV.L,{})}):(0,o.jsx)(eV.L,{}),O=(0,o.jsx)("span",{className:e4,children:(0,o.jsxs)(e$.bL,{value:t?.label??(0,E.t)("collaboration.voice.microphone_not_found"),onChange:e=>{n(l.find(a=>a.label===e)??{deviceId:"not_found",label:(0,E.t)("collaboration.voice.microphone_not_found"),groupId:"not_found",kind:"audioinput",toJSON:()=>null})},children:[(0,o.jsx)(e$.l9,{width:"fill",iconLead:I,label:(0,o.jsx)(eM.h,{children:(0,E.t)("collaboration.voice.microphone")})}),(0,o.jsx)(e$.mc,{children:l.map(e=>(0,o.jsx)(e$.c$,{value:e.label,children:e.label},e.deviceId))})]})}),b=(0,o.jsx)(e0.l6,{ariaLabelledBy:u,chevronClassName:e7,className:e4,dispatch:_,dropdownShown:v,formatter:f,icon:I,id:e6,inputClassName:e9,neverConstrain:!0,onChange:e=>{n(e)},onHideDropdownOverride:N,onShowDropdownOverride:()=>m({type:e6}),property:t||{deviceId:"not_found",label:(0,E.t)("collaboration.voice.microphone_not_found"),groupId:"not_found",kind:"audioinput",toJSON:()=>null},children:l.map(e=>(0,o.jsx)(e0.c$,{value:e,children:e.label},e.deviceId))}),x=(0,o.jsx)("span",{className:e4,children:(0,o.jsxs)(e$.bL,{value:c?.label??(0,E.t)("collaboration.voice.playback_device_not_found"),onChange:e=>{d(r.find(a=>a.label===e)??{deviceId:"not_found",label:(0,E.t)("collaboration.voice.playback_device_not_found"),groupId:"not_found",kind:"audiooutput",toJSON:()=>null})},children:[(0,o.jsx)(e$.l9,{width:"fill",iconLead:g,label:(0,o.jsx)(eM.h,{children:(0,E.t)("collaboration.voice.speakers")})}),(0,o.jsx)(e$.mc,{children:r.map(e=>(0,o.jsx)(e$.c$,{value:e.label,children:e.label},e.deviceId))})]})}),j=(0,o.jsx)(e0.l6,{ariaLabelledBy:p,chevronClassName:e7,className:e4,dispatch:_,dropdownShown:v,formatter:f,icon:g,id:e3,inputClassName:e9,neverConstrain:!0,onChange:e=>{d(e)},onHideDropdownOverride:N,onShowDropdownOverride:()=>m({type:e3}),property:c||{deviceId:"not_found",label:(0,E.t)("collaboration.voice.playback_device_not_found"),groupId:"not_found",kind:"audiooutput",toJSON:()=>null},children:r.map(e=>(0,o.jsx)(e0.c$,{value:e,children:e.label},e.deviceId))}),T=(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"device_controls--divider--Z8rM-"}),!(0,B.WO)()&&(0,o.jsx)(as,{}),(0,B.WO)()&&(0,o.jsx)(ao,{})]});return(0,o.jsxs)(eZ.Cf,{className:"device_controls--pointingDropdown--hSJ1h",targetRect:a,minWidth:e8,propagateCloseClick:!0,lean:"left",leanPadding:52,children:[(0,o.jsxs)("div",{onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:"device_controls--header---h3P-",children:[(0,E.t)("collaboration.voice.audio_settings"),(0,o.jsx)(eY.Jn,{onClick:()=>_(U.oB())})]}),(0,o.jsxs)("div",{className:"device_controls--container--VR8KK",children:[(0,o.jsxs)(w.fI,{className:e5,children:[(0,o.jsx)("span",{className:e2,id:u,children:(0,E.tx)("collaboration.voice.microphone")}),(0,eF.kc)().a11y_voice_dropdowns?O:b]}),h.Ay.chrome&&(0,o.jsxs)(w.fI,{className:e5,children:[(0,o.jsx)("span",{className:e2,id:p,children:(0,E.tx)("collaboration.voice.speakers")}),(0,eF.kc)().a11y_voice_dropdowns?x:j]})]})]}),(0,B.X0)()&&T]})}function ao(){let e=(0,i.d4)(e=>e.voice.captionsInstallProgress),a=(0,i.d4)(e=>e.voice.showCaptions),t=(0,i.wA)(),l=s.useId(),n=(0,o.jsx)(eH,{}),c=(0,E.tx)("collaboration.voice.closed_captioning"),r=(0,o.jsx)(z.Ex,{text:(0,E.t)("collaboration.voice.beta"),className:"device_controls--betaTag---VTFI",color:z.zE.BRAND});return a&&(0,B.Mw)(e)&&(c=(0,E.tx)("collaboration.voice.setting_up_closed_captions_install_progress",{installProgress:e}),n=(0,o.jsx)(eK.kt,{className:"device_controls--captionsLoadingSpinner--ivdGQ"}),r=(0,o.jsx)(o.Fragment,{})),(0,o.jsxs)(eM.J,{className:"device_controls--closedCaptionRow--OdIHt raw_components--singleRow--W5dYN raw_components--_singleRow--yTGIY raw_components--singleRowHeight--dKM4t raw_components--_row--rHucX raw_components--row--NThzm device_controls--deviceControlRowWithHover--KUbHL device_controls--deviceControlRow--kSC19",htmlFor:l,children:[n,(0,o.jsxs)("span",{className:"device_controls--captionToggleLabel--MjCYn device_controls--controlLabelFullOpacity--1nEqI device_controls--controlLabel--Yp1lV",children:[c,r]}),(0,o.jsx)(eG.v,{id:l,checked:a,onChange:(e,{event:a})=>{a.stopPropagation(),(0,eX.sx)("voice_captions_toggle",{value:e,source:"voice_widget"}),(0,B.HJ)(t,e)}})]})}function as(){let e=r.AM.ACCESSIBILITY;return(0,o.jsx)(eQ.L0,{target:"_blank",rel:"noopener",href:e,trackingEventName:"Learn more about captioning",children:(0,o.jsxs)(w.fI,{className:"device_controls--deviceControlRowWithHover--KUbHL device_controls--deviceControlRow--kSC19",children:[(0,o.jsx)(X.B,{className:"device_controls--iconContainer--TuXUt",svg:Z.A}),(0,o.jsx)("span",{className:"device_controls--controlLabelFullOpacity--1nEqI device_controls--controlLabel--Yp1lV",children:(0,E.tx)("collaboration.voice.learn_how_to_turn_on_closed_captioning")})]})})}let ai=(0,L.ck)("94721b53827c353075273e54a45ea41850ee0284"),al=(0,L.ck)("d917bf9964749c47b46d367572a5dd28a559bd2f"),an="DEVICE_CONTROL_DROPDOWN",ac=null,ar=null,ad=null;function a_(e){let{call:a,fileKey:t,user:n,callEvent:c,notificationUserId:r,callEventCallback:u}=e,p=(0,i.Pj)(),[v,h]=(0,s.useState)(null),[N,f]=(0,s.useState)(),[b,x]=(0,s.useState)(!1),[C,L]=(0,s.useState)(!1),[V,H]=(0,s.useState)(!1),[z,X]=(0,s.useState)(!1),J=(0,i.d4)(e=>e.voice.snapWidget),[Y,K]=(0,s.useState)(!1),[q,Q]=(0,s.useState)(!1),[Z,ee]=(0,s.useState)({}),{userIdsInCall:ea}=(0,d.W5)(t);(0,G.W)();let et=(0,i.d4)(e=>e.voice.showCaptions),eo=(0,i.d4)(e=>e.voice.captionsInstallProgress),es=(0,i.d4)(e=>e.dropdownShown?.type===an),en=(0,i.d4)(e=>e.voice.activeCall[t]||!1),ec=(0,i.d4)(e=>e.voice.showWidgetParticipantList),er=(0,s.useRef)(null),ed=(0,i.wA)(),e_={in:()=>{H(!0)},out:()=>(H(!1),new Promise(e=>setTimeout(e,300)))};s.useEffect(()=>{let e=a.getSystemCompatibility();if(h(e),!e){u(_.$E.SYSTEM_INCOMPATIBLE);return}ac||ar||(ar=new Audio(ai),(ac=new Audio(al)).load(),ar.load(),[ar,ac].forEach(e=>e.volume=.5))},[]),s.useEffect(()=>{!en&&v&&eE(),window.requestAnimationFrame(()=>e_.in())},[v]),s.useEffect(()=>{let e;switch(c){case _.$E.DISCONNECTED:q&&(ar?.play(),Q(!1)),ed(l.oI({fileKey:t}));break;case _.$E.TOKEN_WILL_EXPIRE_DETECT_MIC_INPUT:(function e(t){if(Date.now()>=t){u(_.$E.TOKEN_WILL_EXPIRE);return}if(a.isLocalUserSpeaking()){ef(!1);return}setTimeout(()=>{e(t)},500)})(Date.now()+1e4);break;case _.$E.CONNECTED:case _.$E.CONNECTED_WITH_MIC_DISABLED:Y&&(setTimeout(()=>ac?.play(),400),K(!1)),ed(l.rO({fileKey:t}));break;case _.$E.CALL_INACTIVE:a.leave();break;case _.$E.TOKEN_WILL_EXPIRE:e=()=>ef(!0);break;case _.$E.TOKEN_EXPIRED:e=eE;break;case _.$E.USER_JOINED:case _.$E.USER_LEFT:if(ad)return;break;case _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW:case _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW:case _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW:case _.$E.WARNING_RECV_AUDIO_DECODE_FAILED:let o=ep(c);if(!o)break;ee({...Z,[c]:o});break;case _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW_RECOVER:case _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW_RECOVER:case _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW_RECOVER:case _.$E.WARNING_RECV_AUDIO_DECODE_FAILED_RECOVER:let s=function(e){switch(e){case _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW_RECOVER:return _.$E.WARNING_AUDIO_INPUT_LEVEL_TOO_LOW;case _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW_RECOVER:return _.$E.WARNING_AUDIO_OUTPUT_LEVEL_TOO_LOW;case _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW_RECOVER:return _.$E.WARNING_SEND_AUDIO_BITRATE_TOO_LOW;case _.$E.WARNING_RECV_AUDIO_DECODE_FAILED_RECOVER:return _.$E.WARNING_RECV_AUDIO_DECODE_FAILED;default:return null}}(c);if(!s)break;delete Z[s],ee(Z)}void 0!==c&&f({callEvent:c,onClick:e,notificationUserId:r})},[c]),s.useEffect(()=>{X(!0)},[J]),s.useEffect(()=>{z&&X(!1)},[z]);let[em,eh]=(0,s.useState)(!0),eE=async()=>{if(eh(!0),!a.getSystemCompatibility()){eh(!1),u(_.$E.SYSTEM_INCOMPATIBLE);return}x(!0),K(!0),ad=setTimeout(()=>{ad=null},5e3);try{let{data:e}=await P.Ay.post(`/api/voice/${t}/auth`),o=await (0,W.JL)(e.meta.user_encryption_key),s=await (0,W.We)(o,e.meta.call_user_id);if(s!=s)throw Error(`User ID does not match local user ID.
local: ${s}
remote: ${s}`);await a.join({appId:e.meta.app_id,callId:e.meta.call_id,token:e.meta.auth_token,callUserId:e.meta.call_user_id,userId:s,encryptionKey:e.meta.call_encryption_key,userEncryptionKey:o,setParticipantIdsCallback:eN,callEventCallback:u,store:p,fileKey:t})}catch(e){eh(!1),u(_.$E.ERROR)}x(!1),eh(!1)};function eN(e){ed(l.cb(e))}(0,I.N)({isVisible:V});let ef=async e=>{let{data:o}=await P.Ay.post(`/api/voice/${t}/auth`,{call_user_id:a.uid});await a.renewToken(o.meta.auth_token),e?u(_.$E.CONNECTED):u(_.$E.TOKEN_SILENTLY_RENEWED)},eI=async()=>{x(!0),Q(!0);try{await Promise.all([e_.out(),a.leave()]),ed(l.oI({fileKey:t})),ar?.play(),es&&ed(U.oB()),ed(l.Pp(!1))}catch{e_.in(),u(_.$E.ERROR_ON_LEAVE)}x(!1)},eg=async e=>{(0,M.ds)("voice_user_mute_toggle",t,p.getState(),{source:"voice_widget",muted:!e}),e?await a.unmute():await a.mute()},eO=()=>{es?ed(U.oB()):((0,M.ds)("voice_widget_open_settings",t,p.getState()),ed(U.j7({type:an})))},ew=N?N&&ea.size>1&&ec?"expanded":"collapsed":null;et&&(0,B.nN)(eo)&&((0,M.ds)("voice_caption_download_error",t,p.getState(),{error_code:eo,source:"voice_widget"}),(0,B.HJ)(ed,!1),ed((0,$.to)({type:F.L,data:{dispatch:ed,installProgress:eo}})));let eb=(0,A.U1)();return(0,o.jsx)(O.m,{role:"region",children:(0,o.jsxs)("div",{className:"voice_widget--hybridModalWrapper--x9-GE",ref:eb,children:[(0,o.jsx)("div",{className:m()(j,{[T]:V}),children:(0,o.jsxs)(w.Id,{className:R,children:[(0,o.jsxs)("div",{className:D,children:[(0,o.jsx)("span",{className:en||C?"voice_widget--currentUser--L7Z6l":"voice_widget--inactiveCurrentUser--yVaZY voice_widget--currentUser--L7Z6l",children:(0,o.jsx)(au,{user:n,call:e.call})}),(0,o.jsx)(eu,{className:"voice_widget--warningIcon--WJPdH",activeWarnings:Z}),(0,o.jsx)(el.Y,{userId:n.id,onMuteButtonClickCallback:eg,disabled:a.microphonePermissionDenied}),(0,o.jsx)(y.d,{"aria-expanded":es,"aria-label":(0,E.t)("collaboration.voice.settings"),ref:er,"data-tooltip-type":g.Ib.TEXT,"data-tooltip":(0,E.t)("collaboration.voice.settings"),onClick:()=>{eO()},htmlAttributes:{onMouseDown:e=>{e.stopPropagation()}},children:(0,o.jsx)(S.I,{})}),(0,o.jsx)(k.E,{className:en||em?"voice_widget--leaveButton--UUdxH basic_form--btn--FSrmp ellipsis--ellipsis--Tjyfa text--fontPos11--2LvXf text--_fontBase--QdLsd":"voice_widget--joinButton--WvZPr basic_form--btn--FSrmp ellipsis--ellipsis--Tjyfa text--fontPos11--2LvXf text--_fontBase--QdLsd",onClick:en||em?eI:eE,disabled:!v||b,htmlAttributes:{onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1)},children:en||em?(0,E.tx)("collaboration.voice.leave"):(0,E.tx)("collaboration.voice.join")})]}),en&&(0,o.jsx)(eU,{fileKey:t,currentUserInCall:en,call:a}),(0,B.WO)()&&et&&(0,o.jsx)(ei,{call:a})]})}),N&&(0,o.jsx)(ev,{notification:N,widgetState:ew}),(0,o.jsx)(aa,{isOpen:es,call:a,targetRef:er,microphonePermissionDenied:a.microphonePermissionDenied})]})})}function au({user:e,call:a}){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ap,{user:e,call:a}),(0,o.jsx)(H.Ro,{entity:e,size:24,className:"voice_widget--undraggableImage--muN9g",label:e.name})]})}function ap({user:e,call:a}){let t=(0,V.Wl)(e.id,a);return!t||t.isMuted?null:(0,o.jsx)(eI.i,{userId:e.id,userName:e.name,microphoneStyle:_.bU.FULL,className:"voice_widget--avatarVoiceIndicator--zfWwx",volumeIconMutedState:eI.S.NONE,call:a})}function av(){let e=(0,i.d4)(e=>e.mirror.appModel.showUi),a=(0,n.tS)(),t=(0,c.iZ)(),u=(0,i.d4)(e=>e.voice.showWidget),p=(0,i.d4)(e=>a&&a in e.voice.activeCall),v=(0,i.d4)(e=>a&&!!e.voice.activeCall[a]),{userIdsInCall:m}=(0,d.W5)(a,!0),h=(0,d.bF)(m,a).length,E=(0,r.qr)(),N=(0,i.wA)(),[f,I]=(0,s.useState)(),[g,O]=(0,s.useState)(),w=s.useCallback((e,a)=>{_.GA.has(e)&&N(l.Pp(!0)),a&&O(a),I(e)},[N]),b=(0,i.d4)(e=>e.voice.captionsInstallProgress),x=(0,i.d4)(e=>e.voice.showCaptions);return(s.useEffect(()=>{E&&(E.captionsToggleEnabled=x,E.streamAudioForCaptions(x&&100===b))},[x,b,E]),s.useEffect(()=>{u||(O(void 0),I(void 0))},[u]),s.useEffect(()=>{a&&!p&&h>0?N(l.Zq({fileKey:a})):a&&p&&!v&&0===h&&N(l.a6({fileKey:a}))},[h,a,p,v,N]),e&&a&&t)?p&&!u?(0,o.jsx)(C,{fileKey:a}):E&&u?(0,o.jsx)(a_,{fileKey:a,user:t,call:E,notificationUserId:g,callEvent:f,callEventCallback:w}):(0,o.jsx)(o.Fragment,{}):(0,o.jsx)(o.Fragment,{})}}}]);

//# debugId=7829b2fd-b375-5614-8927-f8bab3d66ea7

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/9ce19d3fb6ff64214b4b0c6ff8d7dc6b9a2b97df/7281-1bfbc723cf361212.min.js.map